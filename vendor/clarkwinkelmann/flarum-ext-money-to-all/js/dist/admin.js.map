{"version":3,"file":"admin.js","mappings":"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","sources":["webpack://@clarkwinkelmann/money-to-all/webpack/bootstrap","webpack://@clarkwinkelmann/money-to-all/webpack/runtime/compat get default export","webpack://@clarkwinkelmann/money-to-all/webpack/runtime/define property getters","webpack://@clarkwinkelmann/money-to-all/webpack/runtime/hasOwnProperty shorthand","webpack://@clarkwinkelmann/money-to-all/webpack/runtime/make namespace object","webpack://@clarkwinkelmann/money-to-all/external root \"flarum.core.compat['admin/app']\"","webpack://@clarkwinkelmann/money-to-all/external root \"flarum.core.compat['common/components/Button']\"","webpack://@clarkwinkelmann/money-to-all/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@clarkwinkelmann/money-to-all/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@clarkwinkelmann/money-to-all/external root \"flarum.core.compat['common/components/Switch']\"","webpack://@clarkwinkelmann/money-to-all/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@clarkwinkelmann/money-to-all/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@clarkwinkelmann/money-to-all/./src/admin/components/SendMoneyModal.ts","webpack://@clarkwinkelmann/money-to-all/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@clarkwinkelmann/money-to-all/./src/admin/index.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['admin/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Switch'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extractText'];","import app from 'flarum/admin/app';\nimport Modal from 'flarum/common/components/Modal';\nimport Button from 'flarum/common/components/Button';\nimport Switch from 'flarum/common/components/Switch';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport extractText from 'flarum/common/utils/extractText';\n\nexport default class SendMoneyModal extends Modal {\n    amount: string = ''\n    notify: boolean = false\n    message: string = ''\n    suspended: boolean = false\n    lastActivity: string = ''\n    previewCount: number | null = null\n\n    className() {\n        return 'Modal--small';\n    }\n\n    title() {\n        return app.translator.trans('clarkwinkelmann-money-to-all.lib.modal.title');\n    }\n\n    oncreate(vnode: any) {\n        super.oncreate(vnode);\n\n        this.refresh();\n    }\n\n    content() {\n        return m('.Modal-body', [\n            m('.Form-group', [\n                m('label', app.translator.trans('clarkwinkelmann-money-to-all.lib.modal.amount')),\n                m('input.FormControl', {\n                    type: 'number',\n                    value: this.amount,\n                    onchange: (event: InputEvent) => {\n                        this.amount = (event.target as HTMLInputElement).value;\n                    },\n                    min: 0,\n                    step: 0.1,\n                    disabled: this.loading,\n                }),\n            ]),\n            app.forum.attribute('moneyRewardsCreateMoney') ? m('.Form-group', [\n                Switch.component({\n                    state: this.notify,\n                    onchange: (value: boolean) => {\n                        this.notify = value;\n                    },\n                    disabled: this.loading,\n                }, app.translator.trans('clarkwinkelmann-money-to-all.lib.modal.notify')),\n            ]) : null,\n            m('.Form-group', [\n                m('label', app.translator.trans('clarkwinkelmann-money-to-all.lib.modal.message')),\n                m('textarea.FormControl', {\n                    disabled: !this.notify || this.loading,\n                    value: this.notify ? this.message : '',\n                    onchange: (event: InputEvent) => {\n                        this.message = (event.target as HTMLInputElement).value;\n                    },\n                    placeholder: this.notify ? '' : extractText(app.translator.trans('clarkwinkelmann-money-to-all.lib.modal.messagePlaceholder')),\n                }),\n                m('.helpText', app.translator.trans('clarkwinkelmann-money-to-all.lib.modal.messageHelp')),\n            ]),\n            app.forum.attribute('moneyRewardsCreateMoney') ? m('.Form-group', [\n                Switch.component({\n                    state: this.suspended,\n                    onchange: (value: boolean) => {\n                        this.suspended = value;\n                        this.refresh();\n                    },\n                    disabled: this.loading,\n                }, app.translator.trans('clarkwinkelmann-money-to-all.lib.modal.suspended')),\n            ]) : null,\n            m('.Form-group', [\n                m('label', app.translator.trans('clarkwinkelmann-money-to-all.lib.modal.lastActivity')),\n                m('input.FormControl', {\n                    type: 'date',\n                    value: this.lastActivity,\n                    onchange: (event: InputEvent) => {\n                        this.lastActivity = (event.target as HTMLInputElement).value;\n                        this.refresh();\n                    },\n                    disabled: this.loading,\n                }),\n            ]),\n            m('.Form-group', [\n                m('p', app.translator.trans('clarkwinkelmann-money-to-all.lib.modal.preview', {\n                    count: this.previewCount === null ? LoadingIndicator.component({\n                        display: 'inline',\n                        size: 'small',\n                    }) : this.previewCount,\n                })),\n            ]),\n            m('.Form-group', Button.component({\n                type: 'submit',\n                className: 'Button Button--primary',\n                loading: this.loading,\n                disabled: parseFloat(this.amount || '0') <= 0,\n            }, app.translator.trans('clarkwinkelmann-money-to-all.lib.modal.submit'))),\n        ]);\n    }\n\n    refresh() {\n        this.previewCount = null;\n\n        this.request(true).then(payload => {\n            this.previewCount = payload.userMatchCount;\n            m.redraw();\n        });\n    }\n\n    request(dryRun: boolean = false) {\n        return app.request<{ userMatchCount: number }>({\n            method: 'POST',\n            url: app.forum.attribute('apiUrl') + '/money-to-all',\n            errorHandler: this.onerror.bind(this),\n            body: {\n                suspended: this.suspended,\n                lastActivity: this.lastActivity,\n                amount: this.amount,\n                notify: this.notify,\n                message: this.message,\n                dryRun,\n            },\n        });\n    }\n\n    onsubmit(event: Event) {\n        event.preventDefault();\n\n        this.loading = true;\n\n        this.request().then(payload => {\n            this.hide();\n\n            app.alerts.show({type: 'success'}, app.translator.trans('clarkwinkelmann-money-to-all.lib.modal.success', {\n                count: payload.userMatchCount,\n            }));\n        }).catch(() => {\n            this.loading = false;\n            m.redraw();\n        });\n    }\n}\n","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","import app from 'flarum/admin/app';\nimport Button from 'flarum/common/components/Button';\nimport SendMoneyModal from './components/SendMoneyModal';\n\napp.initializers.add('clarkwinkelmann-money-to-all', () => {\n    app.extensionData\n        .for('clarkwinkelmann-money-to-all')\n        .registerSetting(function () {\n            return m('.Form-group', Button.component({\n                className: 'Button',\n                onclick() {\n                    app.modal.show(SendMoneyModal);\n                },\n            }, app.translator.trans('clarkwinkelmann-money-to-all.admin.settings.send')));\n        });\n});\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","SendMoneyModal","subClass","superClass","amount","notify","message","suspended","lastActivity","previewCount","create","constructor","className","title","app","oncreate","vnode","this","refresh","content","m","type","onchange","event","target","min","step","disabled","loading","Switch","state","placeholder","extractText","count","LoadingIndicator","display","size","Button","parseFloat","request","then","payload","userMatchCount","redraw","dryRun","method","url","errorHandler","onerror","body","onsubmit","preventDefault","hide","Modal","registerSetting","onclick"],"sourceRoot":""}