{"version":3,"file":"chunk~456.js","mappings":"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","sources":["webpack://@fof/profile-image-crop/./node_modules/cropperjs/dist/cropper.js","webpack://@fof/profile-image-crop/./node_modules/image-blob-reduce/index.js","webpack://@fof/profile-image-crop/./node_modules/image-blob-reduce/lib/image_traverse.js","webpack://@fof/profile-image-crop/./node_modules/image-blob-reduce/lib/jpeg_plugins.js","webpack://@fof/profile-image-crop/./node_modules/image-blob-reduce/lib/utils.js","webpack://@fof/profile-image-crop/./node_modules/pica/dist/pica.js"],"sourcesContent":["/*!\n * Cropper.js v1.5.13\n * https://fengyuanchen.github.io/cropperjs\n *\n * Copyright 2015-present Chen Fengyuan\n * Released under the MIT license\n *\n * Date: 2022-11-20T05:30:46.114Z\n */\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.Cropper = factory());\n})(this, (function () { 'use strict';\n\n  function ownKeys(object, enumerableOnly) {\n    var keys = Object.keys(object);\n    if (Object.getOwnPropertySymbols) {\n      var symbols = Object.getOwnPropertySymbols(object);\n      enumerableOnly && (symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      })), keys.push.apply(keys, symbols);\n    }\n    return keys;\n  }\n  function _objectSpread2(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = null != arguments[i] ? arguments[i] : {};\n      i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n    return target;\n  }\n  function _typeof(obj) {\n    \"@babel/helpers - typeof\";\n\n    return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n      return typeof obj;\n    } : function (obj) {\n      return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    }, _typeof(obj);\n  }\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    Object.defineProperty(Constructor, \"prototype\", {\n      writable: false\n    });\n    return Constructor;\n  }\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n    return obj;\n  }\n  function _toConsumableArray(arr) {\n    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n  }\n  function _arrayWithoutHoles(arr) {\n    if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n  }\n  function _iterableToArray(iter) {\n    if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n  }\n  function _unsupportedIterableToArray(o, minLen) {\n    if (!o) return;\n    if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n    var n = Object.prototype.toString.call(o).slice(8, -1);\n    if (n === \"Object\" && o.constructor) n = o.constructor.name;\n    if (n === \"Map\" || n === \"Set\") return Array.from(o);\n    if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n  }\n  function _arrayLikeToArray(arr, len) {\n    if (len == null || len > arr.length) len = arr.length;\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n    return arr2;\n  }\n  function _nonIterableSpread() {\n    throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var IS_BROWSER = typeof window !== 'undefined' && typeof window.document !== 'undefined';\n  var WINDOW = IS_BROWSER ? window : {};\n  var IS_TOUCH_DEVICE = IS_BROWSER && WINDOW.document.documentElement ? 'ontouchstart' in WINDOW.document.documentElement : false;\n  var HAS_POINTER_EVENT = IS_BROWSER ? 'PointerEvent' in WINDOW : false;\n  var NAMESPACE = 'cropper';\n\n  // Actions\n  var ACTION_ALL = 'all';\n  var ACTION_CROP = 'crop';\n  var ACTION_MOVE = 'move';\n  var ACTION_ZOOM = 'zoom';\n  var ACTION_EAST = 'e';\n  var ACTION_WEST = 'w';\n  var ACTION_SOUTH = 's';\n  var ACTION_NORTH = 'n';\n  var ACTION_NORTH_EAST = 'ne';\n  var ACTION_NORTH_WEST = 'nw';\n  var ACTION_SOUTH_EAST = 'se';\n  var ACTION_SOUTH_WEST = 'sw';\n\n  // Classes\n  var CLASS_CROP = \"\".concat(NAMESPACE, \"-crop\");\n  var CLASS_DISABLED = \"\".concat(NAMESPACE, \"-disabled\");\n  var CLASS_HIDDEN = \"\".concat(NAMESPACE, \"-hidden\");\n  var CLASS_HIDE = \"\".concat(NAMESPACE, \"-hide\");\n  var CLASS_INVISIBLE = \"\".concat(NAMESPACE, \"-invisible\");\n  var CLASS_MODAL = \"\".concat(NAMESPACE, \"-modal\");\n  var CLASS_MOVE = \"\".concat(NAMESPACE, \"-move\");\n\n  // Data keys\n  var DATA_ACTION = \"\".concat(NAMESPACE, \"Action\");\n  var DATA_PREVIEW = \"\".concat(NAMESPACE, \"Preview\");\n\n  // Drag modes\n  var DRAG_MODE_CROP = 'crop';\n  var DRAG_MODE_MOVE = 'move';\n  var DRAG_MODE_NONE = 'none';\n\n  // Events\n  var EVENT_CROP = 'crop';\n  var EVENT_CROP_END = 'cropend';\n  var EVENT_CROP_MOVE = 'cropmove';\n  var EVENT_CROP_START = 'cropstart';\n  var EVENT_DBLCLICK = 'dblclick';\n  var EVENT_TOUCH_START = IS_TOUCH_DEVICE ? 'touchstart' : 'mousedown';\n  var EVENT_TOUCH_MOVE = IS_TOUCH_DEVICE ? 'touchmove' : 'mousemove';\n  var EVENT_TOUCH_END = IS_TOUCH_DEVICE ? 'touchend touchcancel' : 'mouseup';\n  var EVENT_POINTER_DOWN = HAS_POINTER_EVENT ? 'pointerdown' : EVENT_TOUCH_START;\n  var EVENT_POINTER_MOVE = HAS_POINTER_EVENT ? 'pointermove' : EVENT_TOUCH_MOVE;\n  var EVENT_POINTER_UP = HAS_POINTER_EVENT ? 'pointerup pointercancel' : EVENT_TOUCH_END;\n  var EVENT_READY = 'ready';\n  var EVENT_RESIZE = 'resize';\n  var EVENT_WHEEL = 'wheel';\n  var EVENT_ZOOM = 'zoom';\n\n  // Mime types\n  var MIME_TYPE_JPEG = 'image/jpeg';\n\n  // RegExps\n  var REGEXP_ACTIONS = /^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/;\n  var REGEXP_DATA_URL = /^data:/;\n  var REGEXP_DATA_URL_JPEG = /^data:image\\/jpeg;base64,/;\n  var REGEXP_TAG_NAME = /^img|canvas$/i;\n\n  // Misc\n  // Inspired by the default width and height of a canvas element.\n  var MIN_CONTAINER_WIDTH = 200;\n  var MIN_CONTAINER_HEIGHT = 100;\n\n  var DEFAULTS = {\n    // Define the view mode of the cropper\n    viewMode: 0,\n    // 0, 1, 2, 3\n\n    // Define the dragging mode of the cropper\n    dragMode: DRAG_MODE_CROP,\n    // 'crop', 'move' or 'none'\n\n    // Define the initial aspect ratio of the crop box\n    initialAspectRatio: NaN,\n    // Define the aspect ratio of the crop box\n    aspectRatio: NaN,\n    // An object with the previous cropping result data\n    data: null,\n    // A selector for adding extra containers to preview\n    preview: '',\n    // Re-render the cropper when resize the window\n    responsive: true,\n    // Restore the cropped area after resize the window\n    restore: true,\n    // Check if the current image is a cross-origin image\n    checkCrossOrigin: true,\n    // Check the current image's Exif Orientation information\n    checkOrientation: true,\n    // Show the black modal\n    modal: true,\n    // Show the dashed lines for guiding\n    guides: true,\n    // Show the center indicator for guiding\n    center: true,\n    // Show the white modal to highlight the crop box\n    highlight: true,\n    // Show the grid background\n    background: true,\n    // Enable to crop the image automatically when initialize\n    autoCrop: true,\n    // Define the percentage of automatic cropping area when initializes\n    autoCropArea: 0.8,\n    // Enable to move the image\n    movable: true,\n    // Enable to rotate the image\n    rotatable: true,\n    // Enable to scale the image\n    scalable: true,\n    // Enable to zoom the image\n    zoomable: true,\n    // Enable to zoom the image by dragging touch\n    zoomOnTouch: true,\n    // Enable to zoom the image by wheeling mouse\n    zoomOnWheel: true,\n    // Define zoom ratio when zoom the image by wheeling mouse\n    wheelZoomRatio: 0.1,\n    // Enable to move the crop box\n    cropBoxMovable: true,\n    // Enable to resize the crop box\n    cropBoxResizable: true,\n    // Toggle drag mode between \"crop\" and \"move\" when click twice on the cropper\n    toggleDragModeOnDblclick: true,\n    // Size limitation\n    minCanvasWidth: 0,\n    minCanvasHeight: 0,\n    minCropBoxWidth: 0,\n    minCropBoxHeight: 0,\n    minContainerWidth: MIN_CONTAINER_WIDTH,\n    minContainerHeight: MIN_CONTAINER_HEIGHT,\n    // Shortcuts of events\n    ready: null,\n    cropstart: null,\n    cropmove: null,\n    cropend: null,\n    crop: null,\n    zoom: null\n  };\n\n  var TEMPLATE = '<div class=\"cropper-container\" touch-action=\"none\">' + '<div class=\"cropper-wrap-box\">' + '<div class=\"cropper-canvas\"></div>' + '</div>' + '<div class=\"cropper-drag-box\"></div>' + '<div class=\"cropper-crop-box\">' + '<span class=\"cropper-view-box\"></span>' + '<span class=\"cropper-dashed dashed-h\"></span>' + '<span class=\"cropper-dashed dashed-v\"></span>' + '<span class=\"cropper-center\"></span>' + '<span class=\"cropper-face\"></span>' + '<span class=\"cropper-line line-e\" data-cropper-action=\"e\"></span>' + '<span class=\"cropper-line line-n\" data-cropper-action=\"n\"></span>' + '<span class=\"cropper-line line-w\" data-cropper-action=\"w\"></span>' + '<span class=\"cropper-line line-s\" data-cropper-action=\"s\"></span>' + '<span class=\"cropper-point point-e\" data-cropper-action=\"e\"></span>' + '<span class=\"cropper-point point-n\" data-cropper-action=\"n\"></span>' + '<span class=\"cropper-point point-w\" data-cropper-action=\"w\"></span>' + '<span class=\"cropper-point point-s\" data-cropper-action=\"s\"></span>' + '<span class=\"cropper-point point-ne\" data-cropper-action=\"ne\"></span>' + '<span class=\"cropper-point point-nw\" data-cropper-action=\"nw\"></span>' + '<span class=\"cropper-point point-sw\" data-cropper-action=\"sw\"></span>' + '<span class=\"cropper-point point-se\" data-cropper-action=\"se\"></span>' + '</div>' + '</div>';\n\n  /**\n   * Check if the given value is not a number.\n   */\n  var isNaN = Number.isNaN || WINDOW.isNaN;\n\n  /**\n   * Check if the given value is a number.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a number, else `false`.\n   */\n  function isNumber(value) {\n    return typeof value === 'number' && !isNaN(value);\n  }\n\n  /**\n   * Check if the given value is a positive number.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a positive number, else `false`.\n   */\n  var isPositiveNumber = function isPositiveNumber(value) {\n    return value > 0 && value < Infinity;\n  };\n\n  /**\n   * Check if the given value is undefined.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is undefined, else `false`.\n   */\n  function isUndefined(value) {\n    return typeof value === 'undefined';\n  }\n\n  /**\n   * Check if the given value is an object.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is an object, else `false`.\n   */\n  function isObject(value) {\n    return _typeof(value) === 'object' && value !== null;\n  }\n  var hasOwnProperty = Object.prototype.hasOwnProperty;\n\n  /**\n   * Check if the given value is a plain object.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a plain object, else `false`.\n   */\n  function isPlainObject(value) {\n    if (!isObject(value)) {\n      return false;\n    }\n    try {\n      var _constructor = value.constructor;\n      var prototype = _constructor.prototype;\n      return _constructor && prototype && hasOwnProperty.call(prototype, 'isPrototypeOf');\n    } catch (error) {\n      return false;\n    }\n  }\n\n  /**\n   * Check if the given value is a function.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a function, else `false`.\n   */\n  function isFunction(value) {\n    return typeof value === 'function';\n  }\n  var slice = Array.prototype.slice;\n\n  /**\n   * Convert array-like or iterable object to an array.\n   * @param {*} value - The value to convert.\n   * @returns {Array} Returns a new array.\n   */\n  function toArray(value) {\n    return Array.from ? Array.from(value) : slice.call(value);\n  }\n\n  /**\n   * Iterate the given data.\n   * @param {*} data - The data to iterate.\n   * @param {Function} callback - The process function for each element.\n   * @returns {*} The original data.\n   */\n  function forEach(data, callback) {\n    if (data && isFunction(callback)) {\n      if (Array.isArray(data) || isNumber(data.length) /* array-like */) {\n        toArray(data).forEach(function (value, key) {\n          callback.call(data, value, key, data);\n        });\n      } else if (isObject(data)) {\n        Object.keys(data).forEach(function (key) {\n          callback.call(data, data[key], key, data);\n        });\n      }\n    }\n    return data;\n  }\n\n  /**\n   * Extend the given object.\n   * @param {*} target - The target object to extend.\n   * @param {*} args - The rest objects for merging to the target object.\n   * @returns {Object} The extended object.\n   */\n  var assign = Object.assign || function assign(target) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n    if (isObject(target) && args.length > 0) {\n      args.forEach(function (arg) {\n        if (isObject(arg)) {\n          Object.keys(arg).forEach(function (key) {\n            target[key] = arg[key];\n          });\n        }\n      });\n    }\n    return target;\n  };\n  var REGEXP_DECIMALS = /\\.\\d*(?:0|9){12}\\d*$/;\n\n  /**\n   * Normalize decimal number.\n   * Check out {@link https://0.30000000000000004.com/}\n   * @param {number} value - The value to normalize.\n   * @param {number} [times=100000000000] - The times for normalizing.\n   * @returns {number} Returns the normalized number.\n   */\n  function normalizeDecimalNumber(value) {\n    var times = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 100000000000;\n    return REGEXP_DECIMALS.test(value) ? Math.round(value * times) / times : value;\n  }\n  var REGEXP_SUFFIX = /^width|height|left|top|marginLeft|marginTop$/;\n\n  /**\n   * Apply styles to the given element.\n   * @param {Element} element - The target element.\n   * @param {Object} styles - The styles for applying.\n   */\n  function setStyle(element, styles) {\n    var style = element.style;\n    forEach(styles, function (value, property) {\n      if (REGEXP_SUFFIX.test(property) && isNumber(value)) {\n        value = \"\".concat(value, \"px\");\n      }\n      style[property] = value;\n    });\n  }\n\n  /**\n   * Check if the given element has a special class.\n   * @param {Element} element - The element to check.\n   * @param {string} value - The class to search.\n   * @returns {boolean} Returns `true` if the special class was found.\n   */\n  function hasClass(element, value) {\n    return element.classList ? element.classList.contains(value) : element.className.indexOf(value) > -1;\n  }\n\n  /**\n   * Add classes to the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be added.\n   */\n  function addClass(element, value) {\n    if (!value) {\n      return;\n    }\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        addClass(elem, value);\n      });\n      return;\n    }\n    if (element.classList) {\n      element.classList.add(value);\n      return;\n    }\n    var className = element.className.trim();\n    if (!className) {\n      element.className = value;\n    } else if (className.indexOf(value) < 0) {\n      element.className = \"\".concat(className, \" \").concat(value);\n    }\n  }\n\n  /**\n   * Remove classes from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be removed.\n   */\n  function removeClass(element, value) {\n    if (!value) {\n      return;\n    }\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        removeClass(elem, value);\n      });\n      return;\n    }\n    if (element.classList) {\n      element.classList.remove(value);\n      return;\n    }\n    if (element.className.indexOf(value) >= 0) {\n      element.className = element.className.replace(value, '');\n    }\n  }\n\n  /**\n   * Add or remove classes from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be toggled.\n   * @param {boolean} added - Add only.\n   */\n  function toggleClass(element, value, added) {\n    if (!value) {\n      return;\n    }\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        toggleClass(elem, value, added);\n      });\n      return;\n    }\n\n    // IE10-11 doesn't support the second parameter of `classList.toggle`\n    if (added) {\n      addClass(element, value);\n    } else {\n      removeClass(element, value);\n    }\n  }\n  var REGEXP_CAMEL_CASE = /([a-z\\d])([A-Z])/g;\n\n  /**\n   * Transform the given string from camelCase to kebab-case\n   * @param {string} value - The value to transform.\n   * @returns {string} The transformed value.\n   */\n  function toParamCase(value) {\n    return value.replace(REGEXP_CAMEL_CASE, '$1-$2').toLowerCase();\n  }\n\n  /**\n   * Get data from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} name - The data key to get.\n   * @returns {string} The data value.\n   */\n  function getData(element, name) {\n    if (isObject(element[name])) {\n      return element[name];\n    }\n    if (element.dataset) {\n      return element.dataset[name];\n    }\n    return element.getAttribute(\"data-\".concat(toParamCase(name)));\n  }\n\n  /**\n   * Set data to the given element.\n   * @param {Element} element - The target element.\n   * @param {string} name - The data key to set.\n   * @param {string} data - The data value.\n   */\n  function setData(element, name, data) {\n    if (isObject(data)) {\n      element[name] = data;\n    } else if (element.dataset) {\n      element.dataset[name] = data;\n    } else {\n      element.setAttribute(\"data-\".concat(toParamCase(name)), data);\n    }\n  }\n\n  /**\n   * Remove data from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} name - The data key to remove.\n   */\n  function removeData(element, name) {\n    if (isObject(element[name])) {\n      try {\n        delete element[name];\n      } catch (error) {\n        element[name] = undefined;\n      }\n    } else if (element.dataset) {\n      // #128 Safari not allows to delete dataset property\n      try {\n        delete element.dataset[name];\n      } catch (error) {\n        element.dataset[name] = undefined;\n      }\n    } else {\n      element.removeAttribute(\"data-\".concat(toParamCase(name)));\n    }\n  }\n  var REGEXP_SPACES = /\\s\\s*/;\n  var onceSupported = function () {\n    var supported = false;\n    if (IS_BROWSER) {\n      var once = false;\n      var listener = function listener() {};\n      var options = Object.defineProperty({}, 'once', {\n        get: function get() {\n          supported = true;\n          return once;\n        },\n        /**\n         * This setter can fix a `TypeError` in strict mode\n         * {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Getter_only}\n         * @param {boolean} value - The value to set\n         */\n        set: function set(value) {\n          once = value;\n        }\n      });\n      WINDOW.addEventListener('test', listener, options);\n      WINDOW.removeEventListener('test', listener, options);\n    }\n    return supported;\n  }();\n\n  /**\n   * Remove event listener from the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Function} listener - The event listener.\n   * @param {Object} options - The event options.\n   */\n  function removeListener(element, type, listener) {\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    var handler = listener;\n    type.trim().split(REGEXP_SPACES).forEach(function (event) {\n      if (!onceSupported) {\n        var listeners = element.listeners;\n        if (listeners && listeners[event] && listeners[event][listener]) {\n          handler = listeners[event][listener];\n          delete listeners[event][listener];\n          if (Object.keys(listeners[event]).length === 0) {\n            delete listeners[event];\n          }\n          if (Object.keys(listeners).length === 0) {\n            delete element.listeners;\n          }\n        }\n      }\n      element.removeEventListener(event, handler, options);\n    });\n  }\n\n  /**\n   * Add event listener to the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Function} listener - The event listener.\n   * @param {Object} options - The event options.\n   */\n  function addListener(element, type, listener) {\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    var _handler = listener;\n    type.trim().split(REGEXP_SPACES).forEach(function (event) {\n      if (options.once && !onceSupported) {\n        var _element$listeners = element.listeners,\n          listeners = _element$listeners === void 0 ? {} : _element$listeners;\n        _handler = function handler() {\n          delete listeners[event][listener];\n          element.removeEventListener(event, _handler, options);\n          for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n            args[_key2] = arguments[_key2];\n          }\n          listener.apply(element, args);\n        };\n        if (!listeners[event]) {\n          listeners[event] = {};\n        }\n        if (listeners[event][listener]) {\n          element.removeEventListener(event, listeners[event][listener], options);\n        }\n        listeners[event][listener] = _handler;\n        element.listeners = listeners;\n      }\n      element.addEventListener(event, _handler, options);\n    });\n  }\n\n  /**\n   * Dispatch event on the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Object} data - The additional event data.\n   * @returns {boolean} Indicate if the event is default prevented or not.\n   */\n  function dispatchEvent(element, type, data) {\n    var event;\n\n    // Event and CustomEvent on IE9-11 are global objects, not constructors\n    if (isFunction(Event) && isFunction(CustomEvent)) {\n      event = new CustomEvent(type, {\n        detail: data,\n        bubbles: true,\n        cancelable: true\n      });\n    } else {\n      event = document.createEvent('CustomEvent');\n      event.initCustomEvent(type, true, true, data);\n    }\n    return element.dispatchEvent(event);\n  }\n\n  /**\n   * Get the offset base on the document.\n   * @param {Element} element - The target element.\n   * @returns {Object} The offset data.\n   */\n  function getOffset(element) {\n    var box = element.getBoundingClientRect();\n    return {\n      left: box.left + (window.pageXOffset - document.documentElement.clientLeft),\n      top: box.top + (window.pageYOffset - document.documentElement.clientTop)\n    };\n  }\n  var location = WINDOW.location;\n  var REGEXP_ORIGINS = /^(\\w+:)\\/\\/([^:/?#]*):?(\\d*)/i;\n\n  /**\n   * Check if the given URL is a cross origin URL.\n   * @param {string} url - The target URL.\n   * @returns {boolean} Returns `true` if the given URL is a cross origin URL, else `false`.\n   */\n  function isCrossOriginURL(url) {\n    var parts = url.match(REGEXP_ORIGINS);\n    return parts !== null && (parts[1] !== location.protocol || parts[2] !== location.hostname || parts[3] !== location.port);\n  }\n\n  /**\n   * Add timestamp to the given URL.\n   * @param {string} url - The target URL.\n   * @returns {string} The result URL.\n   */\n  function addTimestamp(url) {\n    var timestamp = \"timestamp=\".concat(new Date().getTime());\n    return url + (url.indexOf('?') === -1 ? '?' : '&') + timestamp;\n  }\n\n  /**\n   * Get transforms base on the given object.\n   * @param {Object} obj - The target object.\n   * @returns {string} A string contains transform values.\n   */\n  function getTransforms(_ref) {\n    var rotate = _ref.rotate,\n      scaleX = _ref.scaleX,\n      scaleY = _ref.scaleY,\n      translateX = _ref.translateX,\n      translateY = _ref.translateY;\n    var values = [];\n    if (isNumber(translateX) && translateX !== 0) {\n      values.push(\"translateX(\".concat(translateX, \"px)\"));\n    }\n    if (isNumber(translateY) && translateY !== 0) {\n      values.push(\"translateY(\".concat(translateY, \"px)\"));\n    }\n\n    // Rotate should come first before scale to match orientation transform\n    if (isNumber(rotate) && rotate !== 0) {\n      values.push(\"rotate(\".concat(rotate, \"deg)\"));\n    }\n    if (isNumber(scaleX) && scaleX !== 1) {\n      values.push(\"scaleX(\".concat(scaleX, \")\"));\n    }\n    if (isNumber(scaleY) && scaleY !== 1) {\n      values.push(\"scaleY(\".concat(scaleY, \")\"));\n    }\n    var transform = values.length ? values.join(' ') : 'none';\n    return {\n      WebkitTransform: transform,\n      msTransform: transform,\n      transform: transform\n    };\n  }\n\n  /**\n   * Get the max ratio of a group of pointers.\n   * @param {string} pointers - The target pointers.\n   * @returns {number} The result ratio.\n   */\n  function getMaxZoomRatio(pointers) {\n    var pointers2 = _objectSpread2({}, pointers);\n    var maxRatio = 0;\n    forEach(pointers, function (pointer, pointerId) {\n      delete pointers2[pointerId];\n      forEach(pointers2, function (pointer2) {\n        var x1 = Math.abs(pointer.startX - pointer2.startX);\n        var y1 = Math.abs(pointer.startY - pointer2.startY);\n        var x2 = Math.abs(pointer.endX - pointer2.endX);\n        var y2 = Math.abs(pointer.endY - pointer2.endY);\n        var z1 = Math.sqrt(x1 * x1 + y1 * y1);\n        var z2 = Math.sqrt(x2 * x2 + y2 * y2);\n        var ratio = (z2 - z1) / z1;\n        if (Math.abs(ratio) > Math.abs(maxRatio)) {\n          maxRatio = ratio;\n        }\n      });\n    });\n    return maxRatio;\n  }\n\n  /**\n   * Get a pointer from an event object.\n   * @param {Object} event - The target event object.\n   * @param {boolean} endOnly - Indicates if only returns the end point coordinate or not.\n   * @returns {Object} The result pointer contains start and/or end point coordinates.\n   */\n  function getPointer(_ref2, endOnly) {\n    var pageX = _ref2.pageX,\n      pageY = _ref2.pageY;\n    var end = {\n      endX: pageX,\n      endY: pageY\n    };\n    return endOnly ? end : _objectSpread2({\n      startX: pageX,\n      startY: pageY\n    }, end);\n  }\n\n  /**\n   * Get the center point coordinate of a group of pointers.\n   * @param {Object} pointers - The target pointers.\n   * @returns {Object} The center point coordinate.\n   */\n  function getPointersCenter(pointers) {\n    var pageX = 0;\n    var pageY = 0;\n    var count = 0;\n    forEach(pointers, function (_ref3) {\n      var startX = _ref3.startX,\n        startY = _ref3.startY;\n      pageX += startX;\n      pageY += startY;\n      count += 1;\n    });\n    pageX /= count;\n    pageY /= count;\n    return {\n      pageX: pageX,\n      pageY: pageY\n    };\n  }\n\n  /**\n   * Get the max sizes in a rectangle under the given aspect ratio.\n   * @param {Object} data - The original sizes.\n   * @param {string} [type='contain'] - The adjust type.\n   * @returns {Object} The result sizes.\n   */\n  function getAdjustedSizes(_ref4) {\n    var aspectRatio = _ref4.aspectRatio,\n      height = _ref4.height,\n      width = _ref4.width;\n    var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'contain';\n    var isValidWidth = isPositiveNumber(width);\n    var isValidHeight = isPositiveNumber(height);\n    if (isValidWidth && isValidHeight) {\n      var adjustedWidth = height * aspectRatio;\n      if (type === 'contain' && adjustedWidth > width || type === 'cover' && adjustedWidth < width) {\n        height = width / aspectRatio;\n      } else {\n        width = height * aspectRatio;\n      }\n    } else if (isValidWidth) {\n      height = width / aspectRatio;\n    } else if (isValidHeight) {\n      width = height * aspectRatio;\n    }\n    return {\n      width: width,\n      height: height\n    };\n  }\n\n  /**\n   * Get the new sizes of a rectangle after rotated.\n   * @param {Object} data - The original sizes.\n   * @returns {Object} The result sizes.\n   */\n  function getRotatedSizes(_ref5) {\n    var width = _ref5.width,\n      height = _ref5.height,\n      degree = _ref5.degree;\n    degree = Math.abs(degree) % 180;\n    if (degree === 90) {\n      return {\n        width: height,\n        height: width\n      };\n    }\n    var arc = degree % 90 * Math.PI / 180;\n    var sinArc = Math.sin(arc);\n    var cosArc = Math.cos(arc);\n    var newWidth = width * cosArc + height * sinArc;\n    var newHeight = width * sinArc + height * cosArc;\n    return degree > 90 ? {\n      width: newHeight,\n      height: newWidth\n    } : {\n      width: newWidth,\n      height: newHeight\n    };\n  }\n\n  /**\n   * Get a canvas which drew the given image.\n   * @param {HTMLImageElement} image - The image for drawing.\n   * @param {Object} imageData - The image data.\n   * @param {Object} canvasData - The canvas data.\n   * @param {Object} options - The options.\n   * @returns {HTMLCanvasElement} The result canvas.\n   */\n  function getSourceCanvas(image, _ref6, _ref7, _ref8) {\n    var imageAspectRatio = _ref6.aspectRatio,\n      imageNaturalWidth = _ref6.naturalWidth,\n      imageNaturalHeight = _ref6.naturalHeight,\n      _ref6$rotate = _ref6.rotate,\n      rotate = _ref6$rotate === void 0 ? 0 : _ref6$rotate,\n      _ref6$scaleX = _ref6.scaleX,\n      scaleX = _ref6$scaleX === void 0 ? 1 : _ref6$scaleX,\n      _ref6$scaleY = _ref6.scaleY,\n      scaleY = _ref6$scaleY === void 0 ? 1 : _ref6$scaleY;\n    var aspectRatio = _ref7.aspectRatio,\n      naturalWidth = _ref7.naturalWidth,\n      naturalHeight = _ref7.naturalHeight;\n    var _ref8$fillColor = _ref8.fillColor,\n      fillColor = _ref8$fillColor === void 0 ? 'transparent' : _ref8$fillColor,\n      _ref8$imageSmoothingE = _ref8.imageSmoothingEnabled,\n      imageSmoothingEnabled = _ref8$imageSmoothingE === void 0 ? true : _ref8$imageSmoothingE,\n      _ref8$imageSmoothingQ = _ref8.imageSmoothingQuality,\n      imageSmoothingQuality = _ref8$imageSmoothingQ === void 0 ? 'low' : _ref8$imageSmoothingQ,\n      _ref8$maxWidth = _ref8.maxWidth,\n      maxWidth = _ref8$maxWidth === void 0 ? Infinity : _ref8$maxWidth,\n      _ref8$maxHeight = _ref8.maxHeight,\n      maxHeight = _ref8$maxHeight === void 0 ? Infinity : _ref8$maxHeight,\n      _ref8$minWidth = _ref8.minWidth,\n      minWidth = _ref8$minWidth === void 0 ? 0 : _ref8$minWidth,\n      _ref8$minHeight = _ref8.minHeight,\n      minHeight = _ref8$minHeight === void 0 ? 0 : _ref8$minHeight;\n    var canvas = document.createElement('canvas');\n    var context = canvas.getContext('2d');\n    var maxSizes = getAdjustedSizes({\n      aspectRatio: aspectRatio,\n      width: maxWidth,\n      height: maxHeight\n    });\n    var minSizes = getAdjustedSizes({\n      aspectRatio: aspectRatio,\n      width: minWidth,\n      height: minHeight\n    }, 'cover');\n    var width = Math.min(maxSizes.width, Math.max(minSizes.width, naturalWidth));\n    var height = Math.min(maxSizes.height, Math.max(minSizes.height, naturalHeight));\n\n    // Note: should always use image's natural sizes for drawing as\n    // imageData.naturalWidth === canvasData.naturalHeight when rotate % 180 === 90\n    var destMaxSizes = getAdjustedSizes({\n      aspectRatio: imageAspectRatio,\n      width: maxWidth,\n      height: maxHeight\n    });\n    var destMinSizes = getAdjustedSizes({\n      aspectRatio: imageAspectRatio,\n      width: minWidth,\n      height: minHeight\n    }, 'cover');\n    var destWidth = Math.min(destMaxSizes.width, Math.max(destMinSizes.width, imageNaturalWidth));\n    var destHeight = Math.min(destMaxSizes.height, Math.max(destMinSizes.height, imageNaturalHeight));\n    var params = [-destWidth / 2, -destHeight / 2, destWidth, destHeight];\n    canvas.width = normalizeDecimalNumber(width);\n    canvas.height = normalizeDecimalNumber(height);\n    context.fillStyle = fillColor;\n    context.fillRect(0, 0, width, height);\n    context.save();\n    context.translate(width / 2, height / 2);\n    context.rotate(rotate * Math.PI / 180);\n    context.scale(scaleX, scaleY);\n    context.imageSmoothingEnabled = imageSmoothingEnabled;\n    context.imageSmoothingQuality = imageSmoothingQuality;\n    context.drawImage.apply(context, [image].concat(_toConsumableArray(params.map(function (param) {\n      return Math.floor(normalizeDecimalNumber(param));\n    }))));\n    context.restore();\n    return canvas;\n  }\n  var fromCharCode = String.fromCharCode;\n\n  /**\n   * Get string from char code in data view.\n   * @param {DataView} dataView - The data view for read.\n   * @param {number} start - The start index.\n   * @param {number} length - The read length.\n   * @returns {string} The read result.\n   */\n  function getStringFromCharCode(dataView, start, length) {\n    var str = '';\n    length += start;\n    for (var i = start; i < length; i += 1) {\n      str += fromCharCode(dataView.getUint8(i));\n    }\n    return str;\n  }\n  var REGEXP_DATA_URL_HEAD = /^data:.*,/;\n\n  /**\n   * Transform Data URL to array buffer.\n   * @param {string} dataURL - The Data URL to transform.\n   * @returns {ArrayBuffer} The result array buffer.\n   */\n  function dataURLToArrayBuffer(dataURL) {\n    var base64 = dataURL.replace(REGEXP_DATA_URL_HEAD, '');\n    var binary = atob(base64);\n    var arrayBuffer = new ArrayBuffer(binary.length);\n    var uint8 = new Uint8Array(arrayBuffer);\n    forEach(uint8, function (value, i) {\n      uint8[i] = binary.charCodeAt(i);\n    });\n    return arrayBuffer;\n  }\n\n  /**\n   * Transform array buffer to Data URL.\n   * @param {ArrayBuffer} arrayBuffer - The array buffer to transform.\n   * @param {string} mimeType - The mime type of the Data URL.\n   * @returns {string} The result Data URL.\n   */\n  function arrayBufferToDataURL(arrayBuffer, mimeType) {\n    var chunks = [];\n\n    // Chunk Typed Array for better performance (#435)\n    var chunkSize = 8192;\n    var uint8 = new Uint8Array(arrayBuffer);\n    while (uint8.length > 0) {\n      // XXX: Babel's `toConsumableArray` helper will throw error in IE or Safari 9\n      // eslint-disable-next-line prefer-spread\n      chunks.push(fromCharCode.apply(null, toArray(uint8.subarray(0, chunkSize))));\n      uint8 = uint8.subarray(chunkSize);\n    }\n    return \"data:\".concat(mimeType, \";base64,\").concat(btoa(chunks.join('')));\n  }\n\n  /**\n   * Get orientation value from given array buffer.\n   * @param {ArrayBuffer} arrayBuffer - The array buffer to read.\n   * @returns {number} The read orientation value.\n   */\n  function resetAndGetOrientation(arrayBuffer) {\n    var dataView = new DataView(arrayBuffer);\n    var orientation;\n\n    // Ignores range error when the image does not have correct Exif information\n    try {\n      var littleEndian;\n      var app1Start;\n      var ifdStart;\n\n      // Only handle JPEG image (start by 0xFFD8)\n      if (dataView.getUint8(0) === 0xFF && dataView.getUint8(1) === 0xD8) {\n        var length = dataView.byteLength;\n        var offset = 2;\n        while (offset + 1 < length) {\n          if (dataView.getUint8(offset) === 0xFF && dataView.getUint8(offset + 1) === 0xE1) {\n            app1Start = offset;\n            break;\n          }\n          offset += 1;\n        }\n      }\n      if (app1Start) {\n        var exifIDCode = app1Start + 4;\n        var tiffOffset = app1Start + 10;\n        if (getStringFromCharCode(dataView, exifIDCode, 4) === 'Exif') {\n          var endianness = dataView.getUint16(tiffOffset);\n          littleEndian = endianness === 0x4949;\n          if (littleEndian || endianness === 0x4D4D /* bigEndian */) {\n            if (dataView.getUint16(tiffOffset + 2, littleEndian) === 0x002A) {\n              var firstIFDOffset = dataView.getUint32(tiffOffset + 4, littleEndian);\n              if (firstIFDOffset >= 0x00000008) {\n                ifdStart = tiffOffset + firstIFDOffset;\n              }\n            }\n          }\n        }\n      }\n      if (ifdStart) {\n        var _length = dataView.getUint16(ifdStart, littleEndian);\n        var _offset;\n        var i;\n        for (i = 0; i < _length; i += 1) {\n          _offset = ifdStart + i * 12 + 2;\n          if (dataView.getUint16(_offset, littleEndian) === 0x0112 /* Orientation */) {\n            // 8 is the offset of the current tag's value\n            _offset += 8;\n\n            // Get the original orientation value\n            orientation = dataView.getUint16(_offset, littleEndian);\n\n            // Override the orientation with its default value\n            dataView.setUint16(_offset, 1, littleEndian);\n            break;\n          }\n        }\n      }\n    } catch (error) {\n      orientation = 1;\n    }\n    return orientation;\n  }\n\n  /**\n   * Parse Exif Orientation value.\n   * @param {number} orientation - The orientation to parse.\n   * @returns {Object} The parsed result.\n   */\n  function parseOrientation(orientation) {\n    var rotate = 0;\n    var scaleX = 1;\n    var scaleY = 1;\n    switch (orientation) {\n      // Flip horizontal\n      case 2:\n        scaleX = -1;\n        break;\n\n      // Rotate left 180\n      case 3:\n        rotate = -180;\n        break;\n\n      // Flip vertical\n      case 4:\n        scaleY = -1;\n        break;\n\n      // Flip vertical and rotate right 90\n      case 5:\n        rotate = 90;\n        scaleY = -1;\n        break;\n\n      // Rotate right 90\n      case 6:\n        rotate = 90;\n        break;\n\n      // Flip horizontal and rotate right 90\n      case 7:\n        rotate = 90;\n        scaleX = -1;\n        break;\n\n      // Rotate left 90\n      case 8:\n        rotate = -90;\n        break;\n    }\n    return {\n      rotate: rotate,\n      scaleX: scaleX,\n      scaleY: scaleY\n    };\n  }\n\n  var render = {\n    render: function render() {\n      this.initContainer();\n      this.initCanvas();\n      this.initCropBox();\n      this.renderCanvas();\n      if (this.cropped) {\n        this.renderCropBox();\n      }\n    },\n    initContainer: function initContainer() {\n      var element = this.element,\n        options = this.options,\n        container = this.container,\n        cropper = this.cropper;\n      var minWidth = Number(options.minContainerWidth);\n      var minHeight = Number(options.minContainerHeight);\n      addClass(cropper, CLASS_HIDDEN);\n      removeClass(element, CLASS_HIDDEN);\n      var containerData = {\n        width: Math.max(container.offsetWidth, minWidth >= 0 ? minWidth : MIN_CONTAINER_WIDTH),\n        height: Math.max(container.offsetHeight, minHeight >= 0 ? minHeight : MIN_CONTAINER_HEIGHT)\n      };\n      this.containerData = containerData;\n      setStyle(cropper, {\n        width: containerData.width,\n        height: containerData.height\n      });\n      addClass(element, CLASS_HIDDEN);\n      removeClass(cropper, CLASS_HIDDEN);\n    },\n    // Canvas (image wrapper)\n    initCanvas: function initCanvas() {\n      var containerData = this.containerData,\n        imageData = this.imageData;\n      var viewMode = this.options.viewMode;\n      var rotated = Math.abs(imageData.rotate) % 180 === 90;\n      var naturalWidth = rotated ? imageData.naturalHeight : imageData.naturalWidth;\n      var naturalHeight = rotated ? imageData.naturalWidth : imageData.naturalHeight;\n      var aspectRatio = naturalWidth / naturalHeight;\n      var canvasWidth = containerData.width;\n      var canvasHeight = containerData.height;\n      if (containerData.height * aspectRatio > containerData.width) {\n        if (viewMode === 3) {\n          canvasWidth = containerData.height * aspectRatio;\n        } else {\n          canvasHeight = containerData.width / aspectRatio;\n        }\n      } else if (viewMode === 3) {\n        canvasHeight = containerData.width / aspectRatio;\n      } else {\n        canvasWidth = containerData.height * aspectRatio;\n      }\n      var canvasData = {\n        aspectRatio: aspectRatio,\n        naturalWidth: naturalWidth,\n        naturalHeight: naturalHeight,\n        width: canvasWidth,\n        height: canvasHeight\n      };\n      this.canvasData = canvasData;\n      this.limited = viewMode === 1 || viewMode === 2;\n      this.limitCanvas(true, true);\n      canvasData.width = Math.min(Math.max(canvasData.width, canvasData.minWidth), canvasData.maxWidth);\n      canvasData.height = Math.min(Math.max(canvasData.height, canvasData.minHeight), canvasData.maxHeight);\n      canvasData.left = (containerData.width - canvasData.width) / 2;\n      canvasData.top = (containerData.height - canvasData.height) / 2;\n      canvasData.oldLeft = canvasData.left;\n      canvasData.oldTop = canvasData.top;\n      this.initialCanvasData = assign({}, canvasData);\n    },\n    limitCanvas: function limitCanvas(sizeLimited, positionLimited) {\n      var options = this.options,\n        containerData = this.containerData,\n        canvasData = this.canvasData,\n        cropBoxData = this.cropBoxData;\n      var viewMode = options.viewMode;\n      var aspectRatio = canvasData.aspectRatio;\n      var cropped = this.cropped && cropBoxData;\n      if (sizeLimited) {\n        var minCanvasWidth = Number(options.minCanvasWidth) || 0;\n        var minCanvasHeight = Number(options.minCanvasHeight) || 0;\n        if (viewMode > 1) {\n          minCanvasWidth = Math.max(minCanvasWidth, containerData.width);\n          minCanvasHeight = Math.max(minCanvasHeight, containerData.height);\n          if (viewMode === 3) {\n            if (minCanvasHeight * aspectRatio > minCanvasWidth) {\n              minCanvasWidth = minCanvasHeight * aspectRatio;\n            } else {\n              minCanvasHeight = minCanvasWidth / aspectRatio;\n            }\n          }\n        } else if (viewMode > 0) {\n          if (minCanvasWidth) {\n            minCanvasWidth = Math.max(minCanvasWidth, cropped ? cropBoxData.width : 0);\n          } else if (minCanvasHeight) {\n            minCanvasHeight = Math.max(minCanvasHeight, cropped ? cropBoxData.height : 0);\n          } else if (cropped) {\n            minCanvasWidth = cropBoxData.width;\n            minCanvasHeight = cropBoxData.height;\n            if (minCanvasHeight * aspectRatio > minCanvasWidth) {\n              minCanvasWidth = minCanvasHeight * aspectRatio;\n            } else {\n              minCanvasHeight = minCanvasWidth / aspectRatio;\n            }\n          }\n        }\n        var _getAdjustedSizes = getAdjustedSizes({\n          aspectRatio: aspectRatio,\n          width: minCanvasWidth,\n          height: minCanvasHeight\n        });\n        minCanvasWidth = _getAdjustedSizes.width;\n        minCanvasHeight = _getAdjustedSizes.height;\n        canvasData.minWidth = minCanvasWidth;\n        canvasData.minHeight = minCanvasHeight;\n        canvasData.maxWidth = Infinity;\n        canvasData.maxHeight = Infinity;\n      }\n      if (positionLimited) {\n        if (viewMode > (cropped ? 0 : 1)) {\n          var newCanvasLeft = containerData.width - canvasData.width;\n          var newCanvasTop = containerData.height - canvasData.height;\n          canvasData.minLeft = Math.min(0, newCanvasLeft);\n          canvasData.minTop = Math.min(0, newCanvasTop);\n          canvasData.maxLeft = Math.max(0, newCanvasLeft);\n          canvasData.maxTop = Math.max(0, newCanvasTop);\n          if (cropped && this.limited) {\n            canvasData.minLeft = Math.min(cropBoxData.left, cropBoxData.left + (cropBoxData.width - canvasData.width));\n            canvasData.minTop = Math.min(cropBoxData.top, cropBoxData.top + (cropBoxData.height - canvasData.height));\n            canvasData.maxLeft = cropBoxData.left;\n            canvasData.maxTop = cropBoxData.top;\n            if (viewMode === 2) {\n              if (canvasData.width >= containerData.width) {\n                canvasData.minLeft = Math.min(0, newCanvasLeft);\n                canvasData.maxLeft = Math.max(0, newCanvasLeft);\n              }\n              if (canvasData.height >= containerData.height) {\n                canvasData.minTop = Math.min(0, newCanvasTop);\n                canvasData.maxTop = Math.max(0, newCanvasTop);\n              }\n            }\n          }\n        } else {\n          canvasData.minLeft = -canvasData.width;\n          canvasData.minTop = -canvasData.height;\n          canvasData.maxLeft = containerData.width;\n          canvasData.maxTop = containerData.height;\n        }\n      }\n    },\n    renderCanvas: function renderCanvas(changed, transformed) {\n      var canvasData = this.canvasData,\n        imageData = this.imageData;\n      if (transformed) {\n        var _getRotatedSizes = getRotatedSizes({\n            width: imageData.naturalWidth * Math.abs(imageData.scaleX || 1),\n            height: imageData.naturalHeight * Math.abs(imageData.scaleY || 1),\n            degree: imageData.rotate || 0\n          }),\n          naturalWidth = _getRotatedSizes.width,\n          naturalHeight = _getRotatedSizes.height;\n        var width = canvasData.width * (naturalWidth / canvasData.naturalWidth);\n        var height = canvasData.height * (naturalHeight / canvasData.naturalHeight);\n        canvasData.left -= (width - canvasData.width) / 2;\n        canvasData.top -= (height - canvasData.height) / 2;\n        canvasData.width = width;\n        canvasData.height = height;\n        canvasData.aspectRatio = naturalWidth / naturalHeight;\n        canvasData.naturalWidth = naturalWidth;\n        canvasData.naturalHeight = naturalHeight;\n        this.limitCanvas(true, false);\n      }\n      if (canvasData.width > canvasData.maxWidth || canvasData.width < canvasData.minWidth) {\n        canvasData.left = canvasData.oldLeft;\n      }\n      if (canvasData.height > canvasData.maxHeight || canvasData.height < canvasData.minHeight) {\n        canvasData.top = canvasData.oldTop;\n      }\n      canvasData.width = Math.min(Math.max(canvasData.width, canvasData.minWidth), canvasData.maxWidth);\n      canvasData.height = Math.min(Math.max(canvasData.height, canvasData.minHeight), canvasData.maxHeight);\n      this.limitCanvas(false, true);\n      canvasData.left = Math.min(Math.max(canvasData.left, canvasData.minLeft), canvasData.maxLeft);\n      canvasData.top = Math.min(Math.max(canvasData.top, canvasData.minTop), canvasData.maxTop);\n      canvasData.oldLeft = canvasData.left;\n      canvasData.oldTop = canvasData.top;\n      setStyle(this.canvas, assign({\n        width: canvasData.width,\n        height: canvasData.height\n      }, getTransforms({\n        translateX: canvasData.left,\n        translateY: canvasData.top\n      })));\n      this.renderImage(changed);\n      if (this.cropped && this.limited) {\n        this.limitCropBox(true, true);\n      }\n    },\n    renderImage: function renderImage(changed) {\n      var canvasData = this.canvasData,\n        imageData = this.imageData;\n      var width = imageData.naturalWidth * (canvasData.width / canvasData.naturalWidth);\n      var height = imageData.naturalHeight * (canvasData.height / canvasData.naturalHeight);\n      assign(imageData, {\n        width: width,\n        height: height,\n        left: (canvasData.width - width) / 2,\n        top: (canvasData.height - height) / 2\n      });\n      setStyle(this.image, assign({\n        width: imageData.width,\n        height: imageData.height\n      }, getTransforms(assign({\n        translateX: imageData.left,\n        translateY: imageData.top\n      }, imageData))));\n      if (changed) {\n        this.output();\n      }\n    },\n    initCropBox: function initCropBox() {\n      var options = this.options,\n        canvasData = this.canvasData;\n      var aspectRatio = options.aspectRatio || options.initialAspectRatio;\n      var autoCropArea = Number(options.autoCropArea) || 0.8;\n      var cropBoxData = {\n        width: canvasData.width,\n        height: canvasData.height\n      };\n      if (aspectRatio) {\n        if (canvasData.height * aspectRatio > canvasData.width) {\n          cropBoxData.height = cropBoxData.width / aspectRatio;\n        } else {\n          cropBoxData.width = cropBoxData.height * aspectRatio;\n        }\n      }\n      this.cropBoxData = cropBoxData;\n      this.limitCropBox(true, true);\n\n      // Initialize auto crop area\n      cropBoxData.width = Math.min(Math.max(cropBoxData.width, cropBoxData.minWidth), cropBoxData.maxWidth);\n      cropBoxData.height = Math.min(Math.max(cropBoxData.height, cropBoxData.minHeight), cropBoxData.maxHeight);\n\n      // The width/height of auto crop area must large than \"minWidth/Height\"\n      cropBoxData.width = Math.max(cropBoxData.minWidth, cropBoxData.width * autoCropArea);\n      cropBoxData.height = Math.max(cropBoxData.minHeight, cropBoxData.height * autoCropArea);\n      cropBoxData.left = canvasData.left + (canvasData.width - cropBoxData.width) / 2;\n      cropBoxData.top = canvasData.top + (canvasData.height - cropBoxData.height) / 2;\n      cropBoxData.oldLeft = cropBoxData.left;\n      cropBoxData.oldTop = cropBoxData.top;\n      this.initialCropBoxData = assign({}, cropBoxData);\n    },\n    limitCropBox: function limitCropBox(sizeLimited, positionLimited) {\n      var options = this.options,\n        containerData = this.containerData,\n        canvasData = this.canvasData,\n        cropBoxData = this.cropBoxData,\n        limited = this.limited;\n      var aspectRatio = options.aspectRatio;\n      if (sizeLimited) {\n        var minCropBoxWidth = Number(options.minCropBoxWidth) || 0;\n        var minCropBoxHeight = Number(options.minCropBoxHeight) || 0;\n        var maxCropBoxWidth = limited ? Math.min(containerData.width, canvasData.width, canvasData.width + canvasData.left, containerData.width - canvasData.left) : containerData.width;\n        var maxCropBoxHeight = limited ? Math.min(containerData.height, canvasData.height, canvasData.height + canvasData.top, containerData.height - canvasData.top) : containerData.height;\n\n        // The min/maxCropBoxWidth/Height must be less than container's width/height\n        minCropBoxWidth = Math.min(minCropBoxWidth, containerData.width);\n        minCropBoxHeight = Math.min(minCropBoxHeight, containerData.height);\n        if (aspectRatio) {\n          if (minCropBoxWidth && minCropBoxHeight) {\n            if (minCropBoxHeight * aspectRatio > minCropBoxWidth) {\n              minCropBoxHeight = minCropBoxWidth / aspectRatio;\n            } else {\n              minCropBoxWidth = minCropBoxHeight * aspectRatio;\n            }\n          } else if (minCropBoxWidth) {\n            minCropBoxHeight = minCropBoxWidth / aspectRatio;\n          } else if (minCropBoxHeight) {\n            minCropBoxWidth = minCropBoxHeight * aspectRatio;\n          }\n          if (maxCropBoxHeight * aspectRatio > maxCropBoxWidth) {\n            maxCropBoxHeight = maxCropBoxWidth / aspectRatio;\n          } else {\n            maxCropBoxWidth = maxCropBoxHeight * aspectRatio;\n          }\n        }\n\n        // The minWidth/Height must be less than maxWidth/Height\n        cropBoxData.minWidth = Math.min(minCropBoxWidth, maxCropBoxWidth);\n        cropBoxData.minHeight = Math.min(minCropBoxHeight, maxCropBoxHeight);\n        cropBoxData.maxWidth = maxCropBoxWidth;\n        cropBoxData.maxHeight = maxCropBoxHeight;\n      }\n      if (positionLimited) {\n        if (limited) {\n          cropBoxData.minLeft = Math.max(0, canvasData.left);\n          cropBoxData.minTop = Math.max(0, canvasData.top);\n          cropBoxData.maxLeft = Math.min(containerData.width, canvasData.left + canvasData.width) - cropBoxData.width;\n          cropBoxData.maxTop = Math.min(containerData.height, canvasData.top + canvasData.height) - cropBoxData.height;\n        } else {\n          cropBoxData.minLeft = 0;\n          cropBoxData.minTop = 0;\n          cropBoxData.maxLeft = containerData.width - cropBoxData.width;\n          cropBoxData.maxTop = containerData.height - cropBoxData.height;\n        }\n      }\n    },\n    renderCropBox: function renderCropBox() {\n      var options = this.options,\n        containerData = this.containerData,\n        cropBoxData = this.cropBoxData;\n      if (cropBoxData.width > cropBoxData.maxWidth || cropBoxData.width < cropBoxData.minWidth) {\n        cropBoxData.left = cropBoxData.oldLeft;\n      }\n      if (cropBoxData.height > cropBoxData.maxHeight || cropBoxData.height < cropBoxData.minHeight) {\n        cropBoxData.top = cropBoxData.oldTop;\n      }\n      cropBoxData.width = Math.min(Math.max(cropBoxData.width, cropBoxData.minWidth), cropBoxData.maxWidth);\n      cropBoxData.height = Math.min(Math.max(cropBoxData.height, cropBoxData.minHeight), cropBoxData.maxHeight);\n      this.limitCropBox(false, true);\n      cropBoxData.left = Math.min(Math.max(cropBoxData.left, cropBoxData.minLeft), cropBoxData.maxLeft);\n      cropBoxData.top = Math.min(Math.max(cropBoxData.top, cropBoxData.minTop), cropBoxData.maxTop);\n      cropBoxData.oldLeft = cropBoxData.left;\n      cropBoxData.oldTop = cropBoxData.top;\n      if (options.movable && options.cropBoxMovable) {\n        // Turn to move the canvas when the crop box is equal to the container\n        setData(this.face, DATA_ACTION, cropBoxData.width >= containerData.width && cropBoxData.height >= containerData.height ? ACTION_MOVE : ACTION_ALL);\n      }\n      setStyle(this.cropBox, assign({\n        width: cropBoxData.width,\n        height: cropBoxData.height\n      }, getTransforms({\n        translateX: cropBoxData.left,\n        translateY: cropBoxData.top\n      })));\n      if (this.cropped && this.limited) {\n        this.limitCanvas(true, true);\n      }\n      if (!this.disabled) {\n        this.output();\n      }\n    },\n    output: function output() {\n      this.preview();\n      dispatchEvent(this.element, EVENT_CROP, this.getData());\n    }\n  };\n\n  var preview = {\n    initPreview: function initPreview() {\n      var element = this.element,\n        crossOrigin = this.crossOrigin;\n      var preview = this.options.preview;\n      var url = crossOrigin ? this.crossOriginUrl : this.url;\n      var alt = element.alt || 'The image to preview';\n      var image = document.createElement('img');\n      if (crossOrigin) {\n        image.crossOrigin = crossOrigin;\n      }\n      image.src = url;\n      image.alt = alt;\n      this.viewBox.appendChild(image);\n      this.viewBoxImage = image;\n      if (!preview) {\n        return;\n      }\n      var previews = preview;\n      if (typeof preview === 'string') {\n        previews = element.ownerDocument.querySelectorAll(preview);\n      } else if (preview.querySelector) {\n        previews = [preview];\n      }\n      this.previews = previews;\n      forEach(previews, function (el) {\n        var img = document.createElement('img');\n\n        // Save the original size for recover\n        setData(el, DATA_PREVIEW, {\n          width: el.offsetWidth,\n          height: el.offsetHeight,\n          html: el.innerHTML\n        });\n        if (crossOrigin) {\n          img.crossOrigin = crossOrigin;\n        }\n        img.src = url;\n        img.alt = alt;\n\n        /**\n         * Override img element styles\n         * Add `display:block` to avoid margin top issue\n         * Add `height:auto` to override `height` attribute on IE8\n         * (Occur only when margin-top <= -height)\n         */\n        img.style.cssText = 'display:block;' + 'width:100%;' + 'height:auto;' + 'min-width:0!important;' + 'min-height:0!important;' + 'max-width:none!important;' + 'max-height:none!important;' + 'image-orientation:0deg!important;\"';\n        el.innerHTML = '';\n        el.appendChild(img);\n      });\n    },\n    resetPreview: function resetPreview() {\n      forEach(this.previews, function (element) {\n        var data = getData(element, DATA_PREVIEW);\n        setStyle(element, {\n          width: data.width,\n          height: data.height\n        });\n        element.innerHTML = data.html;\n        removeData(element, DATA_PREVIEW);\n      });\n    },\n    preview: function preview() {\n      var imageData = this.imageData,\n        canvasData = this.canvasData,\n        cropBoxData = this.cropBoxData;\n      var cropBoxWidth = cropBoxData.width,\n        cropBoxHeight = cropBoxData.height;\n      var width = imageData.width,\n        height = imageData.height;\n      var left = cropBoxData.left - canvasData.left - imageData.left;\n      var top = cropBoxData.top - canvasData.top - imageData.top;\n      if (!this.cropped || this.disabled) {\n        return;\n      }\n      setStyle(this.viewBoxImage, assign({\n        width: width,\n        height: height\n      }, getTransforms(assign({\n        translateX: -left,\n        translateY: -top\n      }, imageData))));\n      forEach(this.previews, function (element) {\n        var data = getData(element, DATA_PREVIEW);\n        var originalWidth = data.width;\n        var originalHeight = data.height;\n        var newWidth = originalWidth;\n        var newHeight = originalHeight;\n        var ratio = 1;\n        if (cropBoxWidth) {\n          ratio = originalWidth / cropBoxWidth;\n          newHeight = cropBoxHeight * ratio;\n        }\n        if (cropBoxHeight && newHeight > originalHeight) {\n          ratio = originalHeight / cropBoxHeight;\n          newWidth = cropBoxWidth * ratio;\n          newHeight = originalHeight;\n        }\n        setStyle(element, {\n          width: newWidth,\n          height: newHeight\n        });\n        setStyle(element.getElementsByTagName('img')[0], assign({\n          width: width * ratio,\n          height: height * ratio\n        }, getTransforms(assign({\n          translateX: -left * ratio,\n          translateY: -top * ratio\n        }, imageData))));\n      });\n    }\n  };\n\n  var events = {\n    bind: function bind() {\n      var element = this.element,\n        options = this.options,\n        cropper = this.cropper;\n      if (isFunction(options.cropstart)) {\n        addListener(element, EVENT_CROP_START, options.cropstart);\n      }\n      if (isFunction(options.cropmove)) {\n        addListener(element, EVENT_CROP_MOVE, options.cropmove);\n      }\n      if (isFunction(options.cropend)) {\n        addListener(element, EVENT_CROP_END, options.cropend);\n      }\n      if (isFunction(options.crop)) {\n        addListener(element, EVENT_CROP, options.crop);\n      }\n      if (isFunction(options.zoom)) {\n        addListener(element, EVENT_ZOOM, options.zoom);\n      }\n      addListener(cropper, EVENT_POINTER_DOWN, this.onCropStart = this.cropStart.bind(this));\n      if (options.zoomable && options.zoomOnWheel) {\n        addListener(cropper, EVENT_WHEEL, this.onWheel = this.wheel.bind(this), {\n          passive: false,\n          capture: true\n        });\n      }\n      if (options.toggleDragModeOnDblclick) {\n        addListener(cropper, EVENT_DBLCLICK, this.onDblclick = this.dblclick.bind(this));\n      }\n      addListener(element.ownerDocument, EVENT_POINTER_MOVE, this.onCropMove = this.cropMove.bind(this));\n      addListener(element.ownerDocument, EVENT_POINTER_UP, this.onCropEnd = this.cropEnd.bind(this));\n      if (options.responsive) {\n        addListener(window, EVENT_RESIZE, this.onResize = this.resize.bind(this));\n      }\n    },\n    unbind: function unbind() {\n      var element = this.element,\n        options = this.options,\n        cropper = this.cropper;\n      if (isFunction(options.cropstart)) {\n        removeListener(element, EVENT_CROP_START, options.cropstart);\n      }\n      if (isFunction(options.cropmove)) {\n        removeListener(element, EVENT_CROP_MOVE, options.cropmove);\n      }\n      if (isFunction(options.cropend)) {\n        removeListener(element, EVENT_CROP_END, options.cropend);\n      }\n      if (isFunction(options.crop)) {\n        removeListener(element, EVENT_CROP, options.crop);\n      }\n      if (isFunction(options.zoom)) {\n        removeListener(element, EVENT_ZOOM, options.zoom);\n      }\n      removeListener(cropper, EVENT_POINTER_DOWN, this.onCropStart);\n      if (options.zoomable && options.zoomOnWheel) {\n        removeListener(cropper, EVENT_WHEEL, this.onWheel, {\n          passive: false,\n          capture: true\n        });\n      }\n      if (options.toggleDragModeOnDblclick) {\n        removeListener(cropper, EVENT_DBLCLICK, this.onDblclick);\n      }\n      removeListener(element.ownerDocument, EVENT_POINTER_MOVE, this.onCropMove);\n      removeListener(element.ownerDocument, EVENT_POINTER_UP, this.onCropEnd);\n      if (options.responsive) {\n        removeListener(window, EVENT_RESIZE, this.onResize);\n      }\n    }\n  };\n\n  var handlers = {\n    resize: function resize() {\n      if (this.disabled) {\n        return;\n      }\n      var options = this.options,\n        container = this.container,\n        containerData = this.containerData;\n      var ratioX = container.offsetWidth / containerData.width;\n      var ratioY = container.offsetHeight / containerData.height;\n      var ratio = Math.abs(ratioX - 1) > Math.abs(ratioY - 1) ? ratioX : ratioY;\n\n      // Resize when width changed or height changed\n      if (ratio !== 1) {\n        var canvasData;\n        var cropBoxData;\n        if (options.restore) {\n          canvasData = this.getCanvasData();\n          cropBoxData = this.getCropBoxData();\n        }\n        this.render();\n        if (options.restore) {\n          this.setCanvasData(forEach(canvasData, function (n, i) {\n            canvasData[i] = n * ratio;\n          }));\n          this.setCropBoxData(forEach(cropBoxData, function (n, i) {\n            cropBoxData[i] = n * ratio;\n          }));\n        }\n      }\n    },\n    dblclick: function dblclick() {\n      if (this.disabled || this.options.dragMode === DRAG_MODE_NONE) {\n        return;\n      }\n      this.setDragMode(hasClass(this.dragBox, CLASS_CROP) ? DRAG_MODE_MOVE : DRAG_MODE_CROP);\n    },\n    wheel: function wheel(event) {\n      var _this = this;\n      var ratio = Number(this.options.wheelZoomRatio) || 0.1;\n      var delta = 1;\n      if (this.disabled) {\n        return;\n      }\n      event.preventDefault();\n\n      // Limit wheel speed to prevent zoom too fast (#21)\n      if (this.wheeling) {\n        return;\n      }\n      this.wheeling = true;\n      setTimeout(function () {\n        _this.wheeling = false;\n      }, 50);\n      if (event.deltaY) {\n        delta = event.deltaY > 0 ? 1 : -1;\n      } else if (event.wheelDelta) {\n        delta = -event.wheelDelta / 120;\n      } else if (event.detail) {\n        delta = event.detail > 0 ? 1 : -1;\n      }\n      this.zoom(-delta * ratio, event);\n    },\n    cropStart: function cropStart(event) {\n      var buttons = event.buttons,\n        button = event.button;\n      if (this.disabled\n\n      // Handle mouse event and pointer event and ignore touch event\n      || (event.type === 'mousedown' || event.type === 'pointerdown' && event.pointerType === 'mouse') && (\n      // No primary button (Usually the left button)\n      isNumber(buttons) && buttons !== 1 || isNumber(button) && button !== 0\n\n      // Open context menu\n      || event.ctrlKey)) {\n        return;\n      }\n      var options = this.options,\n        pointers = this.pointers;\n      var action;\n      if (event.changedTouches) {\n        // Handle touch event\n        forEach(event.changedTouches, function (touch) {\n          pointers[touch.identifier] = getPointer(touch);\n        });\n      } else {\n        // Handle mouse event and pointer event\n        pointers[event.pointerId || 0] = getPointer(event);\n      }\n      if (Object.keys(pointers).length > 1 && options.zoomable && options.zoomOnTouch) {\n        action = ACTION_ZOOM;\n      } else {\n        action = getData(event.target, DATA_ACTION);\n      }\n      if (!REGEXP_ACTIONS.test(action)) {\n        return;\n      }\n      if (dispatchEvent(this.element, EVENT_CROP_START, {\n        originalEvent: event,\n        action: action\n      }) === false) {\n        return;\n      }\n\n      // This line is required for preventing page zooming in iOS browsers\n      event.preventDefault();\n      this.action = action;\n      this.cropping = false;\n      if (action === ACTION_CROP) {\n        this.cropping = true;\n        addClass(this.dragBox, CLASS_MODAL);\n      }\n    },\n    cropMove: function cropMove(event) {\n      var action = this.action;\n      if (this.disabled || !action) {\n        return;\n      }\n      var pointers = this.pointers;\n      event.preventDefault();\n      if (dispatchEvent(this.element, EVENT_CROP_MOVE, {\n        originalEvent: event,\n        action: action\n      }) === false) {\n        return;\n      }\n      if (event.changedTouches) {\n        forEach(event.changedTouches, function (touch) {\n          // The first parameter should not be undefined (#432)\n          assign(pointers[touch.identifier] || {}, getPointer(touch, true));\n        });\n      } else {\n        assign(pointers[event.pointerId || 0] || {}, getPointer(event, true));\n      }\n      this.change(event);\n    },\n    cropEnd: function cropEnd(event) {\n      if (this.disabled) {\n        return;\n      }\n      var action = this.action,\n        pointers = this.pointers;\n      if (event.changedTouches) {\n        forEach(event.changedTouches, function (touch) {\n          delete pointers[touch.identifier];\n        });\n      } else {\n        delete pointers[event.pointerId || 0];\n      }\n      if (!action) {\n        return;\n      }\n      event.preventDefault();\n      if (!Object.keys(pointers).length) {\n        this.action = '';\n      }\n      if (this.cropping) {\n        this.cropping = false;\n        toggleClass(this.dragBox, CLASS_MODAL, this.cropped && this.options.modal);\n      }\n      dispatchEvent(this.element, EVENT_CROP_END, {\n        originalEvent: event,\n        action: action\n      });\n    }\n  };\n\n  var change = {\n    change: function change(event) {\n      var options = this.options,\n        canvasData = this.canvasData,\n        containerData = this.containerData,\n        cropBoxData = this.cropBoxData,\n        pointers = this.pointers;\n      var action = this.action;\n      var aspectRatio = options.aspectRatio;\n      var left = cropBoxData.left,\n        top = cropBoxData.top,\n        width = cropBoxData.width,\n        height = cropBoxData.height;\n      var right = left + width;\n      var bottom = top + height;\n      var minLeft = 0;\n      var minTop = 0;\n      var maxWidth = containerData.width;\n      var maxHeight = containerData.height;\n      var renderable = true;\n      var offset;\n\n      // Locking aspect ratio in \"free mode\" by holding shift key\n      if (!aspectRatio && event.shiftKey) {\n        aspectRatio = width && height ? width / height : 1;\n      }\n      if (this.limited) {\n        minLeft = cropBoxData.minLeft;\n        minTop = cropBoxData.minTop;\n        maxWidth = minLeft + Math.min(containerData.width, canvasData.width, canvasData.left + canvasData.width);\n        maxHeight = minTop + Math.min(containerData.height, canvasData.height, canvasData.top + canvasData.height);\n      }\n      var pointer = pointers[Object.keys(pointers)[0]];\n      var range = {\n        x: pointer.endX - pointer.startX,\n        y: pointer.endY - pointer.startY\n      };\n      var check = function check(side) {\n        switch (side) {\n          case ACTION_EAST:\n            if (right + range.x > maxWidth) {\n              range.x = maxWidth - right;\n            }\n            break;\n          case ACTION_WEST:\n            if (left + range.x < minLeft) {\n              range.x = minLeft - left;\n            }\n            break;\n          case ACTION_NORTH:\n            if (top + range.y < minTop) {\n              range.y = minTop - top;\n            }\n            break;\n          case ACTION_SOUTH:\n            if (bottom + range.y > maxHeight) {\n              range.y = maxHeight - bottom;\n            }\n            break;\n        }\n      };\n      switch (action) {\n        // Move crop box\n        case ACTION_ALL:\n          left += range.x;\n          top += range.y;\n          break;\n\n        // Resize crop box\n        case ACTION_EAST:\n          if (range.x >= 0 && (right >= maxWidth || aspectRatio && (top <= minTop || bottom >= maxHeight))) {\n            renderable = false;\n            break;\n          }\n          check(ACTION_EAST);\n          width += range.x;\n          if (width < 0) {\n            action = ACTION_WEST;\n            width = -width;\n            left -= width;\n          }\n          if (aspectRatio) {\n            height = width / aspectRatio;\n            top += (cropBoxData.height - height) / 2;\n          }\n          break;\n        case ACTION_NORTH:\n          if (range.y <= 0 && (top <= minTop || aspectRatio && (left <= minLeft || right >= maxWidth))) {\n            renderable = false;\n            break;\n          }\n          check(ACTION_NORTH);\n          height -= range.y;\n          top += range.y;\n          if (height < 0) {\n            action = ACTION_SOUTH;\n            height = -height;\n            top -= height;\n          }\n          if (aspectRatio) {\n            width = height * aspectRatio;\n            left += (cropBoxData.width - width) / 2;\n          }\n          break;\n        case ACTION_WEST:\n          if (range.x <= 0 && (left <= minLeft || aspectRatio && (top <= minTop || bottom >= maxHeight))) {\n            renderable = false;\n            break;\n          }\n          check(ACTION_WEST);\n          width -= range.x;\n          left += range.x;\n          if (width < 0) {\n            action = ACTION_EAST;\n            width = -width;\n            left -= width;\n          }\n          if (aspectRatio) {\n            height = width / aspectRatio;\n            top += (cropBoxData.height - height) / 2;\n          }\n          break;\n        case ACTION_SOUTH:\n          if (range.y >= 0 && (bottom >= maxHeight || aspectRatio && (left <= minLeft || right >= maxWidth))) {\n            renderable = false;\n            break;\n          }\n          check(ACTION_SOUTH);\n          height += range.y;\n          if (height < 0) {\n            action = ACTION_NORTH;\n            height = -height;\n            top -= height;\n          }\n          if (aspectRatio) {\n            width = height * aspectRatio;\n            left += (cropBoxData.width - width) / 2;\n          }\n          break;\n        case ACTION_NORTH_EAST:\n          if (aspectRatio) {\n            if (range.y <= 0 && (top <= minTop || right >= maxWidth)) {\n              renderable = false;\n              break;\n            }\n            check(ACTION_NORTH);\n            height -= range.y;\n            top += range.y;\n            width = height * aspectRatio;\n          } else {\n            check(ACTION_NORTH);\n            check(ACTION_EAST);\n            if (range.x >= 0) {\n              if (right < maxWidth) {\n                width += range.x;\n              } else if (range.y <= 0 && top <= minTop) {\n                renderable = false;\n              }\n            } else {\n              width += range.x;\n            }\n            if (range.y <= 0) {\n              if (top > minTop) {\n                height -= range.y;\n                top += range.y;\n              }\n            } else {\n              height -= range.y;\n              top += range.y;\n            }\n          }\n          if (width < 0 && height < 0) {\n            action = ACTION_SOUTH_WEST;\n            height = -height;\n            width = -width;\n            top -= height;\n            left -= width;\n          } else if (width < 0) {\n            action = ACTION_NORTH_WEST;\n            width = -width;\n            left -= width;\n          } else if (height < 0) {\n            action = ACTION_SOUTH_EAST;\n            height = -height;\n            top -= height;\n          }\n          break;\n        case ACTION_NORTH_WEST:\n          if (aspectRatio) {\n            if (range.y <= 0 && (top <= minTop || left <= minLeft)) {\n              renderable = false;\n              break;\n            }\n            check(ACTION_NORTH);\n            height -= range.y;\n            top += range.y;\n            width = height * aspectRatio;\n            left += cropBoxData.width - width;\n          } else {\n            check(ACTION_NORTH);\n            check(ACTION_WEST);\n            if (range.x <= 0) {\n              if (left > minLeft) {\n                width -= range.x;\n                left += range.x;\n              } else if (range.y <= 0 && top <= minTop) {\n                renderable = false;\n              }\n            } else {\n              width -= range.x;\n              left += range.x;\n            }\n            if (range.y <= 0) {\n              if (top > minTop) {\n                height -= range.y;\n                top += range.y;\n              }\n            } else {\n              height -= range.y;\n              top += range.y;\n            }\n          }\n          if (width < 0 && height < 0) {\n            action = ACTION_SOUTH_EAST;\n            height = -height;\n            width = -width;\n            top -= height;\n            left -= width;\n          } else if (width < 0) {\n            action = ACTION_NORTH_EAST;\n            width = -width;\n            left -= width;\n          } else if (height < 0) {\n            action = ACTION_SOUTH_WEST;\n            height = -height;\n            top -= height;\n          }\n          break;\n        case ACTION_SOUTH_WEST:\n          if (aspectRatio) {\n            if (range.x <= 0 && (left <= minLeft || bottom >= maxHeight)) {\n              renderable = false;\n              break;\n            }\n            check(ACTION_WEST);\n            width -= range.x;\n            left += range.x;\n            height = width / aspectRatio;\n          } else {\n            check(ACTION_SOUTH);\n            check(ACTION_WEST);\n            if (range.x <= 0) {\n              if (left > minLeft) {\n                width -= range.x;\n                left += range.x;\n              } else if (range.y >= 0 && bottom >= maxHeight) {\n                renderable = false;\n              }\n            } else {\n              width -= range.x;\n              left += range.x;\n            }\n            if (range.y >= 0) {\n              if (bottom < maxHeight) {\n                height += range.y;\n              }\n            } else {\n              height += range.y;\n            }\n          }\n          if (width < 0 && height < 0) {\n            action = ACTION_NORTH_EAST;\n            height = -height;\n            width = -width;\n            top -= height;\n            left -= width;\n          } else if (width < 0) {\n            action = ACTION_SOUTH_EAST;\n            width = -width;\n            left -= width;\n          } else if (height < 0) {\n            action = ACTION_NORTH_WEST;\n            height = -height;\n            top -= height;\n          }\n          break;\n        case ACTION_SOUTH_EAST:\n          if (aspectRatio) {\n            if (range.x >= 0 && (right >= maxWidth || bottom >= maxHeight)) {\n              renderable = false;\n              break;\n            }\n            check(ACTION_EAST);\n            width += range.x;\n            height = width / aspectRatio;\n          } else {\n            check(ACTION_SOUTH);\n            check(ACTION_EAST);\n            if (range.x >= 0) {\n              if (right < maxWidth) {\n                width += range.x;\n              } else if (range.y >= 0 && bottom >= maxHeight) {\n                renderable = false;\n              }\n            } else {\n              width += range.x;\n            }\n            if (range.y >= 0) {\n              if (bottom < maxHeight) {\n                height += range.y;\n              }\n            } else {\n              height += range.y;\n            }\n          }\n          if (width < 0 && height < 0) {\n            action = ACTION_NORTH_WEST;\n            height = -height;\n            width = -width;\n            top -= height;\n            left -= width;\n          } else if (width < 0) {\n            action = ACTION_SOUTH_WEST;\n            width = -width;\n            left -= width;\n          } else if (height < 0) {\n            action = ACTION_NORTH_EAST;\n            height = -height;\n            top -= height;\n          }\n          break;\n\n        // Move canvas\n        case ACTION_MOVE:\n          this.move(range.x, range.y);\n          renderable = false;\n          break;\n\n        // Zoom canvas\n        case ACTION_ZOOM:\n          this.zoom(getMaxZoomRatio(pointers), event);\n          renderable = false;\n          break;\n\n        // Create crop box\n        case ACTION_CROP:\n          if (!range.x || !range.y) {\n            renderable = false;\n            break;\n          }\n          offset = getOffset(this.cropper);\n          left = pointer.startX - offset.left;\n          top = pointer.startY - offset.top;\n          width = cropBoxData.minWidth;\n          height = cropBoxData.minHeight;\n          if (range.x > 0) {\n            action = range.y > 0 ? ACTION_SOUTH_EAST : ACTION_NORTH_EAST;\n          } else if (range.x < 0) {\n            left -= width;\n            action = range.y > 0 ? ACTION_SOUTH_WEST : ACTION_NORTH_WEST;\n          }\n          if (range.y < 0) {\n            top -= height;\n          }\n\n          // Show the crop box if is hidden\n          if (!this.cropped) {\n            removeClass(this.cropBox, CLASS_HIDDEN);\n            this.cropped = true;\n            if (this.limited) {\n              this.limitCropBox(true, true);\n            }\n          }\n          break;\n      }\n      if (renderable) {\n        cropBoxData.width = width;\n        cropBoxData.height = height;\n        cropBoxData.left = left;\n        cropBoxData.top = top;\n        this.action = action;\n        this.renderCropBox();\n      }\n\n      // Override\n      forEach(pointers, function (p) {\n        p.startX = p.endX;\n        p.startY = p.endY;\n      });\n    }\n  };\n\n  var methods = {\n    // Show the crop box manually\n    crop: function crop() {\n      if (this.ready && !this.cropped && !this.disabled) {\n        this.cropped = true;\n        this.limitCropBox(true, true);\n        if (this.options.modal) {\n          addClass(this.dragBox, CLASS_MODAL);\n        }\n        removeClass(this.cropBox, CLASS_HIDDEN);\n        this.setCropBoxData(this.initialCropBoxData);\n      }\n      return this;\n    },\n    // Reset the image and crop box to their initial states\n    reset: function reset() {\n      if (this.ready && !this.disabled) {\n        this.imageData = assign({}, this.initialImageData);\n        this.canvasData = assign({}, this.initialCanvasData);\n        this.cropBoxData = assign({}, this.initialCropBoxData);\n        this.renderCanvas();\n        if (this.cropped) {\n          this.renderCropBox();\n        }\n      }\n      return this;\n    },\n    // Clear the crop box\n    clear: function clear() {\n      if (this.cropped && !this.disabled) {\n        assign(this.cropBoxData, {\n          left: 0,\n          top: 0,\n          width: 0,\n          height: 0\n        });\n        this.cropped = false;\n        this.renderCropBox();\n        this.limitCanvas(true, true);\n\n        // Render canvas after crop box rendered\n        this.renderCanvas();\n        removeClass(this.dragBox, CLASS_MODAL);\n        addClass(this.cropBox, CLASS_HIDDEN);\n      }\n      return this;\n    },\n    /**\n     * Replace the image's src and rebuild the cropper\n     * @param {string} url - The new URL.\n     * @param {boolean} [hasSameSize] - Indicate if the new image has the same size as the old one.\n     * @returns {Cropper} this\n     */\n    replace: function replace(url) {\n      var hasSameSize = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      if (!this.disabled && url) {\n        if (this.isImg) {\n          this.element.src = url;\n        }\n        if (hasSameSize) {\n          this.url = url;\n          this.image.src = url;\n          if (this.ready) {\n            this.viewBoxImage.src = url;\n            forEach(this.previews, function (element) {\n              element.getElementsByTagName('img')[0].src = url;\n            });\n          }\n        } else {\n          if (this.isImg) {\n            this.replaced = true;\n          }\n          this.options.data = null;\n          this.uncreate();\n          this.load(url);\n        }\n      }\n      return this;\n    },\n    // Enable (unfreeze) the cropper\n    enable: function enable() {\n      if (this.ready && this.disabled) {\n        this.disabled = false;\n        removeClass(this.cropper, CLASS_DISABLED);\n      }\n      return this;\n    },\n    // Disable (freeze) the cropper\n    disable: function disable() {\n      if (this.ready && !this.disabled) {\n        this.disabled = true;\n        addClass(this.cropper, CLASS_DISABLED);\n      }\n      return this;\n    },\n    /**\n     * Destroy the cropper and remove the instance from the image\n     * @returns {Cropper} this\n     */\n    destroy: function destroy() {\n      var element = this.element;\n      if (!element[NAMESPACE]) {\n        return this;\n      }\n      element[NAMESPACE] = undefined;\n      if (this.isImg && this.replaced) {\n        element.src = this.originalUrl;\n      }\n      this.uncreate();\n      return this;\n    },\n    /**\n     * Move the canvas with relative offsets\n     * @param {number} offsetX - The relative offset distance on the x-axis.\n     * @param {number} [offsetY=offsetX] - The relative offset distance on the y-axis.\n     * @returns {Cropper} this\n     */\n    move: function move(offsetX) {\n      var offsetY = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : offsetX;\n      var _this$canvasData = this.canvasData,\n        left = _this$canvasData.left,\n        top = _this$canvasData.top;\n      return this.moveTo(isUndefined(offsetX) ? offsetX : left + Number(offsetX), isUndefined(offsetY) ? offsetY : top + Number(offsetY));\n    },\n    /**\n     * Move the canvas to an absolute point\n     * @param {number} x - The x-axis coordinate.\n     * @param {number} [y=x] - The y-axis coordinate.\n     * @returns {Cropper} this\n     */\n    moveTo: function moveTo(x) {\n      var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : x;\n      var canvasData = this.canvasData;\n      var changed = false;\n      x = Number(x);\n      y = Number(y);\n      if (this.ready && !this.disabled && this.options.movable) {\n        if (isNumber(x)) {\n          canvasData.left = x;\n          changed = true;\n        }\n        if (isNumber(y)) {\n          canvasData.top = y;\n          changed = true;\n        }\n        if (changed) {\n          this.renderCanvas(true);\n        }\n      }\n      return this;\n    },\n    /**\n     * Zoom the canvas with a relative ratio\n     * @param {number} ratio - The target ratio.\n     * @param {Event} _originalEvent - The original event if any.\n     * @returns {Cropper} this\n     */\n    zoom: function zoom(ratio, _originalEvent) {\n      var canvasData = this.canvasData;\n      ratio = Number(ratio);\n      if (ratio < 0) {\n        ratio = 1 / (1 - ratio);\n      } else {\n        ratio = 1 + ratio;\n      }\n      return this.zoomTo(canvasData.width * ratio / canvasData.naturalWidth, null, _originalEvent);\n    },\n    /**\n     * Zoom the canvas to an absolute ratio\n     * @param {number} ratio - The target ratio.\n     * @param {Object} pivot - The zoom pivot point coordinate.\n     * @param {Event} _originalEvent - The original event if any.\n     * @returns {Cropper} this\n     */\n    zoomTo: function zoomTo(ratio, pivot, _originalEvent) {\n      var options = this.options,\n        canvasData = this.canvasData;\n      var width = canvasData.width,\n        height = canvasData.height,\n        naturalWidth = canvasData.naturalWidth,\n        naturalHeight = canvasData.naturalHeight;\n      ratio = Number(ratio);\n      if (ratio >= 0 && this.ready && !this.disabled && options.zoomable) {\n        var newWidth = naturalWidth * ratio;\n        var newHeight = naturalHeight * ratio;\n        if (dispatchEvent(this.element, EVENT_ZOOM, {\n          ratio: ratio,\n          oldRatio: width / naturalWidth,\n          originalEvent: _originalEvent\n        }) === false) {\n          return this;\n        }\n        if (_originalEvent) {\n          var pointers = this.pointers;\n          var offset = getOffset(this.cropper);\n          var center = pointers && Object.keys(pointers).length ? getPointersCenter(pointers) : {\n            pageX: _originalEvent.pageX,\n            pageY: _originalEvent.pageY\n          };\n\n          // Zoom from the triggering point of the event\n          canvasData.left -= (newWidth - width) * ((center.pageX - offset.left - canvasData.left) / width);\n          canvasData.top -= (newHeight - height) * ((center.pageY - offset.top - canvasData.top) / height);\n        } else if (isPlainObject(pivot) && isNumber(pivot.x) && isNumber(pivot.y)) {\n          canvasData.left -= (newWidth - width) * ((pivot.x - canvasData.left) / width);\n          canvasData.top -= (newHeight - height) * ((pivot.y - canvasData.top) / height);\n        } else {\n          // Zoom from the center of the canvas\n          canvasData.left -= (newWidth - width) / 2;\n          canvasData.top -= (newHeight - height) / 2;\n        }\n        canvasData.width = newWidth;\n        canvasData.height = newHeight;\n        this.renderCanvas(true);\n      }\n      return this;\n    },\n    /**\n     * Rotate the canvas with a relative degree\n     * @param {number} degree - The rotate degree.\n     * @returns {Cropper} this\n     */\n    rotate: function rotate(degree) {\n      return this.rotateTo((this.imageData.rotate || 0) + Number(degree));\n    },\n    /**\n     * Rotate the canvas to an absolute degree\n     * @param {number} degree - The rotate degree.\n     * @returns {Cropper} this\n     */\n    rotateTo: function rotateTo(degree) {\n      degree = Number(degree);\n      if (isNumber(degree) && this.ready && !this.disabled && this.options.rotatable) {\n        this.imageData.rotate = degree % 360;\n        this.renderCanvas(true, true);\n      }\n      return this;\n    },\n    /**\n     * Scale the image on the x-axis.\n     * @param {number} scaleX - The scale ratio on the x-axis.\n     * @returns {Cropper} this\n     */\n    scaleX: function scaleX(_scaleX) {\n      var scaleY = this.imageData.scaleY;\n      return this.scale(_scaleX, isNumber(scaleY) ? scaleY : 1);\n    },\n    /**\n     * Scale the image on the y-axis.\n     * @param {number} scaleY - The scale ratio on the y-axis.\n     * @returns {Cropper} this\n     */\n    scaleY: function scaleY(_scaleY) {\n      var scaleX = this.imageData.scaleX;\n      return this.scale(isNumber(scaleX) ? scaleX : 1, _scaleY);\n    },\n    /**\n     * Scale the image\n     * @param {number} scaleX - The scale ratio on the x-axis.\n     * @param {number} [scaleY=scaleX] - The scale ratio on the y-axis.\n     * @returns {Cropper} this\n     */\n    scale: function scale(scaleX) {\n      var scaleY = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : scaleX;\n      var imageData = this.imageData;\n      var transformed = false;\n      scaleX = Number(scaleX);\n      scaleY = Number(scaleY);\n      if (this.ready && !this.disabled && this.options.scalable) {\n        if (isNumber(scaleX)) {\n          imageData.scaleX = scaleX;\n          transformed = true;\n        }\n        if (isNumber(scaleY)) {\n          imageData.scaleY = scaleY;\n          transformed = true;\n        }\n        if (transformed) {\n          this.renderCanvas(true, true);\n        }\n      }\n      return this;\n    },\n    /**\n     * Get the cropped area position and size data (base on the original image)\n     * @param {boolean} [rounded=false] - Indicate if round the data values or not.\n     * @returns {Object} The result cropped data.\n     */\n    getData: function getData() {\n      var rounded = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var options = this.options,\n        imageData = this.imageData,\n        canvasData = this.canvasData,\n        cropBoxData = this.cropBoxData;\n      var data;\n      if (this.ready && this.cropped) {\n        data = {\n          x: cropBoxData.left - canvasData.left,\n          y: cropBoxData.top - canvasData.top,\n          width: cropBoxData.width,\n          height: cropBoxData.height\n        };\n        var ratio = imageData.width / imageData.naturalWidth;\n        forEach(data, function (n, i) {\n          data[i] = n / ratio;\n        });\n        if (rounded) {\n          // In case rounding off leads to extra 1px in right or bottom border\n          // we should round the top-left corner and the dimension (#343).\n          var bottom = Math.round(data.y + data.height);\n          var right = Math.round(data.x + data.width);\n          data.x = Math.round(data.x);\n          data.y = Math.round(data.y);\n          data.width = right - data.x;\n          data.height = bottom - data.y;\n        }\n      } else {\n        data = {\n          x: 0,\n          y: 0,\n          width: 0,\n          height: 0\n        };\n      }\n      if (options.rotatable) {\n        data.rotate = imageData.rotate || 0;\n      }\n      if (options.scalable) {\n        data.scaleX = imageData.scaleX || 1;\n        data.scaleY = imageData.scaleY || 1;\n      }\n      return data;\n    },\n    /**\n     * Set the cropped area position and size with new data\n     * @param {Object} data - The new data.\n     * @returns {Cropper} this\n     */\n    setData: function setData(data) {\n      var options = this.options,\n        imageData = this.imageData,\n        canvasData = this.canvasData;\n      var cropBoxData = {};\n      if (this.ready && !this.disabled && isPlainObject(data)) {\n        var transformed = false;\n        if (options.rotatable) {\n          if (isNumber(data.rotate) && data.rotate !== imageData.rotate) {\n            imageData.rotate = data.rotate;\n            transformed = true;\n          }\n        }\n        if (options.scalable) {\n          if (isNumber(data.scaleX) && data.scaleX !== imageData.scaleX) {\n            imageData.scaleX = data.scaleX;\n            transformed = true;\n          }\n          if (isNumber(data.scaleY) && data.scaleY !== imageData.scaleY) {\n            imageData.scaleY = data.scaleY;\n            transformed = true;\n          }\n        }\n        if (transformed) {\n          this.renderCanvas(true, true);\n        }\n        var ratio = imageData.width / imageData.naturalWidth;\n        if (isNumber(data.x)) {\n          cropBoxData.left = data.x * ratio + canvasData.left;\n        }\n        if (isNumber(data.y)) {\n          cropBoxData.top = data.y * ratio + canvasData.top;\n        }\n        if (isNumber(data.width)) {\n          cropBoxData.width = data.width * ratio;\n        }\n        if (isNumber(data.height)) {\n          cropBoxData.height = data.height * ratio;\n        }\n        this.setCropBoxData(cropBoxData);\n      }\n      return this;\n    },\n    /**\n     * Get the container size data.\n     * @returns {Object} The result container data.\n     */\n    getContainerData: function getContainerData() {\n      return this.ready ? assign({}, this.containerData) : {};\n    },\n    /**\n     * Get the image position and size data.\n     * @returns {Object} The result image data.\n     */\n    getImageData: function getImageData() {\n      return this.sized ? assign({}, this.imageData) : {};\n    },\n    /**\n     * Get the canvas position and size data.\n     * @returns {Object} The result canvas data.\n     */\n    getCanvasData: function getCanvasData() {\n      var canvasData = this.canvasData;\n      var data = {};\n      if (this.ready) {\n        forEach(['left', 'top', 'width', 'height', 'naturalWidth', 'naturalHeight'], function (n) {\n          data[n] = canvasData[n];\n        });\n      }\n      return data;\n    },\n    /**\n     * Set the canvas position and size with new data.\n     * @param {Object} data - The new canvas data.\n     * @returns {Cropper} this\n     */\n    setCanvasData: function setCanvasData(data) {\n      var canvasData = this.canvasData;\n      var aspectRatio = canvasData.aspectRatio;\n      if (this.ready && !this.disabled && isPlainObject(data)) {\n        if (isNumber(data.left)) {\n          canvasData.left = data.left;\n        }\n        if (isNumber(data.top)) {\n          canvasData.top = data.top;\n        }\n        if (isNumber(data.width)) {\n          canvasData.width = data.width;\n          canvasData.height = data.width / aspectRatio;\n        } else if (isNumber(data.height)) {\n          canvasData.height = data.height;\n          canvasData.width = data.height * aspectRatio;\n        }\n        this.renderCanvas(true);\n      }\n      return this;\n    },\n    /**\n     * Get the crop box position and size data.\n     * @returns {Object} The result crop box data.\n     */\n    getCropBoxData: function getCropBoxData() {\n      var cropBoxData = this.cropBoxData;\n      var data;\n      if (this.ready && this.cropped) {\n        data = {\n          left: cropBoxData.left,\n          top: cropBoxData.top,\n          width: cropBoxData.width,\n          height: cropBoxData.height\n        };\n      }\n      return data || {};\n    },\n    /**\n     * Set the crop box position and size with new data.\n     * @param {Object} data - The new crop box data.\n     * @returns {Cropper} this\n     */\n    setCropBoxData: function setCropBoxData(data) {\n      var cropBoxData = this.cropBoxData;\n      var aspectRatio = this.options.aspectRatio;\n      var widthChanged;\n      var heightChanged;\n      if (this.ready && this.cropped && !this.disabled && isPlainObject(data)) {\n        if (isNumber(data.left)) {\n          cropBoxData.left = data.left;\n        }\n        if (isNumber(data.top)) {\n          cropBoxData.top = data.top;\n        }\n        if (isNumber(data.width) && data.width !== cropBoxData.width) {\n          widthChanged = true;\n          cropBoxData.width = data.width;\n        }\n        if (isNumber(data.height) && data.height !== cropBoxData.height) {\n          heightChanged = true;\n          cropBoxData.height = data.height;\n        }\n        if (aspectRatio) {\n          if (widthChanged) {\n            cropBoxData.height = cropBoxData.width / aspectRatio;\n          } else if (heightChanged) {\n            cropBoxData.width = cropBoxData.height * aspectRatio;\n          }\n        }\n        this.renderCropBox();\n      }\n      return this;\n    },\n    /**\n     * Get a canvas drawn the cropped image.\n     * @param {Object} [options={}] - The config options.\n     * @returns {HTMLCanvasElement} - The result canvas.\n     */\n    getCroppedCanvas: function getCroppedCanvas() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      if (!this.ready || !window.HTMLCanvasElement) {\n        return null;\n      }\n      var canvasData = this.canvasData;\n      var source = getSourceCanvas(this.image, this.imageData, canvasData, options);\n\n      // Returns the source canvas if it is not cropped.\n      if (!this.cropped) {\n        return source;\n      }\n      var _this$getData = this.getData(),\n        initialX = _this$getData.x,\n        initialY = _this$getData.y,\n        initialWidth = _this$getData.width,\n        initialHeight = _this$getData.height;\n      var ratio = source.width / Math.floor(canvasData.naturalWidth);\n      if (ratio !== 1) {\n        initialX *= ratio;\n        initialY *= ratio;\n        initialWidth *= ratio;\n        initialHeight *= ratio;\n      }\n      var aspectRatio = initialWidth / initialHeight;\n      var maxSizes = getAdjustedSizes({\n        aspectRatio: aspectRatio,\n        width: options.maxWidth || Infinity,\n        height: options.maxHeight || Infinity\n      });\n      var minSizes = getAdjustedSizes({\n        aspectRatio: aspectRatio,\n        width: options.minWidth || 0,\n        height: options.minHeight || 0\n      }, 'cover');\n      var _getAdjustedSizes = getAdjustedSizes({\n          aspectRatio: aspectRatio,\n          width: options.width || (ratio !== 1 ? source.width : initialWidth),\n          height: options.height || (ratio !== 1 ? source.height : initialHeight)\n        }),\n        width = _getAdjustedSizes.width,\n        height = _getAdjustedSizes.height;\n      width = Math.min(maxSizes.width, Math.max(minSizes.width, width));\n      height = Math.min(maxSizes.height, Math.max(minSizes.height, height));\n      var canvas = document.createElement('canvas');\n      var context = canvas.getContext('2d');\n      canvas.width = normalizeDecimalNumber(width);\n      canvas.height = normalizeDecimalNumber(height);\n      context.fillStyle = options.fillColor || 'transparent';\n      context.fillRect(0, 0, width, height);\n      var _options$imageSmoothi = options.imageSmoothingEnabled,\n        imageSmoothingEnabled = _options$imageSmoothi === void 0 ? true : _options$imageSmoothi,\n        imageSmoothingQuality = options.imageSmoothingQuality;\n      context.imageSmoothingEnabled = imageSmoothingEnabled;\n      if (imageSmoothingQuality) {\n        context.imageSmoothingQuality = imageSmoothingQuality;\n      }\n\n      // https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D.drawImage\n      var sourceWidth = source.width;\n      var sourceHeight = source.height;\n\n      // Source canvas parameters\n      var srcX = initialX;\n      var srcY = initialY;\n      var srcWidth;\n      var srcHeight;\n\n      // Destination canvas parameters\n      var dstX;\n      var dstY;\n      var dstWidth;\n      var dstHeight;\n      if (srcX <= -initialWidth || srcX > sourceWidth) {\n        srcX = 0;\n        srcWidth = 0;\n        dstX = 0;\n        dstWidth = 0;\n      } else if (srcX <= 0) {\n        dstX = -srcX;\n        srcX = 0;\n        srcWidth = Math.min(sourceWidth, initialWidth + srcX);\n        dstWidth = srcWidth;\n      } else if (srcX <= sourceWidth) {\n        dstX = 0;\n        srcWidth = Math.min(initialWidth, sourceWidth - srcX);\n        dstWidth = srcWidth;\n      }\n      if (srcWidth <= 0 || srcY <= -initialHeight || srcY > sourceHeight) {\n        srcY = 0;\n        srcHeight = 0;\n        dstY = 0;\n        dstHeight = 0;\n      } else if (srcY <= 0) {\n        dstY = -srcY;\n        srcY = 0;\n        srcHeight = Math.min(sourceHeight, initialHeight + srcY);\n        dstHeight = srcHeight;\n      } else if (srcY <= sourceHeight) {\n        dstY = 0;\n        srcHeight = Math.min(initialHeight, sourceHeight - srcY);\n        dstHeight = srcHeight;\n      }\n      var params = [srcX, srcY, srcWidth, srcHeight];\n\n      // Avoid \"IndexSizeError\"\n      if (dstWidth > 0 && dstHeight > 0) {\n        var scale = width / initialWidth;\n        params.push(dstX * scale, dstY * scale, dstWidth * scale, dstHeight * scale);\n      }\n\n      // All the numerical parameters should be integer for `drawImage`\n      // https://github.com/fengyuanchen/cropper/issues/476\n      context.drawImage.apply(context, [source].concat(_toConsumableArray(params.map(function (param) {\n        return Math.floor(normalizeDecimalNumber(param));\n      }))));\n      return canvas;\n    },\n    /**\n     * Change the aspect ratio of the crop box.\n     * @param {number} aspectRatio - The new aspect ratio.\n     * @returns {Cropper} this\n     */\n    setAspectRatio: function setAspectRatio(aspectRatio) {\n      var options = this.options;\n      if (!this.disabled && !isUndefined(aspectRatio)) {\n        // 0 -> NaN\n        options.aspectRatio = Math.max(0, aspectRatio) || NaN;\n        if (this.ready) {\n          this.initCropBox();\n          if (this.cropped) {\n            this.renderCropBox();\n          }\n        }\n      }\n      return this;\n    },\n    /**\n     * Change the drag mode.\n     * @param {string} mode - The new drag mode.\n     * @returns {Cropper} this\n     */\n    setDragMode: function setDragMode(mode) {\n      var options = this.options,\n        dragBox = this.dragBox,\n        face = this.face;\n      if (this.ready && !this.disabled) {\n        var croppable = mode === DRAG_MODE_CROP;\n        var movable = options.movable && mode === DRAG_MODE_MOVE;\n        mode = croppable || movable ? mode : DRAG_MODE_NONE;\n        options.dragMode = mode;\n        setData(dragBox, DATA_ACTION, mode);\n        toggleClass(dragBox, CLASS_CROP, croppable);\n        toggleClass(dragBox, CLASS_MOVE, movable);\n        if (!options.cropBoxMovable) {\n          // Sync drag mode to crop box when it is not movable\n          setData(face, DATA_ACTION, mode);\n          toggleClass(face, CLASS_CROP, croppable);\n          toggleClass(face, CLASS_MOVE, movable);\n        }\n      }\n      return this;\n    }\n  };\n\n  var AnotherCropper = WINDOW.Cropper;\n  var Cropper = /*#__PURE__*/function () {\n    /**\n     * Create a new Cropper.\n     * @param {Element} element - The target element for cropping.\n     * @param {Object} [options={}] - The configuration options.\n     */\n    function Cropper(element) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      _classCallCheck(this, Cropper);\n      if (!element || !REGEXP_TAG_NAME.test(element.tagName)) {\n        throw new Error('The first argument is required and must be an <img> or <canvas> element.');\n      }\n      this.element = element;\n      this.options = assign({}, DEFAULTS, isPlainObject(options) && options);\n      this.cropped = false;\n      this.disabled = false;\n      this.pointers = {};\n      this.ready = false;\n      this.reloading = false;\n      this.replaced = false;\n      this.sized = false;\n      this.sizing = false;\n      this.init();\n    }\n    _createClass(Cropper, [{\n      key: \"init\",\n      value: function init() {\n        var element = this.element;\n        var tagName = element.tagName.toLowerCase();\n        var url;\n        if (element[NAMESPACE]) {\n          return;\n        }\n        element[NAMESPACE] = this;\n        if (tagName === 'img') {\n          this.isImg = true;\n\n          // e.g.: \"img/picture.jpg\"\n          url = element.getAttribute('src') || '';\n          this.originalUrl = url;\n\n          // Stop when it's a blank image\n          if (!url) {\n            return;\n          }\n\n          // e.g.: \"https://example.com/img/picture.jpg\"\n          url = element.src;\n        } else if (tagName === 'canvas' && window.HTMLCanvasElement) {\n          url = element.toDataURL();\n        }\n        this.load(url);\n      }\n    }, {\n      key: \"load\",\n      value: function load(url) {\n        var _this = this;\n        if (!url) {\n          return;\n        }\n        this.url = url;\n        this.imageData = {};\n        var element = this.element,\n          options = this.options;\n        if (!options.rotatable && !options.scalable) {\n          options.checkOrientation = false;\n        }\n\n        // Only IE10+ supports Typed Arrays\n        if (!options.checkOrientation || !window.ArrayBuffer) {\n          this.clone();\n          return;\n        }\n\n        // Detect the mime type of the image directly if it is a Data URL\n        if (REGEXP_DATA_URL.test(url)) {\n          // Read ArrayBuffer from Data URL of JPEG images directly for better performance\n          if (REGEXP_DATA_URL_JPEG.test(url)) {\n            this.read(dataURLToArrayBuffer(url));\n          } else {\n            // Only a JPEG image may contains Exif Orientation information,\n            // the rest types of Data URLs are not necessary to check orientation at all.\n            this.clone();\n          }\n          return;\n        }\n\n        // 1. Detect the mime type of the image by a XMLHttpRequest.\n        // 2. Load the image as ArrayBuffer for reading orientation if its a JPEG image.\n        var xhr = new XMLHttpRequest();\n        var clone = this.clone.bind(this);\n        this.reloading = true;\n        this.xhr = xhr;\n\n        // 1. Cross origin requests are only supported for protocol schemes:\n        // http, https, data, chrome, chrome-extension.\n        // 2. Access to XMLHttpRequest from a Data URL will be blocked by CORS policy\n        // in some browsers as IE11 and Safari.\n        xhr.onabort = clone;\n        xhr.onerror = clone;\n        xhr.ontimeout = clone;\n        xhr.onprogress = function () {\n          // Abort the request directly if it not a JPEG image for better performance\n          if (xhr.getResponseHeader('content-type') !== MIME_TYPE_JPEG) {\n            xhr.abort();\n          }\n        };\n        xhr.onload = function () {\n          _this.read(xhr.response);\n        };\n        xhr.onloadend = function () {\n          _this.reloading = false;\n          _this.xhr = null;\n        };\n\n        // Bust cache when there is a \"crossOrigin\" property to avoid browser cache error\n        if (options.checkCrossOrigin && isCrossOriginURL(url) && element.crossOrigin) {\n          url = addTimestamp(url);\n        }\n\n        // The third parameter is required for avoiding side-effect (#682)\n        xhr.open('GET', url, true);\n        xhr.responseType = 'arraybuffer';\n        xhr.withCredentials = element.crossOrigin === 'use-credentials';\n        xhr.send();\n      }\n    }, {\n      key: \"read\",\n      value: function read(arrayBuffer) {\n        var options = this.options,\n          imageData = this.imageData;\n\n        // Reset the orientation value to its default value 1\n        // as some iOS browsers will render image with its orientation\n        var orientation = resetAndGetOrientation(arrayBuffer);\n        var rotate = 0;\n        var scaleX = 1;\n        var scaleY = 1;\n        if (orientation > 1) {\n          // Generate a new URL which has the default orientation value\n          this.url = arrayBufferToDataURL(arrayBuffer, MIME_TYPE_JPEG);\n          var _parseOrientation = parseOrientation(orientation);\n          rotate = _parseOrientation.rotate;\n          scaleX = _parseOrientation.scaleX;\n          scaleY = _parseOrientation.scaleY;\n        }\n        if (options.rotatable) {\n          imageData.rotate = rotate;\n        }\n        if (options.scalable) {\n          imageData.scaleX = scaleX;\n          imageData.scaleY = scaleY;\n        }\n        this.clone();\n      }\n    }, {\n      key: \"clone\",\n      value: function clone() {\n        var element = this.element,\n          url = this.url;\n        var crossOrigin = element.crossOrigin;\n        var crossOriginUrl = url;\n        if (this.options.checkCrossOrigin && isCrossOriginURL(url)) {\n          if (!crossOrigin) {\n            crossOrigin = 'anonymous';\n          }\n\n          // Bust cache when there is not a \"crossOrigin\" property (#519)\n          crossOriginUrl = addTimestamp(url);\n        }\n        this.crossOrigin = crossOrigin;\n        this.crossOriginUrl = crossOriginUrl;\n        var image = document.createElement('img');\n        if (crossOrigin) {\n          image.crossOrigin = crossOrigin;\n        }\n        image.src = crossOriginUrl || url;\n        image.alt = element.alt || 'The image to crop';\n        this.image = image;\n        image.onload = this.start.bind(this);\n        image.onerror = this.stop.bind(this);\n        addClass(image, CLASS_HIDE);\n        element.parentNode.insertBefore(image, element.nextSibling);\n      }\n    }, {\n      key: \"start\",\n      value: function start() {\n        var _this2 = this;\n        var image = this.image;\n        image.onload = null;\n        image.onerror = null;\n        this.sizing = true;\n\n        // Match all browsers that use WebKit as the layout engine in iOS devices,\n        // such as Safari for iOS, Chrome for iOS, and in-app browsers.\n        var isIOSWebKit = WINDOW.navigator && /(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(WINDOW.navigator.userAgent);\n        var done = function done(naturalWidth, naturalHeight) {\n          assign(_this2.imageData, {\n            naturalWidth: naturalWidth,\n            naturalHeight: naturalHeight,\n            aspectRatio: naturalWidth / naturalHeight\n          });\n          _this2.initialImageData = assign({}, _this2.imageData);\n          _this2.sizing = false;\n          _this2.sized = true;\n          _this2.build();\n        };\n\n        // Most modern browsers (excepts iOS WebKit)\n        if (image.naturalWidth && !isIOSWebKit) {\n          done(image.naturalWidth, image.naturalHeight);\n          return;\n        }\n        var sizingImage = document.createElement('img');\n        var body = document.body || document.documentElement;\n        this.sizingImage = sizingImage;\n        sizingImage.onload = function () {\n          done(sizingImage.width, sizingImage.height);\n          if (!isIOSWebKit) {\n            body.removeChild(sizingImage);\n          }\n        };\n        sizingImage.src = image.src;\n\n        // iOS WebKit will convert the image automatically\n        // with its orientation once append it into DOM (#279)\n        if (!isIOSWebKit) {\n          sizingImage.style.cssText = 'left:0;' + 'max-height:none!important;' + 'max-width:none!important;' + 'min-height:0!important;' + 'min-width:0!important;' + 'opacity:0;' + 'position:absolute;' + 'top:0;' + 'z-index:-1;';\n          body.appendChild(sizingImage);\n        }\n      }\n    }, {\n      key: \"stop\",\n      value: function stop() {\n        var image = this.image;\n        image.onload = null;\n        image.onerror = null;\n        image.parentNode.removeChild(image);\n        this.image = null;\n      }\n    }, {\n      key: \"build\",\n      value: function build() {\n        if (!this.sized || this.ready) {\n          return;\n        }\n        var element = this.element,\n          options = this.options,\n          image = this.image;\n\n        // Create cropper elements\n        var container = element.parentNode;\n        var template = document.createElement('div');\n        template.innerHTML = TEMPLATE;\n        var cropper = template.querySelector(\".\".concat(NAMESPACE, \"-container\"));\n        var canvas = cropper.querySelector(\".\".concat(NAMESPACE, \"-canvas\"));\n        var dragBox = cropper.querySelector(\".\".concat(NAMESPACE, \"-drag-box\"));\n        var cropBox = cropper.querySelector(\".\".concat(NAMESPACE, \"-crop-box\"));\n        var face = cropBox.querySelector(\".\".concat(NAMESPACE, \"-face\"));\n        this.container = container;\n        this.cropper = cropper;\n        this.canvas = canvas;\n        this.dragBox = dragBox;\n        this.cropBox = cropBox;\n        this.viewBox = cropper.querySelector(\".\".concat(NAMESPACE, \"-view-box\"));\n        this.face = face;\n        canvas.appendChild(image);\n\n        // Hide the original image\n        addClass(element, CLASS_HIDDEN);\n\n        // Inserts the cropper after to the current image\n        container.insertBefore(cropper, element.nextSibling);\n\n        // Show the hidden image\n        removeClass(image, CLASS_HIDE);\n        this.initPreview();\n        this.bind();\n        options.initialAspectRatio = Math.max(0, options.initialAspectRatio) || NaN;\n        options.aspectRatio = Math.max(0, options.aspectRatio) || NaN;\n        options.viewMode = Math.max(0, Math.min(3, Math.round(options.viewMode))) || 0;\n        addClass(cropBox, CLASS_HIDDEN);\n        if (!options.guides) {\n          addClass(cropBox.getElementsByClassName(\"\".concat(NAMESPACE, \"-dashed\")), CLASS_HIDDEN);\n        }\n        if (!options.center) {\n          addClass(cropBox.getElementsByClassName(\"\".concat(NAMESPACE, \"-center\")), CLASS_HIDDEN);\n        }\n        if (options.background) {\n          addClass(cropper, \"\".concat(NAMESPACE, \"-bg\"));\n        }\n        if (!options.highlight) {\n          addClass(face, CLASS_INVISIBLE);\n        }\n        if (options.cropBoxMovable) {\n          addClass(face, CLASS_MOVE);\n          setData(face, DATA_ACTION, ACTION_ALL);\n        }\n        if (!options.cropBoxResizable) {\n          addClass(cropBox.getElementsByClassName(\"\".concat(NAMESPACE, \"-line\")), CLASS_HIDDEN);\n          addClass(cropBox.getElementsByClassName(\"\".concat(NAMESPACE, \"-point\")), CLASS_HIDDEN);\n        }\n        this.render();\n        this.ready = true;\n        this.setDragMode(options.dragMode);\n        if (options.autoCrop) {\n          this.crop();\n        }\n        this.setData(options.data);\n        if (isFunction(options.ready)) {\n          addListener(element, EVENT_READY, options.ready, {\n            once: true\n          });\n        }\n        dispatchEvent(element, EVENT_READY);\n      }\n    }, {\n      key: \"unbuild\",\n      value: function unbuild() {\n        if (!this.ready) {\n          return;\n        }\n        this.ready = false;\n        this.unbind();\n        this.resetPreview();\n        var parentNode = this.cropper.parentNode;\n        if (parentNode) {\n          parentNode.removeChild(this.cropper);\n        }\n        removeClass(this.element, CLASS_HIDDEN);\n      }\n    }, {\n      key: \"uncreate\",\n      value: function uncreate() {\n        if (this.ready) {\n          this.unbuild();\n          this.ready = false;\n          this.cropped = false;\n        } else if (this.sizing) {\n          this.sizingImage.onload = null;\n          this.sizing = false;\n          this.sized = false;\n        } else if (this.reloading) {\n          this.xhr.onabort = null;\n          this.xhr.abort();\n        } else if (this.image) {\n          this.stop();\n        }\n      }\n\n      /**\n       * Get the no conflict cropper class.\n       * @returns {Cropper} The cropper class.\n       */\n    }], [{\n      key: \"noConflict\",\n      value: function noConflict() {\n        window.Cropper = AnotherCropper;\n        return Cropper;\n      }\n\n      /**\n       * Change the default options.\n       * @param {Object} options - The new default options.\n       */\n    }, {\n      key: \"setDefaults\",\n      value: function setDefaults(options) {\n        assign(DEFAULTS, isPlainObject(options) && options);\n      }\n    }]);\n    return Cropper;\n  }();\n  assign(Cropper.prototype, render, preview, events, handlers, change, methods);\n\n  return Cropper;\n\n}));\n","\n'use strict';\n\nvar utils = require('./lib/utils');\nvar pica  = require('pica');\n\nfunction ImageBlobReduce(options) {\n  if (!(this instanceof ImageBlobReduce)) return new ImageBlobReduce(options);\n\n  options = options || {};\n\n  this.pica = options.pica || pica({});\n  this.initialized = false;\n\n  this.utils = utils;\n}\n\n\nImageBlobReduce.prototype.use = function (plugin /*, params, ... */) {\n  var args = [ this ].concat(Array.prototype.slice.call(arguments, 1));\n  plugin.apply(plugin, args);\n  return this;\n};\n\n\nImageBlobReduce.prototype.init = function () {\n  this.use(require('./lib/jpeg_plugins').assign);\n};\n\n\nImageBlobReduce.prototype.toBlob = function (blob, options) {\n  var opts = utils.assign({ max: Infinity }, options);\n  var env = {\n    blob: blob,\n    opts: opts\n  };\n\n  if (!this.initialized) {\n    this.init();\n    this.initialized = true;\n  }\n\n  return Promise.resolve(env)\n    .then(this._blob_to_image)\n    .then(this._calculate_size)\n    .then(this._transform)\n    .then(this._cleanup)\n    .then(this._create_blob)\n    .then(function (_env) {\n      // Safari 12 workaround\n      // https://github.com/nodeca/pica/issues/199\n      _env.out_canvas.width = _env.out_canvas.height = 0;\n\n      return _env.out_blob;\n    });\n};\n\n\nImageBlobReduce.prototype.toCanvas = function (blob, options) {\n  var opts = utils.assign({ max: Infinity }, options);\n  var env = {\n    blob: blob,\n    opts: opts\n  };\n\n  if (!this.initialized) {\n    this.init();\n    this.initialized = true;\n  }\n\n  return Promise.resolve(env)\n    .then(this._blob_to_image)\n    .then(this._calculate_size)\n    .then(this._transform)\n    .then(this._cleanup)\n    .then(function (_env) { return _env.out_canvas; });\n};\n\n\nImageBlobReduce.prototype.before = function (method_name, fn) {\n  if (!this[method_name]) throw new Error('Method \"' + method_name + '\" does not exist');\n  if (typeof fn !== 'function') throw new Error('Invalid argument \"fn\", function expected');\n\n  var old_fn = this[method_name];\n  var self = this;\n\n  this[method_name] = function (env) {\n    return fn.call(self, env).then(function (_env) {\n      return old_fn.call(self, _env);\n    });\n  };\n\n  return this;\n};\n\n\nImageBlobReduce.prototype.after = function (method_name, fn) {\n  if (!this[method_name]) throw new Error('Method \"' + method_name + '\" does not exist');\n  if (typeof fn !== 'function') throw new Error('Invalid argument \"fn\", function expected');\n\n  var old_fn = this[method_name];\n  var self = this;\n\n  this[method_name] = function (env) {\n    return old_fn.call(self, env).then(function (_env) {\n      return fn.call(self, _env);\n    });\n  };\n\n  return this;\n};\n\n\nImageBlobReduce.prototype._blob_to_image = function (env) {\n  var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n  env.image = document.createElement('img');\n  env.image_url = URL.createObjectURL(env.blob);\n  env.image.src = env.image_url;\n\n  return new Promise(function (resolve, reject) {\n    env.image.onerror = function () { reject(new Error('ImageBlobReduce: failed to create Image() from blob')); };\n    env.image.onload = function () { resolve(env); };\n  });\n};\n\n\nImageBlobReduce.prototype._calculate_size = function (env) {\n  //\n  // Note, if your need not \"symmetric\" resize logic, you MUST check\n  // `env.orientation` (set by plugins) and swap width/height appropriately.\n  //\n  var scale_factor = env.opts.max / Math.max(env.image.width, env.image.height);\n\n  if (scale_factor > 1) scale_factor = 1;\n\n  env.transform_width = Math.max(Math.round(env.image.width * scale_factor), 1);\n  env.transform_height = Math.max(Math.round(env.image.height * scale_factor), 1);\n\n  // Info for user plugins, to check if scaling applied\n  env.scale_factor = scale_factor;\n\n  return Promise.resolve(env);\n};\n\n\nImageBlobReduce.prototype._transform = function (env) {\n  env.out_canvas = this.pica.options.createCanvas(env.transform_width, env.transform_height);\n\n  // Dim env temporary vars to prohibit use and avoid confusion when orientation\n  // changed. You should take real size from canvas.\n  env.transform_width = null;\n  env.transform_height = null;\n\n  // By default use alpha for png only\n  var pica_opts = { alpha: env.blob.type === 'image/png' };\n\n  // Extract pica options if been passed\n  this.utils.assign(pica_opts, this.utils.pick_pica_resize_options(env.opts));\n\n  return this.pica\n    .resize(env.image, env.out_canvas, pica_opts)\n    .then(function () { return env; });\n};\n\n\nImageBlobReduce.prototype._cleanup = function (env) {\n  env.image.src = '';\n  env.image = null;\n\n  var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n  if (URL.revokeObjectURL) URL.revokeObjectURL(env.image_url);\n\n  env.image_url = null;\n\n  return Promise.resolve(env);\n};\n\n\nImageBlobReduce.prototype._create_blob = function (env) {\n  return this.pica.toBlob(env.out_canvas, env.blob.type)\n    .then(function (blob) {\n      env.out_blob = blob;\n      return env;\n    });\n};\n\n\nImageBlobReduce.prototype._getUint8Array = function (blob) {\n  if (blob.arrayBuffer) {\n    return blob.arrayBuffer().then(function (buf) {\n      return new Uint8Array(buf);\n    });\n  }\n\n  return new Promise(function (resolve, reject) {\n    var fr = new FileReader();\n\n    fr.readAsArrayBuffer(blob);\n\n    fr.onload = function () { resolve(new Uint8Array(fr.result)); };\n    fr.onerror = function () {\n      reject(new Error('ImageBlobReduce: failed to load data from input blob'));\n      fr.abort();\n    };\n    fr.onabort = function () {\n      reject(new Error('ImageBlobReduce: failed to load data from input blob (aborted)'));\n    };\n  });\n};\n\n\nImageBlobReduce.pica = pica;\n\nmodule.exports = ImageBlobReduce;\n","\n'use strict';\n\n//////////////////////////////////////////////////////////////////////////\n// Helpers\n//\nfunction error(message, code) {\n  var err = new Error(message);\n  err.code = code;\n  return err;\n}\n\n\n// Convert number to 0xHH string\n//\nfunction to_hex(number) {\n  var n = number.toString(16).toUpperCase();\n  for (var i = 2 - n.length; i > 0; i--) n = '0' + n;\n  return '0x' + n;\n}\n\n\nfunction utf8_encode(str) {\n  try {\n    return unescape(encodeURIComponent(str));\n  } catch (_) {\n    return str;\n  }\n}\n\n\nfunction utf8_decode(str) {\n  try {\n    return decodeURIComponent(escape(str));\n  } catch (_) {\n    return str;\n  }\n}\n\n\n// Check if input is a Uint8Array\n//\nfunction is_uint8array(bin) {\n  return Object.prototype.toString.call(bin) === '[object Uint8Array]';\n}\n\n\n//////////////////////////////////////////////////////////////////////////\n// Exif parser\n//\n// Input:\n//  - jpeg_bin:   Uint8Array - jpeg file\n//  - exif_start: Number     - start of TIFF header (after Exif\\0\\0)\n//  - exif_end:   Number     - end of Exif segment\n//  - on_entry:   Number     - callback\n//\nfunction ExifParser(jpeg_bin, exif_start, exif_end) {\n  // Uint8Array, exif without signature (which isn't included in offsets)\n  this.input      = jpeg_bin.subarray(exif_start, exif_end);\n\n  // offset correction for `on_entry` callback\n  this.start      = exif_start;\n\n  // Check TIFF header (includes byte alignment and first IFD offset)\n  var sig = String.fromCharCode.apply(null, this.input.subarray(0, 4));\n\n  if (sig !== 'II\\x2A\\0' && sig !== 'MM\\0\\x2A') {\n    throw error('invalid TIFF signature', 'EBADDATA');\n  }\n\n  // true if motorola (big endian) byte alignment, false if intel\n  this.big_endian = sig[0] === 'M';\n}\n\n\nExifParser.prototype.each = function (on_entry) {\n  // allow premature exit\n  this.aborted = false;\n\n  var offset = this.read_uint32(4);\n\n  this.ifds_to_read = [ {\n    id:     0,\n    offset: offset\n  } ];\n\n  while (this.ifds_to_read.length > 0 && !this.aborted) {\n    var i = this.ifds_to_read.shift();\n    if (!i.offset) continue;\n    this.scan_ifd(i.id, i.offset, on_entry);\n  }\n};\n\n\nExifParser.prototype.filter = function (on_entry) {\n  var ifds = {};\n\n  // make sure IFD0 always exists\n  ifds.ifd0 = { id: 0, entries: [] };\n\n  this.each(function (entry) {\n    if (on_entry(entry) === false && !entry.is_subifd_link) return;\n    if (entry.is_subifd_link && entry.count !== 1 && entry.format !== 4) return; // filter out bogus links\n\n    if (!ifds['ifd' + entry.ifd]) {\n      ifds['ifd' + entry.ifd] = { id: entry.ifd, entries: [] };\n    }\n\n    ifds['ifd' + entry.ifd].entries.push(entry);\n  });\n\n  // thumbnails are not supported just yet, so delete all information related to it\n  delete ifds.ifd1;\n\n  // Calculate output size\n  var length = 8;\n  Object.keys(ifds).forEach(function (ifd_no) {\n    length += 2;\n\n    ifds[ifd_no].entries.forEach(function (entry) {\n      length += 12 + (entry.data_length > 4 ? Math.ceil(entry.data_length / 2) * 2 : 0);\n    });\n\n    length += 4;\n  });\n\n  this.output = new Uint8Array(length);\n  this.output[0] = this.output[1] = (this.big_endian ? 'M' : 'I').charCodeAt(0);\n  this.write_uint16(2, 0x2A);\n\n  var offset = 8;\n  var self = this;\n  this.write_uint32(4, offset);\n\n  Object.keys(ifds).forEach(function (ifd_no) {\n    ifds[ifd_no].written_offset = offset;\n\n    var ifd_start = offset;\n    var ifd_end   = ifd_start + 2 + ifds[ifd_no].entries.length * 12 + 4;\n    offset = ifd_end;\n\n    self.write_uint16(ifd_start, ifds[ifd_no].entries.length);\n\n    ifds[ifd_no].entries.sort(function (a, b) {\n      // IFD entries must be in order of increasing tag IDs\n      return a.tag - b.tag;\n    }).forEach(function (entry, idx) {\n      var entry_offset = ifd_start + 2 + idx * 12;\n\n      self.write_uint16(entry_offset, entry.tag);\n      self.write_uint16(entry_offset + 2, entry.format);\n      self.write_uint32(entry_offset + 4, entry.count);\n\n      if (entry.is_subifd_link) {\n        // filled in later\n        if (ifds['ifd' + entry.tag]) ifds['ifd' + entry.tag].link_offset = entry_offset + 8;\n      } else if (entry.data_length <= 4) {\n        self.output.set(\n          self.input.subarray(entry.data_offset - self.start, entry.data_offset - self.start + 4),\n          entry_offset + 8\n        );\n      } else {\n        self.write_uint32(entry_offset + 8, offset);\n        self.output.set(\n          self.input.subarray(entry.data_offset - self.start, entry.data_offset - self.start + entry.data_length),\n          offset\n        );\n        offset += Math.ceil(entry.data_length / 2) * 2;\n      }\n    });\n\n    var next_ifd = ifds['ifd' + (ifds[ifd_no].id + 1)];\n    if (next_ifd) next_ifd.link_offset = ifd_end - 4;\n  });\n\n  Object.keys(ifds).forEach(function (ifd_no) {\n    if (ifds[ifd_no].written_offset && ifds[ifd_no].link_offset) {\n      self.write_uint32(ifds[ifd_no].link_offset, ifds[ifd_no].written_offset);\n    }\n  });\n\n  if (this.output.length !== offset) throw error('internal error: incorrect buffer size allocated');\n\n  return this.output;\n};\n\n\nExifParser.prototype.read_uint16 = function (offset) {\n  var d = this.input;\n  if (offset + 2 > d.length) throw error('unexpected EOF', 'EBADDATA');\n\n  return this.big_endian ?\n    d[offset] * 0x100 + d[offset + 1] :\n    d[offset] + d[offset + 1] * 0x100;\n};\n\n\nExifParser.prototype.read_uint32 = function (offset) {\n  var d = this.input;\n  if (offset + 4 > d.length) throw error('unexpected EOF', 'EBADDATA');\n\n  return this.big_endian ?\n    d[offset] * 0x1000000 + d[offset + 1] * 0x10000 + d[offset + 2] * 0x100 + d[offset + 3] :\n    d[offset] + d[offset + 1] * 0x100 + d[offset + 2] * 0x10000 + d[offset + 3] * 0x1000000;\n};\n\n\nExifParser.prototype.write_uint16 = function (offset, value) {\n  var d = this.output;\n\n  if (this.big_endian) {\n    d[offset]     = (value >>> 8) & 0xFF;\n    d[offset + 1] = value & 0xFF;\n  } else {\n    d[offset]     = value & 0xFF;\n    d[offset + 1] = (value >>> 8) & 0xFF;\n  }\n};\n\n\nExifParser.prototype.write_uint32 = function (offset, value) {\n  var d = this.output;\n\n  if (this.big_endian) {\n    d[offset]     = (value >>> 24) & 0xFF;\n    d[offset + 1] = (value >>> 16) & 0xFF;\n    d[offset + 2] = (value >>> 8) & 0xFF;\n    d[offset + 3] = value & 0xFF;\n  } else {\n    d[offset]     = value & 0xFF;\n    d[offset + 1] = (value >>> 8) & 0xFF;\n    d[offset + 2] = (value >>> 16) & 0xFF;\n    d[offset + 3] = (value >>> 24) & 0xFF;\n  }\n};\n\n\nExifParser.prototype.is_subifd_link = function (ifd, tag) {\n  return (ifd === 0 && tag === 0x8769) || // SubIFD\n         (ifd === 0 && tag === 0x8825) || // GPS Info\n         (ifd === 0x8769 && tag === 0xA005); // Interop IFD\n};\n\n\n// Returns byte length of a single component of a given format\n//\nExifParser.prototype.exif_format_length = function (format) {\n  switch (format) {\n    case 1: // byte\n    case 2: // ascii\n    case 6: // sbyte\n    case 7: // undefined\n      return 1;\n\n    case 3: // short\n    case 8: // sshort\n      return 2;\n\n    case 4:  // long\n    case 9:  // slong\n    case 11: // float\n      return 4;\n\n    case 5:  // rational\n    case 10: // srational\n    case 12: // double\n      return 8;\n\n    default:\n      // unknown type\n      return 0;\n  }\n};\n\n\n// Reads Exif data\n//\nExifParser.prototype.exif_format_read = function (format, offset) {\n  var v;\n\n  switch (format) {\n    case 1: // byte\n    case 2: // ascii\n      v = this.input[offset];\n      return v;\n\n    case 6: // sbyte\n      v = this.input[offset];\n      return v | (v & 0x80) * 0x1fffffe;\n\n    case 3: // short\n      v = this.read_uint16(offset);\n      return v;\n\n    case 8: // sshort\n      v = this.read_uint16(offset);\n      return v | (v & 0x8000) * 0x1fffe;\n\n    case 4: // long\n      v = this.read_uint32(offset);\n      return v;\n\n    case 9: // slong\n      v = this.read_uint32(offset);\n      return v | 0;\n\n    case 5:  // rational\n    case 10: // srational\n    case 11: // float\n    case 12: // double\n      return null; // not implemented\n\n    case 7: // undefined\n      return null; // blob\n\n    default:\n      // unknown type\n      return null;\n  }\n};\n\n\nExifParser.prototype.scan_ifd = function (ifd_no, offset, on_entry) {\n  var entry_count = this.read_uint16(offset);\n\n  offset += 2;\n\n  for (var i = 0; i < entry_count; i++) {\n    var tag    = this.read_uint16(offset);\n    var format = this.read_uint16(offset + 2);\n    var count  = this.read_uint32(offset + 4);\n\n    var comp_length    = this.exif_format_length(format);\n    var data_length    = count * comp_length;\n    var data_offset    = data_length <= 4 ? offset + 8 : this.read_uint32(offset + 8);\n    var is_subifd_link = false;\n\n    if (data_offset + data_length > this.input.length) {\n      throw error('unexpected EOF', 'EBADDATA');\n    }\n\n    var value = [];\n    var comp_offset = data_offset;\n\n    for (var j = 0; j < count; j++, comp_offset += comp_length) {\n      var item = this.exif_format_read(format, comp_offset);\n      if (item === null) {\n        value = null;\n        break;\n      }\n      value.push(item);\n    }\n\n    if (Array.isArray(value) && format === 2) {\n      try {\n        value = utf8_decode(String.fromCharCode.apply(null, value));\n      } catch (_) {\n        value = null;\n      }\n\n      if (value && value[value.length - 1] === '\\0') value = value.slice(0, -1);\n    }\n\n    if (this.is_subifd_link(ifd_no, tag)) {\n      if (Array.isArray(value) && Number.isInteger(value[0]) && value[0] > 0) {\n        this.ifds_to_read.push({\n          id:     tag,\n          offset: value[0]\n        });\n        is_subifd_link = true;\n      }\n    }\n\n    var entry = {\n      is_big_endian:  this.big_endian,\n      ifd:            ifd_no,\n      tag:            tag,\n      format:         format,\n      count:          count,\n      entry_offset:   offset + this.start,\n      data_length:    data_length,\n      data_offset:    data_offset + this.start,\n      value:          value,\n      is_subifd_link: is_subifd_link\n    };\n\n    if (on_entry(entry) === false) {\n      this.aborted = true;\n      return;\n    }\n\n    offset += 12;\n  }\n\n  if (ifd_no === 0) {\n    this.ifds_to_read.push({\n      id:     1,\n      offset: this.read_uint32(offset)\n    });\n  }\n};\n\n\n// Check whether input is a JPEG image\n//\n// Input:\n//  - jpeg_bin: Uint8Array - jpeg file\n//\n// Returns true if it is and false otherwise\n//\nmodule.exports.is_jpeg = function (jpeg_bin) {\n  return jpeg_bin.length >= 4 && jpeg_bin[0] === 0xFF && jpeg_bin[1] === 0xD8 && jpeg_bin[2] === 0xFF;\n};\n\n\n// Call an iterator on each segment in the given JPEG image\n//\n// Input:\n//  - jpeg_bin:   Uint8Array - jpeg file\n//  - on_segment: Function - callback executed on each JPEG marker segment\n//    - segment:  Object\n//      - code:   Number - marker type (2nd byte, e.g. 0xE0 for APP0)\n//      - offset: Number - offset of the first byte (0xFF) relative to `jpeg_bin` start\n//      - length: Number - length of the entire marker segment including first two bytes and length\n//        - 2 for standalone markers\n//        - 4+length for markers with data\n//\n// Iteration stops when `EOI` (0xFFD9) marker is reached or if `on_segment`\n// function returns `false`.\n//\nmodule.exports.jpeg_segments_each = function (jpeg_bin, on_segment) {\n  if (!is_uint8array(jpeg_bin)) {\n    throw error('Invalid argument (jpeg_bin), Uint8Array expected', 'EINVAL');\n  }\n\n  if (typeof on_segment !== 'function') {\n    throw error('Invalid argument (on_segment), Function expected', 'EINVAL');\n  }\n\n  if (!module.exports.is_jpeg(jpeg_bin)) {\n    throw error('Unknown file format', 'ENOTJPEG');\n  }\n\n  var offset = 0, length = jpeg_bin.length, inside_scan = false;\n\n  for (;;) {\n    var segment_code, segment_length;\n\n    if (offset + 1 >= length) throw error('Unexpected EOF', 'EBADDATA');\n    var byte1 = jpeg_bin[offset];\n    var byte2 = jpeg_bin[offset + 1];\n\n    if (byte1 === 0xFF && byte2 === 0xFF) {\n      // padding\n      segment_code = 0xFF;\n      segment_length = 1;\n\n    } else if (byte1 === 0xFF && byte2 !== 0) {\n      // marker\n      segment_code = byte2;\n      segment_length = 2;\n\n      if ((0xD0 <= segment_code && segment_code <= 0xD9) || segment_code === 0x01) {\n        // standalone markers, according to JPEG 1992,\n        // http://www.w3.org/Graphics/JPEG/itu-t81.pdf, see Table B.1\n      } else {\n        if (offset + 3 >= length) throw error('Unexpected EOF', 'EBADDATA');\n        segment_length += jpeg_bin[offset + 2] * 0x100 + jpeg_bin[offset + 3];\n        if (segment_length < 2) throw error('Invalid segment length', 'EBADDATA');\n        if (offset + segment_length - 1 >= length) throw error('Unexpected EOF', 'EBADDATA');\n      }\n\n      if (inside_scan) {\n        if (segment_code >= 0xD0 && segment_code <= 0xD7) {\n          // reset markers\n        } else {\n          inside_scan = false;\n        }\n      }\n\n      if (segment_code === 0xDA /* SOS */) inside_scan = true;\n    } else if (inside_scan) {\n      // entropy-encoded segment\n      for (var pos = offset + 1; ; pos++) {\n        // scan until we find FF\n        if (pos >= length) throw error('Unexpected EOF', 'EBADDATA');\n        if (jpeg_bin[pos] === 0xFF) {\n          if (pos + 1 >= length) throw error('Unexpected EOF', 'EBADDATA');\n          if (jpeg_bin[pos + 1] !== 0) {\n            segment_code = 0;\n            segment_length = pos - offset;\n            break;\n          }\n        }\n      }\n    } else {\n      throw error('Unexpected byte at segment start: ' + to_hex(byte1) +\n        ' (offset ' + to_hex(offset) + ')', 'EBADDATA');\n    }\n\n    if (on_segment({ code: segment_code, offset: offset, length: segment_length }) === false) break;\n    if (segment_code === 0xD9 /* EOI */) break;\n    offset += segment_length;\n  }\n};\n\n\n// Replace or remove segments in the given JPEG image\n//\n// Input:\n//  - jpeg_bin:   Uint8Array - jpeg file\n//  - on_segment: Function - callback executed on each JPEG marker segment\n//    - segment:  Object\n//      - code:   Number - marker type (2nd byte, e.g. 0xE0 for APP0)\n//      - offset: Number - offset of the first byte (0xFF) relative to `jpeg_bin` start\n//      - length: Number - length of the entire marker segment including first two bytes and length\n//        - 2 for standalone markers\n//        - 4+length for markers with data\n//\n// `on_segment` function should return one of the following:\n//  - `false`        - segment is removed from the output\n//  - Uint8Array     - segment is replaced with the new data\n//  - [ Uint8Array ] - segment is replaced with the new data\n//  - anything else  - segment is copied to the output as is\n//\n// Any data after `EOI` (0xFFD9) marker is removed.\n//\nmodule.exports.jpeg_segments_filter = function (jpeg_bin, on_segment) {\n  if (!is_uint8array(jpeg_bin)) {\n    throw error('Invalid argument (jpeg_bin), Uint8Array expected', 'EINVAL');\n  }\n\n  if (typeof on_segment !== 'function') {\n    throw error('Invalid argument (on_segment), Function expected', 'EINVAL');\n  }\n\n  var ranges = [];\n  var out_length = 0;\n\n  module.exports.jpeg_segments_each(jpeg_bin, function (segment) {\n    var new_segment = on_segment(segment);\n\n    if (is_uint8array(new_segment)) {\n      ranges.push({ data: new_segment });\n      out_length += new_segment.length;\n    } else if (Array.isArray(new_segment)) {\n      new_segment.filter(is_uint8array).forEach(function (s) {\n        ranges.push({ data: s });\n        out_length += s.length;\n      });\n    } else if (new_segment !== false) {\n      var new_range = { start: segment.offset, end: segment.offset + segment.length };\n\n      if (ranges.length > 0 && ranges[ranges.length - 1].end === new_range.start) {\n        ranges[ranges.length - 1].end = new_range.end;\n      } else {\n        ranges.push(new_range);\n      }\n\n      out_length += segment.length;\n    }\n  });\n\n  var result = new Uint8Array(out_length);\n  var offset = 0;\n\n  ranges.forEach(function (range) {\n    var data = range.data || jpeg_bin.subarray(range.start, range.end);\n    result.set(data, offset);\n    offset += data.length;\n  });\n\n  return result;\n};\n\n\n// Call an iterator on each Exif entry in the given JPEG image\n//\n// Input:\n//  - jpeg_bin: Uint8Array - jpeg file\n//  - on_entry: Function - callback executed on each Exif entry\n//    - entry:  Object\n//      - is_big_endian:  Boolean - whether Exif uses big or little endian byte alignment\n//      - ifd:            Number  - IFD identifier (0 for IFD0, 1 for IFD1, 0x8769 for SubIFD,\n//                                 0x8825 for GPS Info, 0xA005 for Interop IFD)\n//      - tag:            Number  - exif entry tag (0x0110 - camera name, 0x0112 - orientation, etc. - see Exif spec)\n//      - format:         Number  - exif entry format (1 - byte, 2 - ascii, 3 - short, etc. - see Exif spec)\n//      - count:          Number  - number of components of the given format inside data\n//                                 (usually 1, or string length for ascii format)\n//      - entry_offset:   Number  - start of Exif entry (entry length is always 12, so not included)\n//      - data_offset:    Number  - start of data attached to Exif entry (will overlap with entry if length <= 4)\n//      - data_length:    Number  - length of data attached to Exif entry\n//      - value:          Array|String|Null - our best attempt at parsing data (not all formats supported right now)\n//      - is_subifd_link: Boolean - whether this entry is recognized to be a link to subifd (can't filter these out)\n//\n// Iteration stops early if iterator returns `false`.\n//\n// If Exif wasn't found anywhere (before start of the image data, SOS),\n// iterator is never executed.\n//\nmodule.exports.jpeg_exif_tags_each = function (jpeg_bin, on_exif_entry) {\n  if (!is_uint8array(jpeg_bin)) {\n    throw error('Invalid argument (jpeg_bin), Uint8Array expected', 'EINVAL');\n  }\n\n  if (typeof on_exif_entry !== 'function') {\n    throw error('Invalid argument (on_exif_entry), Function expected', 'EINVAL');\n  }\n\n  /* eslint-disable consistent-return */\n  module.exports.jpeg_segments_each(jpeg_bin, function (segment) {\n    if (segment.code === 0xDA /* SOS */) return false;\n\n    // look for APP1 segment and compare header with 'Exif\\0\\0'\n    if (segment.code === 0xE1 && segment.length >= 10 &&\n        jpeg_bin[segment.offset + 4] === 0x45 && jpeg_bin[segment.offset + 5] === 0x78 &&\n        jpeg_bin[segment.offset + 6] === 0x69 && jpeg_bin[segment.offset + 7] === 0x66 &&\n        jpeg_bin[segment.offset + 8] === 0x00 && jpeg_bin[segment.offset + 9] === 0x00) {\n\n      new ExifParser(jpeg_bin, segment.offset + 10, segment.offset + segment.length).each(on_exif_entry);\n      return false;\n    }\n  });\n};\n\n\n// Remove Exif entries in the given JPEG image\n//\n// Input:\n//  - jpeg_bin: Uint8Array - jpeg file\n//  - on_entry: Function - callback executed on each Exif entry\n//    - entry:  Object\n//      - is_big_endian:  Boolean - whether Exif uses big or little endian byte alignment\n//      - ifd:            Number  - IFD identifier (0 for IFD0, 1 for IFD1, 0x8769 for SubIFD,\n//                                  0x8825 for GPS Info, 0xA005 for Interop IFD)\n//      - tag:            Number  - exif entry tag (0x0110 - camera name, 0x0112 - orientation, etc. - see Exif spec)\n//      - format:         Number  - exif entry format (1 - byte, 2 - ascii, 3 - short, etc. - see Exif spec)\n//      - count:          Number  - number of components of the given format inside data\n//                                  (usually 1, or string length for ascii format)\n//      - entry_offset:   Number  - start of Exif entry (entry length is always 12, so not included)\n//      - data_offset:    Number  - start of data attached to Exif entry (will overlap with entry if length <= 4)\n//      - data_length:    Number  - length of data attached to Exif entry\n//      - value:          Array|String|Null - our best attempt at parsing data (not all formats supported right now)\n//      - is_subifd_link: Boolean - whether this entry is recognized to be a link to subifd (can't filter these out)\n//\n// This function removes following from Exif:\n//  - all entries where iterator returned false (except subifd links which are mandatory)\n//  - IFD1 and thumbnail image (the purpose of this function is to reduce file size,\n//    so thumbnail is usually the first thing to go)\n//  - all other data that isn't in IFD0, SubIFD, GPSIFD, InteropIFD\n//    (theoretically possible proprietary extensions, I haven't seen any of these yet)\n//\n// Changing data inside Exif entries is NOT supported yet (modifying `entry` object inside callback may break stuff).\n//\n// If Exif wasn't found anywhere (before start of the image data, SOS),\n// iterator is never executed, and original JPEG is returned as is.\n//\nmodule.exports.jpeg_exif_tags_filter = function (jpeg_bin, on_exif_entry) {\n  if (!is_uint8array(jpeg_bin)) {\n    throw error('Invalid argument (jpeg_bin), Uint8Array expected', 'EINVAL');\n  }\n\n  if (typeof on_exif_entry !== 'function') {\n    throw error('Invalid argument (on_exif_entry), Function expected', 'EINVAL');\n  }\n\n  var stop_search = false;\n\n  return module.exports.jpeg_segments_filter(jpeg_bin, function (segment) {\n    if (stop_search) return;\n    if (segment.code === 0xDA /* SOS */) stop_search = true;\n\n    // look for APP1 segment and compare header with 'Exif\\0\\0'\n    if (segment.code === 0xE1 && segment.length >= 10 &&\n        jpeg_bin[segment.offset + 4] === 0x45 && jpeg_bin[segment.offset + 5] === 0x78 &&\n        jpeg_bin[segment.offset + 6] === 0x69 && jpeg_bin[segment.offset + 7] === 0x66 &&\n        jpeg_bin[segment.offset + 8] === 0x00 && jpeg_bin[segment.offset + 9] === 0x00) {\n\n      var new_exif = new ExifParser(jpeg_bin, segment.offset + 10, segment.offset + segment.length)\n        .filter(on_exif_entry);\n      if (!new_exif) return false;\n\n      var header = new Uint8Array(10);\n\n      header.set(jpeg_bin.slice(segment.offset, segment.offset + 10));\n      header[2] = ((new_exif.length + 8) >>> 8) & 0xFF;\n      header[3] = (new_exif.length + 8) & 0xFF;\n\n      stop_search = true;\n      return [ header, new_exif ];\n    }\n  });\n};\n\n\n// Inserts a custom comment marker segment into JPEG file.\n//\n// Input:\n//  - jpeg_bin: Uint8Array - jpeg file\n//  - comment:  String\n//\n// Comment is inserted after first two bytes (FFD8, SOI).\n//\n// If JFIF (APP0) marker exists immediately after SOI (as mandated by the JFIF\n// spec), we insert comment after it instead.\n//\nmodule.exports.jpeg_add_comment = function (jpeg_bin, comment) {\n  var comment_inserted = false, segment_count = 0;\n\n  return module.exports.jpeg_segments_filter(jpeg_bin, function (segment) {\n    segment_count++;\n    if (segment_count === 1 && segment.code === 0xD8 /* SOI  */) return;\n    if (segment_count === 2 && segment.code === 0xE0 /* APP0 */) return;\n\n    if (comment_inserted) return;\n    comment = utf8_encode(comment);\n\n    // comment segment\n    var csegment = new Uint8Array(5 + comment.length);\n    var offset = 0;\n\n    csegment[offset++] = 0xFF;\n    csegment[offset++] = 0xFE;\n    csegment[offset++] = ((comment.length + 3) >>> 8) & 0xFF;\n    csegment[offset++] = (comment.length + 3) & 0xFF;\n\n    comment.split('').forEach(function (c) {\n      csegment[offset++] = c.charCodeAt(0) & 0xFF;\n    });\n\n    csegment[offset++] = 0;\n    comment_inserted = true;\n\n    return [ csegment, jpeg_bin.subarray(segment.offset, segment.offset + segment.length) ];\n  });\n};\n","\n'use strict';\n\n\nvar image_traverse = require('./image_traverse');\n\n\nfunction jpeg_patch_exif(env) {\n  return this._getUint8Array(env.blob).then(function (data) {\n    env.is_jpeg = image_traverse.is_jpeg(data);\n\n    if (!env.is_jpeg) return Promise.resolve(env);\n\n    env.orig_blob = env.blob;\n\n    try {\n      var exif_is_big_endian, orientation_offset;\n\n      /* eslint-disable consistent-return */\n      image_traverse.jpeg_exif_tags_each(data, function (entry) {\n        if (entry.ifd === 0 && entry.tag === 0x112 && Array.isArray(entry.value)) {\n          env.orientation    = entry.value[0] || 1;\n          exif_is_big_endian = entry.is_big_endian;\n          orientation_offset = entry.data_offset;\n          return false;\n        }\n      });\n\n      if (orientation_offset) {\n        var orientation_patch = exif_is_big_endian ?\n          new Uint8Array([ 0, 1 ]) :\n          new Uint8Array([ 1, 0 ]);\n\n        env.blob = new Blob([\n          data.slice(0, orientation_offset),\n          orientation_patch,\n          data.slice(orientation_offset + 2)\n        ], { type: 'image/jpeg' });\n      }\n    } catch (_) {}\n\n    return env;\n  });\n}\n\n\nfunction jpeg_rotate_canvas(env) {\n  if (!env.is_jpeg) return Promise.resolve(env);\n\n  var orientation = env.orientation - 1;\n  if (!orientation) return Promise.resolve(env);\n\n  var canvas;\n\n  if (orientation & 4) {\n    canvas = this.pica.options.createCanvas(env.out_canvas.height, env.out_canvas.width);\n  } else {\n    canvas = this.pica.options.createCanvas(env.out_canvas.width, env.out_canvas.height);\n  }\n\n  var ctx = canvas.getContext('2d');\n\n  ctx.save();\n\n  if (orientation & 1) ctx.transform(-1, 0, 0, 1, canvas.width, 0);\n  if (orientation & 2) ctx.transform(-1, 0, 0, -1, canvas.width, canvas.height);\n  if (orientation & 4) ctx.transform(0, 1, 1, 0, 0, 0);\n\n  ctx.drawImage(env.out_canvas, 0, 0);\n  ctx.restore();\n\n  // Safari 12 workaround\n  // https://github.com/nodeca/pica/issues/199\n  env.out_canvas.width = env.out_canvas.height = 0;\n\n  env.out_canvas = canvas;\n\n  return Promise.resolve(env);\n}\n\n\nfunction jpeg_attach_orig_segments(env) {\n  if (!env.is_jpeg) return Promise.resolve(env);\n\n  return Promise.all([\n    this._getUint8Array(env.blob),\n    this._getUint8Array(env.out_blob)\n  ]).then(function (res) {\n    var data = res[0];\n    var data_out = res[1];\n\n    if (!image_traverse.is_jpeg(data)) return Promise.resolve(env);\n\n    var segments = [];\n\n    image_traverse.jpeg_segments_each(data, function (segment) {\n      if (segment.code === 0xDA /* SOS */) return false;\n      segments.push(segment);\n    });\n\n    segments = segments\n      .filter(function (segment) {\n        // Drop ICC_PROFILE\n        //\n        if (segment.code === 0xE2) return false;\n\n        // Keep all APPn segments excluding APP2 (ICC_PROFILE),\n        // remove others because most of them depend on image data (DCT and such).\n        //\n        // APP0 - JFIF, APP1 - Exif, the rest are photoshop metadata and such\n        //\n        // See full list at https://www.w3.org/Graphics/JPEG/itu-t81.pdf (table B.1 on page 32)\n        //\n        if (segment.code >= 0xE0 && segment.code < 0xF0) return true;\n\n        // Keep comments\n        //\n        if (segment.code === 0xFE) return true;\n\n        return false;\n      })\n      .map(function (segment) {\n        return data.slice(segment.offset, segment.offset + segment.length);\n      });\n\n    env.out_blob = new Blob(\n      // intentionally omitting expected JFIF segment (offset 2 to 20)\n      [ data_out.slice(0, 2) ].concat(segments).concat([ data_out.slice(20) ]),\n      { type: 'image/jpeg' }\n    );\n\n    return env;\n  });\n}\n\n\nfunction assign(reducer) {\n  reducer.before('_blob_to_image', jpeg_patch_exif);\n  reducer.after('_transform',      jpeg_rotate_canvas);\n  reducer.after('_create_blob',    jpeg_attach_orig_segments);\n}\n\n\nmodule.exports.jpeg_patch_exif = jpeg_patch_exif;\nmodule.exports.jpeg_rotate_canvas = jpeg_rotate_canvas;\nmodule.exports.jpeg_attach_orig_segments = jpeg_attach_orig_segments;\nmodule.exports.assign = assign;\n","'use strict';\n\n\nmodule.exports.assign = function assign(to) {\n  var from;\n\n  for (var s = 1; s < arguments.length; s++) {\n    from = Object(arguments[s]);\n\n    for (var key in from) {\n      if (Object.prototype.hasOwnProperty.call(from, key)) to[key] = from[key];\n    }\n  }\n\n  return to;\n};\n\n\nfunction pick(from, props) {\n  var to = {};\n\n  props.forEach(function (key) {\n    if (Object.prototype.hasOwnProperty.call(from, key)) to[key] = from[key];\n  });\n\n  return to;\n}\n\n\nfunction pick_pica_resize_options(from) {\n  return pick(from, [\n    'alpha',\n    'unsharpAmount',\n    'unsharpRadius',\n    'unsharpThreshold',\n    'cancelToken'\n  ]);\n}\n\n\nmodule.exports.pick = pick;\nmodule.exports.pick_pica_resize_options = pick_pica_resize_options;\n","/*!\n\npica\nhttps://github.com/nodeca/pica\n\n*/\n\n(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.pica = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(_dereq_,module,exports){\n// Collection of math functions\n//\n// 1. Combine components together\n// 2. Has async init to load wasm modules\n//\n'use strict';\n\nvar Multimath = _dereq_('multimath');\n\nvar mm_unsharp_mask = _dereq_('./mm_unsharp_mask');\n\nvar mm_resize = _dereq_('./mm_resize');\n\nfunction MathLib(requested_features) {\n  var __requested_features = requested_features || [];\n\n  var features = {\n    js: __requested_features.indexOf('js') >= 0,\n    wasm: __requested_features.indexOf('wasm') >= 0\n  };\n  Multimath.call(this, features);\n  this.features = {\n    js: features.js,\n    wasm: features.wasm && this.has_wasm()\n  };\n  this.use(mm_unsharp_mask);\n  this.use(mm_resize);\n}\n\nMathLib.prototype = Object.create(Multimath.prototype);\nMathLib.prototype.constructor = MathLib;\n\nMathLib.prototype.resizeAndUnsharp = function resizeAndUnsharp(options, cache) {\n  var result = this.resize(options, cache);\n\n  if (options.unsharpAmount) {\n    this.unsharp_mask(result, options.toWidth, options.toHeight, options.unsharpAmount, options.unsharpRadius, options.unsharpThreshold);\n  }\n\n  return result;\n};\n\nmodule.exports = MathLib;\n\n},{\"./mm_resize\":4,\"./mm_unsharp_mask\":9,\"multimath\":19}],2:[function(_dereq_,module,exports){\n// Resize convolvers, pure JS implementation\n//\n'use strict'; // Precision of fixed FP values\n//var FIXED_FRAC_BITS = 14;\n\nfunction clampTo8(i) {\n  return i < 0 ? 0 : i > 255 ? 255 : i;\n}\n\nfunction clampNegative(i) {\n  return i >= 0 ? i : 0;\n} // Convolve image data in horizontal direction. Can be used for:\n//\n// 1. bitmap with premultiplied alpha\n// 2. bitmap without alpha (all values 255)\n//\n// Notes:\n//\n// - output is transposed\n// - output resolution is ~15 bits per channel(for better precision).\n//\n\n\nfunction convolveHor(src, dest, srcW, srcH, destW, filters) {\n  var r, g, b, a;\n  var filterPtr, filterShift, filterSize;\n  var srcPtr, srcY, destX, filterVal;\n  var srcOffset = 0,\n      destOffset = 0; // For each row\n\n  for (srcY = 0; srcY < srcH; srcY++) {\n    filterPtr = 0; // Apply precomputed filters to each destination row point\n\n    for (destX = 0; destX < destW; destX++) {\n      // Get the filter that determines the current output pixel.\n      filterShift = filters[filterPtr++];\n      filterSize = filters[filterPtr++];\n      srcPtr = srcOffset + filterShift * 4 | 0;\n      r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n      for (; filterSize > 0; filterSize--) {\n        filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n        // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n        a = a + filterVal * src[srcPtr + 3] | 0;\n        b = b + filterVal * src[srcPtr + 2] | 0;\n        g = g + filterVal * src[srcPtr + 1] | 0;\n        r = r + filterVal * src[srcPtr] | 0;\n        srcPtr = srcPtr + 4 | 0;\n      } // Store 15 bits between passes for better precision\n      // Instead of shift to 14 (FIXED_FRAC_BITS), shift to 7 only\n      //\n\n\n      dest[destOffset + 3] = clampNegative(a >> 7);\n      dest[destOffset + 2] = clampNegative(b >> 7);\n      dest[destOffset + 1] = clampNegative(g >> 7);\n      dest[destOffset] = clampNegative(r >> 7);\n      destOffset = destOffset + srcH * 4 | 0;\n    }\n\n    destOffset = (srcY + 1) * 4 | 0;\n    srcOffset = (srcY + 1) * srcW * 4 | 0;\n  }\n} // Supplementary method for `convolveHor()`\n//\n\n\nfunction convolveVert(src, dest, srcW, srcH, destW, filters) {\n  var r, g, b, a;\n  var filterPtr, filterShift, filterSize;\n  var srcPtr, srcY, destX, filterVal;\n  var srcOffset = 0,\n      destOffset = 0; // For each row\n\n  for (srcY = 0; srcY < srcH; srcY++) {\n    filterPtr = 0; // Apply precomputed filters to each destination row point\n\n    for (destX = 0; destX < destW; destX++) {\n      // Get the filter that determines the current output pixel.\n      filterShift = filters[filterPtr++];\n      filterSize = filters[filterPtr++];\n      srcPtr = srcOffset + filterShift * 4 | 0;\n      r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n      for (; filterSize > 0; filterSize--) {\n        filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n        // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n        a = a + filterVal * src[srcPtr + 3] | 0;\n        b = b + filterVal * src[srcPtr + 2] | 0;\n        g = g + filterVal * src[srcPtr + 1] | 0;\n        r = r + filterVal * src[srcPtr] | 0;\n        srcPtr = srcPtr + 4 | 0;\n      } // Sync with premultiplied version for exact result match\n\n\n      r >>= 7;\n      g >>= 7;\n      b >>= 7;\n      a >>= 7; // Bring this value back in range + round result.\n      //\n\n      dest[destOffset + 3] = clampTo8(a + (1 << 13) >> 14);\n      dest[destOffset + 2] = clampTo8(b + (1 << 13) >> 14);\n      dest[destOffset + 1] = clampTo8(g + (1 << 13) >> 14);\n      dest[destOffset] = clampTo8(r + (1 << 13) >> 14);\n      destOffset = destOffset + srcH * 4 | 0;\n    }\n\n    destOffset = (srcY + 1) * 4 | 0;\n    srcOffset = (srcY + 1) * srcW * 4 | 0;\n  }\n} // Premultiply & convolve image data in horizontal direction. Can be used for:\n//\n// - Any bitmap data, extracted with `.getImageData()` method (with\n//   non-premultiplied alpha)\n//\n// For images without alpha channel this method is slower than `convolveHor()`\n//\n\n\nfunction convolveHorWithPre(src, dest, srcW, srcH, destW, filters) {\n  var r, g, b, a, alpha;\n  var filterPtr, filterShift, filterSize;\n  var srcPtr, srcY, destX, filterVal;\n  var srcOffset = 0,\n      destOffset = 0; // For each row\n\n  for (srcY = 0; srcY < srcH; srcY++) {\n    filterPtr = 0; // Apply precomputed filters to each destination row point\n\n    for (destX = 0; destX < destW; destX++) {\n      // Get the filter that determines the current output pixel.\n      filterShift = filters[filterPtr++];\n      filterSize = filters[filterPtr++];\n      srcPtr = srcOffset + filterShift * 4 | 0;\n      r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n      for (; filterSize > 0; filterSize--) {\n        filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n        // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n        alpha = src[srcPtr + 3];\n        a = a + filterVal * alpha | 0;\n        b = b + filterVal * src[srcPtr + 2] * alpha | 0;\n        g = g + filterVal * src[srcPtr + 1] * alpha | 0;\n        r = r + filterVal * src[srcPtr] * alpha | 0;\n        srcPtr = srcPtr + 4 | 0;\n      } // Premultiply is (* alpha / 255).\n      // Postpone division for better performance\n\n\n      b = b / 255 | 0;\n      g = g / 255 | 0;\n      r = r / 255 | 0; // Store 15 bits between passes for better precision\n      // Instead of shift to 14 (FIXED_FRAC_BITS), shift to 7 only\n      //\n\n      dest[destOffset + 3] = clampNegative(a >> 7);\n      dest[destOffset + 2] = clampNegative(b >> 7);\n      dest[destOffset + 1] = clampNegative(g >> 7);\n      dest[destOffset] = clampNegative(r >> 7);\n      destOffset = destOffset + srcH * 4 | 0;\n    }\n\n    destOffset = (srcY + 1) * 4 | 0;\n    srcOffset = (srcY + 1) * srcW * 4 | 0;\n  }\n} // Supplementary method for `convolveHorWithPre()`\n//\n\n\nfunction convolveVertWithPre(src, dest, srcW, srcH, destW, filters) {\n  var r, g, b, a;\n  var filterPtr, filterShift, filterSize;\n  var srcPtr, srcY, destX, filterVal;\n  var srcOffset = 0,\n      destOffset = 0; // For each row\n\n  for (srcY = 0; srcY < srcH; srcY++) {\n    filterPtr = 0; // Apply precomputed filters to each destination row point\n\n    for (destX = 0; destX < destW; destX++) {\n      // Get the filter that determines the current output pixel.\n      filterShift = filters[filterPtr++];\n      filterSize = filters[filterPtr++];\n      srcPtr = srcOffset + filterShift * 4 | 0;\n      r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n      for (; filterSize > 0; filterSize--) {\n        filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n        // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n        a = a + filterVal * src[srcPtr + 3] | 0;\n        b = b + filterVal * src[srcPtr + 2] | 0;\n        g = g + filterVal * src[srcPtr + 1] | 0;\n        r = r + filterVal * src[srcPtr] | 0;\n        srcPtr = srcPtr + 4 | 0;\n      } // Downscale to leave room for un-premultiply\n\n\n      r >>= 7;\n      g >>= 7;\n      b >>= 7;\n      a >>= 7; // Un-premultiply\n\n      a = clampTo8(a + (1 << 13) >> 14);\n\n      if (a > 0) {\n        r = r * 255 / a | 0;\n        g = g * 255 / a | 0;\n        b = b * 255 / a | 0;\n      } // Bring this value back in range + round result.\n      // Shift value = FIXED_FRAC_BITS + 7\n      //\n\n\n      dest[destOffset + 3] = a;\n      dest[destOffset + 2] = clampTo8(b + (1 << 13) >> 14);\n      dest[destOffset + 1] = clampTo8(g + (1 << 13) >> 14);\n      dest[destOffset] = clampTo8(r + (1 << 13) >> 14);\n      destOffset = destOffset + srcH * 4 | 0;\n    }\n\n    destOffset = (srcY + 1) * 4 | 0;\n    srcOffset = (srcY + 1) * srcW * 4 | 0;\n  }\n}\n\nmodule.exports = {\n  convolveHor: convolveHor,\n  convolveVert: convolveVert,\n  convolveHorWithPre: convolveHorWithPre,\n  convolveVertWithPre: convolveVertWithPre\n};\n\n},{}],3:[function(_dereq_,module,exports){\n// This is autogenerated file from math.wasm, don't edit.\n//\n'use strict';\n/* eslint-disable max-len */\n\nmodule.exports = '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';\n\n},{}],4:[function(_dereq_,module,exports){\n'use strict';\n\nmodule.exports = {\n  name: 'resize',\n  fn: _dereq_('./resize'),\n  wasm_fn: _dereq_('./resize_wasm'),\n  wasm_src: _dereq_('./convolve_wasm_base64')\n};\n\n},{\"./convolve_wasm_base64\":3,\"./resize\":5,\"./resize_wasm\":8}],5:[function(_dereq_,module,exports){\n'use strict';\n\nvar createFilters = _dereq_('./resize_filter_gen');\n\nvar _require = _dereq_('./convolve'),\n    convolveHor = _require.convolveHor,\n    convolveVert = _require.convolveVert,\n    convolveHorWithPre = _require.convolveHorWithPre,\n    convolveVertWithPre = _require.convolveVertWithPre;\n\nfunction hasAlpha(src, width, height) {\n  var ptr = 3,\n      len = width * height * 4 | 0;\n\n  while (ptr < len) {\n    if (src[ptr] !== 255) return true;\n    ptr = ptr + 4 | 0;\n  }\n\n  return false;\n}\n\nfunction resetAlpha(dst, width, height) {\n  var ptr = 3,\n      len = width * height * 4 | 0;\n\n  while (ptr < len) {\n    dst[ptr] = 0xFF;\n    ptr = ptr + 4 | 0;\n  }\n}\n\nmodule.exports = function resize(options) {\n  var src = options.src;\n  var srcW = options.width;\n  var srcH = options.height;\n  var destW = options.toWidth;\n  var destH = options.toHeight;\n  var scaleX = options.scaleX || options.toWidth / options.width;\n  var scaleY = options.scaleY || options.toHeight / options.height;\n  var offsetX = options.offsetX || 0;\n  var offsetY = options.offsetY || 0;\n  var dest = options.dest || new Uint8Array(destW * destH * 4);\n  var filter = typeof options.filter === 'undefined' ? 'mks2013' : options.filter;\n  var filtersX = createFilters(filter, srcW, destW, scaleX, offsetX),\n      filtersY = createFilters(filter, srcH, destH, scaleY, offsetY);\n  var tmp = new Uint16Array(destW * srcH * 4); // Autodetect if alpha channel exists, and use appropriate method\n\n  if (hasAlpha(src, srcW, srcH)) {\n    convolveHorWithPre(src, tmp, srcW, srcH, destW, filtersX);\n    convolveVertWithPre(tmp, dest, srcH, destW, destH, filtersY);\n  } else {\n    convolveHor(src, tmp, srcW, srcH, destW, filtersX);\n    convolveVert(tmp, dest, srcH, destW, destH, filtersY);\n    resetAlpha(dest, destW, destH);\n  }\n\n  return dest;\n};\n\n},{\"./convolve\":2,\"./resize_filter_gen\":6}],6:[function(_dereq_,module,exports){\n// Calculate convolution filters for each destination point,\n// and pack data to Int16Array:\n//\n// [ shift, length, data..., shift2, length2, data..., ... ]\n//\n// - shift - offset in src image\n// - length - filter length (in src points)\n// - data - filter values sequence\n//\n'use strict';\n\nvar FILTER_INFO = _dereq_('./resize_filter_info'); // Precision of fixed FP values\n\n\nvar FIXED_FRAC_BITS = 14;\n\nfunction toFixedPoint(num) {\n  return Math.round(num * ((1 << FIXED_FRAC_BITS) - 1));\n}\n\nmodule.exports = function resizeFilterGen(filter, srcSize, destSize, scale, offset) {\n  var filterFunction = FILTER_INFO.filter[filter].fn;\n  var scaleInverted = 1.0 / scale;\n  var scaleClamped = Math.min(1.0, scale); // For upscale\n  // Filter window (averaging interval), scaled to src image\n\n  var srcWindow = FILTER_INFO.filter[filter].win / scaleClamped;\n  var destPixel, srcPixel, srcFirst, srcLast, filterElementSize, floatFilter, fxpFilter, total, pxl, idx, floatVal, filterTotal, filterVal;\n  var leftNotEmpty, rightNotEmpty, filterShift, filterSize;\n  var maxFilterElementSize = Math.floor((srcWindow + 1) * 2);\n  var packedFilter = new Int16Array((maxFilterElementSize + 2) * destSize);\n  var packedFilterPtr = 0;\n  var slowCopy = !packedFilter.subarray || !packedFilter.set; // For each destination pixel calculate source range and built filter values\n\n  for (destPixel = 0; destPixel < destSize; destPixel++) {\n    // Scaling should be done relative to central pixel point\n    srcPixel = (destPixel + 0.5) * scaleInverted + offset;\n    srcFirst = Math.max(0, Math.floor(srcPixel - srcWindow));\n    srcLast = Math.min(srcSize - 1, Math.ceil(srcPixel + srcWindow));\n    filterElementSize = srcLast - srcFirst + 1;\n    floatFilter = new Float32Array(filterElementSize);\n    fxpFilter = new Int16Array(filterElementSize);\n    total = 0.0; // Fill filter values for calculated range\n\n    for (pxl = srcFirst, idx = 0; pxl <= srcLast; pxl++, idx++) {\n      floatVal = filterFunction((pxl + 0.5 - srcPixel) * scaleClamped);\n      total += floatVal;\n      floatFilter[idx] = floatVal;\n    } // Normalize filter, convert to fixed point and accumulate conversion error\n\n\n    filterTotal = 0;\n\n    for (idx = 0; idx < floatFilter.length; idx++) {\n      filterVal = floatFilter[idx] / total;\n      filterTotal += filterVal;\n      fxpFilter[idx] = toFixedPoint(filterVal);\n    } // Compensate normalization error, to minimize brightness drift\n\n\n    fxpFilter[destSize >> 1] += toFixedPoint(1.0 - filterTotal); //\n    // Now pack filter to useable form\n    //\n    // 1. Trim heading and tailing zero values, and compensate shitf/length\n    // 2. Put all to single array in this format:\n    //\n    //    [ pos shift, data length, value1, value2, value3, ... ]\n    //\n\n    leftNotEmpty = 0;\n\n    while (leftNotEmpty < fxpFilter.length && fxpFilter[leftNotEmpty] === 0) {\n      leftNotEmpty++;\n    }\n\n    if (leftNotEmpty < fxpFilter.length) {\n      rightNotEmpty = fxpFilter.length - 1;\n\n      while (rightNotEmpty > 0 && fxpFilter[rightNotEmpty] === 0) {\n        rightNotEmpty--;\n      }\n\n      filterShift = srcFirst + leftNotEmpty;\n      filterSize = rightNotEmpty - leftNotEmpty + 1;\n      packedFilter[packedFilterPtr++] = filterShift; // shift\n\n      packedFilter[packedFilterPtr++] = filterSize; // size\n\n      if (!slowCopy) {\n        packedFilter.set(fxpFilter.subarray(leftNotEmpty, rightNotEmpty + 1), packedFilterPtr);\n        packedFilterPtr += filterSize;\n      } else {\n        // fallback for old IE < 11, without subarray/set methods\n        for (idx = leftNotEmpty; idx <= rightNotEmpty; idx++) {\n          packedFilter[packedFilterPtr++] = fxpFilter[idx];\n        }\n      }\n    } else {\n      // zero data, write header only\n      packedFilter[packedFilterPtr++] = 0; // shift\n\n      packedFilter[packedFilterPtr++] = 0; // size\n    }\n  }\n\n  return packedFilter;\n};\n\n},{\"./resize_filter_info\":7}],7:[function(_dereq_,module,exports){\n// Filter definitions to build tables for\n// resizing convolvers.\n//\n// Presets for quality 0..3. Filter functions + window size\n//\n'use strict';\n\nvar filter = {\n  // Nearest neibor\n  box: {\n    win: 0.5,\n    fn: function fn(x) {\n      if (x < 0) x = -x;\n      return x < 0.5 ? 1.0 : 0.0;\n    }\n  },\n  // // Hamming\n  hamming: {\n    win: 1.0,\n    fn: function fn(x) {\n      if (x < 0) x = -x;\n\n      if (x >= 1.0) {\n        return 0.0;\n      }\n\n      if (x < 1.19209290E-07) {\n        return 1.0;\n      }\n\n      var xpi = x * Math.PI;\n      return Math.sin(xpi) / xpi * (0.54 + 0.46 * Math.cos(xpi / 1.0));\n    }\n  },\n  // Lanczos, win = 2\n  lanczos2: {\n    win: 2.0,\n    fn: function fn(x) {\n      if (x < 0) x = -x;\n\n      if (x >= 2.0) {\n        return 0.0;\n      }\n\n      if (x < 1.19209290E-07) {\n        return 1.0;\n      }\n\n      var xpi = x * Math.PI;\n      return Math.sin(xpi) / xpi * Math.sin(xpi / 2.0) / (xpi / 2.0);\n    }\n  },\n  // Lanczos, win = 3\n  lanczos3: {\n    win: 3.0,\n    fn: function fn(x) {\n      if (x < 0) x = -x;\n\n      if (x >= 3.0) {\n        return 0.0;\n      }\n\n      if (x < 1.19209290E-07) {\n        return 1.0;\n      }\n\n      var xpi = x * Math.PI;\n      return Math.sin(xpi) / xpi * Math.sin(xpi / 3.0) / (xpi / 3.0);\n    }\n  },\n  // Magic Kernel Sharp 2013, win = 2.5\n  // http://johncostella.com/magic/\n  mks2013: {\n    win: 2.5,\n    fn: function fn(x) {\n      if (x < 0) x = -x;\n\n      if (x >= 2.5) {\n        return 0.0;\n      }\n\n      if (x >= 1.5) {\n        return -0.125 * (x - 2.5) * (x - 2.5);\n      }\n\n      if (x >= 0.5) {\n        return 0.25 * (4 * x * x - 11 * x + 7);\n      }\n\n      return 1.0625 - 1.75 * x * x;\n    }\n  }\n};\nmodule.exports = {\n  filter: filter,\n  // Legacy mapping\n  f2q: {\n    box: 0,\n    hamming: 1,\n    lanczos2: 2,\n    lanczos3: 3\n  },\n  q2f: ['box', 'hamming', 'lanczos2', 'lanczos3']\n};\n\n},{}],8:[function(_dereq_,module,exports){\n'use strict';\n\nvar createFilters = _dereq_('./resize_filter_gen');\n\nfunction hasAlpha(src, width, height) {\n  var ptr = 3,\n      len = width * height * 4 | 0;\n\n  while (ptr < len) {\n    if (src[ptr] !== 255) return true;\n    ptr = ptr + 4 | 0;\n  }\n\n  return false;\n}\n\nfunction resetAlpha(dst, width, height) {\n  var ptr = 3,\n      len = width * height * 4 | 0;\n\n  while (ptr < len) {\n    dst[ptr] = 0xFF;\n    ptr = ptr + 4 | 0;\n  }\n}\n\nfunction asUint8Array(src) {\n  return new Uint8Array(src.buffer, 0, src.byteLength);\n}\n\nvar IS_LE = true; // should not crash everything on module load in old browsers\n\ntry {\n  IS_LE = new Uint32Array(new Uint8Array([1, 0, 0, 0]).buffer)[0] === 1;\n} catch (__) {}\n\nfunction copyInt16asLE(src, target, target_offset) {\n  if (IS_LE) {\n    target.set(asUint8Array(src), target_offset);\n    return;\n  }\n\n  for (var ptr = target_offset, i = 0; i < src.length; i++) {\n    var data = src[i];\n    target[ptr++] = data & 0xFF;\n    target[ptr++] = data >> 8 & 0xFF;\n  }\n}\n\nmodule.exports = function resize_wasm(options) {\n  var src = options.src;\n  var srcW = options.width;\n  var srcH = options.height;\n  var destW = options.toWidth;\n  var destH = options.toHeight;\n  var scaleX = options.scaleX || options.toWidth / options.width;\n  var scaleY = options.scaleY || options.toHeight / options.height;\n  var offsetX = options.offsetX || 0.0;\n  var offsetY = options.offsetY || 0.0;\n  var dest = options.dest || new Uint8Array(destW * destH * 4);\n  var filter = typeof options.filter === 'undefined' ? 'mks2013' : options.filter;\n  var filtersX = createFilters(filter, srcW, destW, scaleX, offsetX),\n      filtersY = createFilters(filter, srcH, destH, scaleY, offsetY); // destination is 0 too.\n\n  var src_offset = 0;\n  var src_size = Math.max(src.byteLength, dest.byteLength); // buffer between convolve passes\n\n  var tmp_offset = this.__align(src_offset + src_size);\n\n  var tmp_size = srcH * destW * 4 * 2; // 2 bytes per channel\n\n  var filtersX_offset = this.__align(tmp_offset + tmp_size);\n\n  var filtersY_offset = this.__align(filtersX_offset + filtersX.byteLength);\n\n  var alloc_bytes = filtersY_offset + filtersY.byteLength;\n\n  var instance = this.__instance('resize', alloc_bytes); //\n  // Fill memory block with data to process\n  //\n\n\n  var mem = new Uint8Array(this.__memory.buffer);\n  var mem32 = new Uint32Array(this.__memory.buffer); // 32-bit copy is much faster in chrome\n\n  var src32 = new Uint32Array(src.buffer);\n  mem32.set(src32); // We should guarantee LE bytes order. Filters are not big, so\n  // speed difference is not significant vs direct .set()\n\n  copyInt16asLE(filtersX, mem, filtersX_offset);\n  copyInt16asLE(filtersY, mem, filtersY_offset); // Now call webassembly method\n  // emsdk does method names with '_'\n\n  var fn = instance.exports.convolveHV || instance.exports._convolveHV;\n\n  if (hasAlpha(src, srcW, srcH)) {\n    fn(filtersX_offset, filtersY_offset, tmp_offset, srcW, srcH, destW, destH, 1);\n  } else {\n    fn(filtersX_offset, filtersY_offset, tmp_offset, srcW, srcH, destW, destH, 0);\n    resetAlpha(dest, destW, destH);\n  } //\n  // Copy data back to typed array\n  //\n  // 32-bit copy is much faster in chrome\n\n\n  var dest32 = new Uint32Array(dest.buffer);\n  dest32.set(new Uint32Array(this.__memory.buffer, 0, destH * destW));\n  return dest;\n};\n\n},{\"./resize_filter_gen\":6}],9:[function(_dereq_,module,exports){\n'use strict';\n\nmodule.exports = {\n  name: 'unsharp_mask',\n  fn: _dereq_('./unsharp_mask'),\n  wasm_fn: _dereq_('./unsharp_mask_wasm'),\n  wasm_src: _dereq_('./unsharp_mask_wasm_base64')\n};\n\n},{\"./unsharp_mask\":10,\"./unsharp_mask_wasm\":11,\"./unsharp_mask_wasm_base64\":12}],10:[function(_dereq_,module,exports){\n// Unsharp mask filter\n//\n// http://stackoverflow.com/a/23322820/1031804\n// USM(O) = O + (2 * (Amount / 100) * (O - GB))\n// GB - gaussian blur.\n//\n// Image is converted from RGB to HSV, unsharp mask is applied to the\n// brightness channel and then image is converted back to RGB.\n//\n'use strict';\n\nvar glur_mono16 = _dereq_('glur/mono16');\n\nfunction hsv_v16(img, width, height) {\n  var size = width * height;\n  var out = new Uint16Array(size);\n  var r, g, b, max;\n\n  for (var i = 0; i < size; i++) {\n    r = img[4 * i];\n    g = img[4 * i + 1];\n    b = img[4 * i + 2];\n    max = r >= g && r >= b ? r : g >= b && g >= r ? g : b;\n    out[i] = max << 8;\n  }\n\n  return out;\n}\n\nmodule.exports = function unsharp(img, width, height, amount, radius, threshold) {\n  var v1, v2, vmul;\n  var diff, iTimes4;\n\n  if (amount === 0 || radius < 0.5) {\n    return;\n  }\n\n  if (radius > 2.0) {\n    radius = 2.0;\n  }\n\n  var brightness = hsv_v16(img, width, height);\n  var blured = new Uint16Array(brightness); // copy, because blur modify src\n\n  glur_mono16(blured, width, height, radius);\n  var amountFp = amount / 100 * 0x1000 + 0.5 | 0;\n  var thresholdFp = threshold << 8;\n  var size = width * height;\n  /* eslint-disable indent */\n\n  for (var i = 0; i < size; i++) {\n    v1 = brightness[i];\n    diff = v1 - blured[i];\n\n    if (Math.abs(diff) >= thresholdFp) {\n      // add unsharp mask to the brightness channel\n      v2 = v1 + (amountFp * diff + 0x800 >> 12); // Both v1 and v2 are within [0.0 .. 255.0] (0000-FF00) range, never going into\n      // [255.003 .. 255.996] (FF01-FFFF). This allows to round this value as (x+.5)|0\n      // later without overflowing.\n\n      v2 = v2 > 0xff00 ? 0xff00 : v2;\n      v2 = v2 < 0x0000 ? 0x0000 : v2; // Avoid division by 0. V=0 means rgb(0,0,0), unsharp with unsharpAmount>0 cannot\n      // change this value (because diff between colors gets inflated), so no need to verify correctness.\n\n      v1 = v1 !== 0 ? v1 : 1; // Multiplying V in HSV model by a constant is equivalent to multiplying each component\n      // in RGB by the same constant (same for HSL), see also:\n      // https://beesbuzz.biz/code/16-hsv-color-transforms\n\n      vmul = (v2 << 12) / v1 | 0; // Result will be in [0..255] range because:\n      //  - all numbers are positive\n      //  - r,g,b <= (v1/256)\n      //  - r,g,b,(v1/256),(v2/256) <= 255\n      // So highest this number can get is X*255/X+0.5=255.5 which is < 256 and rounds down.\n\n      iTimes4 = i * 4;\n      img[iTimes4] = img[iTimes4] * vmul + 0x800 >> 12; // R\n\n      img[iTimes4 + 1] = img[iTimes4 + 1] * vmul + 0x800 >> 12; // G\n\n      img[iTimes4 + 2] = img[iTimes4 + 2] * vmul + 0x800 >> 12; // B\n    }\n  }\n};\n\n},{\"glur/mono16\":18}],11:[function(_dereq_,module,exports){\n'use strict';\n\nmodule.exports = function unsharp(img, width, height, amount, radius, threshold) {\n  if (amount === 0 || radius < 0.5) {\n    return;\n  }\n\n  if (radius > 2.0) {\n    radius = 2.0;\n  }\n\n  var pixels = width * height;\n  var img_bytes_cnt = pixels * 4;\n  var hsv_bytes_cnt = pixels * 2;\n  var blur_bytes_cnt = pixels * 2;\n  var blur_line_byte_cnt = Math.max(width, height) * 4; // float32 array\n\n  var blur_coeffs_byte_cnt = 8 * 4; // float32 array\n\n  var img_offset = 0;\n  var hsv_offset = img_bytes_cnt;\n  var blur_offset = hsv_offset + hsv_bytes_cnt;\n  var blur_tmp_offset = blur_offset + blur_bytes_cnt;\n  var blur_line_offset = blur_tmp_offset + blur_bytes_cnt;\n  var blur_coeffs_offset = blur_line_offset + blur_line_byte_cnt;\n\n  var instance = this.__instance('unsharp_mask', img_bytes_cnt + hsv_bytes_cnt + blur_bytes_cnt * 2 + blur_line_byte_cnt + blur_coeffs_byte_cnt, {\n    exp: Math.exp\n  }); // 32-bit copy is much faster in chrome\n\n\n  var img32 = new Uint32Array(img.buffer);\n  var mem32 = new Uint32Array(this.__memory.buffer);\n  mem32.set(img32); // HSL\n\n  var fn = instance.exports.hsv_v16 || instance.exports._hsv_v16;\n  fn(img_offset, hsv_offset, width, height); // BLUR\n\n  fn = instance.exports.blurMono16 || instance.exports._blurMono16;\n  fn(hsv_offset, blur_offset, blur_tmp_offset, blur_line_offset, blur_coeffs_offset, width, height, radius); // UNSHARP\n\n  fn = instance.exports.unsharp || instance.exports._unsharp;\n  fn(img_offset, img_offset, hsv_offset, blur_offset, width, height, amount, threshold); // 32-bit copy is much faster in chrome\n\n  img32.set(new Uint32Array(this.__memory.buffer, 0, pixels));\n};\n\n},{}],12:[function(_dereq_,module,exports){\n// This is autogenerated file from math.wasm, don't edit.\n//\n'use strict';\n/* eslint-disable max-len */\n\nmodule.exports = 'AGFzbQEAAAAADAZkeWxpbmsAAAAAAAE0B2AAAGAEf39/fwBgBn9/f39/fwBgCH9/f39/f39/AGAIf39/f39/f30AYAJ9fwBgAXwBfAIZAgNlbnYDZXhwAAYDZW52Bm1lbW9yeQIAAAMHBgAFAgQBAwYGAX8AQQALB4oBCBFfX3dhc21fY2FsbF9jdG9ycwABFl9fYnVpbGRfZ2F1c3NpYW5fY29lZnMAAg5fX2dhdXNzMTZfbGluZQADCmJsdXJNb25vMTYABAdoc3ZfdjE2AAUHdW5zaGFycAAGDF9fZHNvX2hhbmRsZQMAGF9fd2FzbV9hcHBseV9kYXRhX3JlbG9jcwABCsUMBgMAAQvWAQEHfCABRNuGukOCGvs/IAC7oyICRAAAAAAAAADAohAAIgW2jDgCFCABIAKaEAAiAyADoCIGtjgCECABRAAAAAAAAPA/IAOhIgQgBKIgAyACIAKgokQAAAAAAADwP6AgBaGjIgS2OAIAIAEgBSAEmqIiB7Y4AgwgASADIAJEAAAAAAAA8D+gIASioiIItjgCCCABIAMgAkQAAAAAAADwv6AgBKKiIgK2OAIEIAEgByAIoCAFRAAAAAAAAPA/IAahoCIDo7Y4AhwgASAEIAKgIAOjtjgCGAuGBQMGfwl8An0gAyoCDCEVIAMqAgghFiADKgIUuyERIAMqAhC7IRACQCAEQQFrIghBAEgiCQRAIAIhByAAIQYMAQsgAiAALwEAuCIPIAMqAhi7oiIMIBGiIg0gDCAQoiAPIAMqAgS7IhOiIhQgAyoCALsiEiAPoqCgoCIOtjgCACACQQRqIQcgAEECaiEGIAhFDQAgCEEBIAhBAUgbIgpBf3MhCwJ/IAQgCmtBAXFFBEAgDiENIAgMAQsgAiANIA4gEKIgFCASIAAvAQK4Ig+ioKCgIg22OAIEIAJBCGohByAAQQRqIQYgDiEMIARBAmsLIQIgC0EAIARrRg0AA0AgByAMIBGiIA0gEKIgDyAToiASIAYvAQC4Ig6ioKCgIgy2OAIAIAcgDSARoiAMIBCiIA4gE6IgEiAGLwECuCIPoqCgoCINtjgCBCAHQQhqIQcgBkEEaiEGIAJBAkohACACQQJrIQIgAA0ACwsCQCAJDQAgASAFIAhsQQF0aiIAAn8gBkECay8BACICuCINIBW7IhKiIA0gFrsiE6KgIA0gAyoCHLuiIgwgEKKgIAwgEaKgIg8gB0EEayIHKgIAu6AiDkQAAAAAAADwQWMgDkQAAAAAAAAAAGZxBEAgDqsMAQtBAAs7AQAgCEUNACAGQQRrIQZBACAFa0EBdCEBA0ACfyANIBKiIAJB//8DcbgiDSAToqAgDyIOIBCioCAMIBGioCIPIAdBBGsiByoCALugIgxEAAAAAAAA8EFjIAxEAAAAAAAAAABmcQRAIAyrDAELQQALIQMgBi8BACECIAAgAWoiACADOwEAIAZBAmshBiAIQQFKIQMgDiEMIAhBAWshCCADDQALCwvRAgIBfwd8AkAgB0MAAAAAWw0AIARE24a6Q4Ia+z8gB0MAAAA/l7ujIglEAAAAAAAAAMCiEAAiDLaMOAIUIAQgCZoQACIKIAqgIg22OAIQIAREAAAAAAAA8D8gCqEiCyALoiAKIAkgCaCiRAAAAAAAAPA/oCAMoaMiC7Y4AgAgBCAMIAuaoiIOtjgCDCAEIAogCUQAAAAAAADwP6AgC6KiIg+2OAIIIAQgCiAJRAAAAAAAAPC/oCALoqIiCbY4AgQgBCAOIA+gIAxEAAAAAAAA8D8gDaGgIgqjtjgCHCAEIAsgCaAgCqO2OAIYIAYEQANAIAAgBSAIbEEBdGogAiAIQQF0aiADIAQgBSAGEAMgCEEBaiIIIAZHDQALCyAFRQ0AQQAhCANAIAIgBiAIbEEBdGogASAIQQF0aiADIAQgBiAFEAMgCEEBaiIIIAVHDQALCwtxAQN/IAIgA2wiBQRAA0AgASAAKAIAIgRBEHZB/wFxIgIgAiAEQQh2Qf8BcSIDIAMgBEH/AXEiBEkbIAIgA0sbIgYgBiAEIAIgBEsbIAMgBEsbQQh0OwEAIAFBAmohASAAQQRqIQAgBUEBayIFDQALCwuZAgIDfwF8IAQgBWwhBAJ/IAazQwAAgEWUQwAAyEKVu0QAAAAAAADgP6AiC5lEAAAAAAAA4EFjBEAgC6oMAQtBgICAgHgLIQUgBARAIAdBCHQhCUEAIQYDQCAJIAIgBkEBdCIHai8BACIBIAMgB2ovAQBrIgcgB0EfdSIIaiAIc00EQCAAIAZBAnQiCGoiCiAFIAdsQYAQakEMdSABaiIHQYD+AyAHQYD+A0gbIgdBACAHQQBKG0EMdCABQQEgARtuIgEgCi0AAGxBgBBqQQx2OgAAIAAgCEEBcmoiByABIActAABsQYAQakEMdjoAACAAIAhBAnJqIgcgASAHLQAAbEGAEGpBDHY6AAALIAZBAWoiBiAERw0ACwsL';\n\n},{}],13:[function(_dereq_,module,exports){\n'use strict';\n\nvar GC_INTERVAL = 100;\n\nfunction Pool(create, idle) {\n  this.create = create;\n  this.available = [];\n  this.acquired = {};\n  this.lastId = 1;\n  this.timeoutId = 0;\n  this.idle = idle || 2000;\n}\n\nPool.prototype.acquire = function () {\n  var _this = this;\n\n  var resource;\n\n  if (this.available.length !== 0) {\n    resource = this.available.pop();\n  } else {\n    resource = this.create();\n    resource.id = this.lastId++;\n\n    resource.release = function () {\n      return _this.release(resource);\n    };\n  }\n\n  this.acquired[resource.id] = resource;\n  return resource;\n};\n\nPool.prototype.release = function (resource) {\n  var _this2 = this;\n\n  delete this.acquired[resource.id];\n  resource.lastUsed = Date.now();\n  this.available.push(resource);\n\n  if (this.timeoutId === 0) {\n    this.timeoutId = setTimeout(function () {\n      return _this2.gc();\n    }, GC_INTERVAL);\n  }\n};\n\nPool.prototype.gc = function () {\n  var _this3 = this;\n\n  var now = Date.now();\n  this.available = this.available.filter(function (resource) {\n    if (now - resource.lastUsed > _this3.idle) {\n      resource.destroy();\n      return false;\n    }\n\n    return true;\n  });\n\n  if (this.available.length !== 0) {\n    this.timeoutId = setTimeout(function () {\n      return _this3.gc();\n    }, GC_INTERVAL);\n  } else {\n    this.timeoutId = 0;\n  }\n};\n\nmodule.exports = Pool;\n\n},{}],14:[function(_dereq_,module,exports){\n// Add intermediate resizing steps when scaling down by a very large factor.\n//\n// For example, when resizing 10000x10000 down to 10x10, it'll resize it to\n// 300x300 first.\n//\n// It's needed because tiler has issues when the entire tile is scaled down\n// to a few pixels (1024px source tile with border size 3 should result in\n// at least 3+3+2 = 8px target tile, so max scale factor is 128 here).\n//\n// Also, adding intermediate steps can speed up processing if we use lower\n// quality algorithms for first stages.\n//\n'use strict'; // min size = 0 results in infinite loop,\n// min size = 1 can consume large amount of memory\n\nvar MIN_INNER_TILE_SIZE = 2;\n\nmodule.exports = function createStages(fromWidth, fromHeight, toWidth, toHeight, srcTileSize, destTileBorder) {\n  var scaleX = toWidth / fromWidth;\n  var scaleY = toHeight / fromHeight; // derived from createRegions equation:\n  // innerTileWidth = pixelFloor(srcTileSize * scaleX) - 2 * destTileBorder;\n\n  var minScale = (2 * destTileBorder + MIN_INNER_TILE_SIZE + 1) / srcTileSize; // refuse to scale image multiple times by less than twice each time,\n  // it could only happen because of invalid options\n\n  if (minScale > 0.5) return [[toWidth, toHeight]];\n  var stageCount = Math.ceil(Math.log(Math.min(scaleX, scaleY)) / Math.log(minScale)); // no additional resizes are necessary,\n  // stageCount can be zero or be negative when enlarging the image\n\n  if (stageCount <= 1) return [[toWidth, toHeight]];\n  var result = [];\n\n  for (var i = 0; i < stageCount; i++) {\n    var width = Math.round(Math.pow(Math.pow(fromWidth, stageCount - i - 1) * Math.pow(toWidth, i + 1), 1 / stageCount));\n    var height = Math.round(Math.pow(Math.pow(fromHeight, stageCount - i - 1) * Math.pow(toHeight, i + 1), 1 / stageCount));\n    result.push([width, height]);\n  }\n\n  return result;\n};\n\n},{}],15:[function(_dereq_,module,exports){\n// Split original image into multiple 1024x1024 chunks to reduce memory usage\n// (images have to be unpacked into typed arrays for resizing) and allow\n// parallel processing of multiple tiles at a time.\n//\n'use strict';\n/*\n * pixelFloor and pixelCeil are modified versions of Math.floor and Math.ceil\n * functions which take into account floating point arithmetic errors.\n * Those errors can cause undesired increments/decrements of sizes and offsets:\n * Math.ceil(36 / (36 / 500)) = 501\n * pixelCeil(36 / (36 / 500)) = 500\n */\n\nvar PIXEL_EPSILON = 1e-5;\n\nfunction pixelFloor(x) {\n  var nearest = Math.round(x);\n\n  if (Math.abs(x - nearest) < PIXEL_EPSILON) {\n    return nearest;\n  }\n\n  return Math.floor(x);\n}\n\nfunction pixelCeil(x) {\n  var nearest = Math.round(x);\n\n  if (Math.abs(x - nearest) < PIXEL_EPSILON) {\n    return nearest;\n  }\n\n  return Math.ceil(x);\n}\n\nmodule.exports = function createRegions(options) {\n  var scaleX = options.toWidth / options.width;\n  var scaleY = options.toHeight / options.height;\n  var innerTileWidth = pixelFloor(options.srcTileSize * scaleX) - 2 * options.destTileBorder;\n  var innerTileHeight = pixelFloor(options.srcTileSize * scaleY) - 2 * options.destTileBorder; // prevent infinite loop, this should never happen\n\n  if (innerTileWidth < 1 || innerTileHeight < 1) {\n    throw new Error('Internal error in pica: target tile width/height is too small.');\n  }\n\n  var x, y;\n  var innerX, innerY, toTileWidth, toTileHeight;\n  var tiles = [];\n  var tile; // we go top-to-down instead of left-to-right to make image displayed from top to\n  // doesn in the browser\n\n  for (innerY = 0; innerY < options.toHeight; innerY += innerTileHeight) {\n    for (innerX = 0; innerX < options.toWidth; innerX += innerTileWidth) {\n      x = innerX - options.destTileBorder;\n\n      if (x < 0) {\n        x = 0;\n      }\n\n      toTileWidth = innerX + innerTileWidth + options.destTileBorder - x;\n\n      if (x + toTileWidth >= options.toWidth) {\n        toTileWidth = options.toWidth - x;\n      }\n\n      y = innerY - options.destTileBorder;\n\n      if (y < 0) {\n        y = 0;\n      }\n\n      toTileHeight = innerY + innerTileHeight + options.destTileBorder - y;\n\n      if (y + toTileHeight >= options.toHeight) {\n        toTileHeight = options.toHeight - y;\n      }\n\n      tile = {\n        toX: x,\n        toY: y,\n        toWidth: toTileWidth,\n        toHeight: toTileHeight,\n        toInnerX: innerX,\n        toInnerY: innerY,\n        toInnerWidth: innerTileWidth,\n        toInnerHeight: innerTileHeight,\n        offsetX: x / scaleX - pixelFloor(x / scaleX),\n        offsetY: y / scaleY - pixelFloor(y / scaleY),\n        scaleX: scaleX,\n        scaleY: scaleY,\n        x: pixelFloor(x / scaleX),\n        y: pixelFloor(y / scaleY),\n        width: pixelCeil(toTileWidth / scaleX),\n        height: pixelCeil(toTileHeight / scaleY)\n      };\n      tiles.push(tile);\n    }\n  }\n\n  return tiles;\n};\n\n},{}],16:[function(_dereq_,module,exports){\n'use strict';\n\nfunction objClass(obj) {\n  return Object.prototype.toString.call(obj);\n}\n\nmodule.exports.isCanvas = function isCanvas(element) {\n  var cname = objClass(element);\n  return cname === '[object HTMLCanvasElement]'\n  /* browser */\n  || cname === '[object OffscreenCanvas]' || cname === '[object Canvas]'\n  /* node-canvas */\n  ;\n};\n\nmodule.exports.isImage = function isImage(element) {\n  return objClass(element) === '[object HTMLImageElement]';\n};\n\nmodule.exports.isImageBitmap = function isImageBitmap(element) {\n  return objClass(element) === '[object ImageBitmap]';\n};\n\nmodule.exports.limiter = function limiter(concurrency) {\n  var active = 0,\n      queue = [];\n\n  function roll() {\n    if (active < concurrency && queue.length) {\n      active++;\n      queue.shift()();\n    }\n  }\n\n  return function limit(fn) {\n    return new Promise(function (resolve, reject) {\n      queue.push(function () {\n        fn().then(function (result) {\n          resolve(result);\n          active--;\n          roll();\n        }, function (err) {\n          reject(err);\n          active--;\n          roll();\n        });\n      });\n      roll();\n    });\n  };\n};\n\nmodule.exports.cib_quality_name = function cib_quality_name(num) {\n  switch (num) {\n    case 0:\n      return 'pixelated';\n\n    case 1:\n      return 'low';\n\n    case 2:\n      return 'medium';\n  }\n\n  return 'high';\n};\n\nmodule.exports.cib_support = function cib_support(createCanvas) {\n  return Promise.resolve().then(function () {\n    if (typeof createImageBitmap === 'undefined') {\n      return false;\n    }\n\n    var c = createCanvas(100, 100);\n    return createImageBitmap(c, 0, 0, 100, 100, {\n      resizeWidth: 10,\n      resizeHeight: 10,\n      resizeQuality: 'high'\n    }).then(function (bitmap) {\n      var status = bitmap.width === 10; // Branch below is filtered on upper level. We do not call resize\n      // detection for basic ImageBitmap.\n      //\n      // https://developer.mozilla.org/en-US/docs/Web/API/ImageBitmap\n      // old Crome 51 has ImageBitmap without .close(). Then this code\n      // will throw and return 'false' as expected.\n      //\n\n      bitmap.close();\n      c = null;\n      return status;\n    });\n  })[\"catch\"](function () {\n    return false;\n  });\n};\n\nmodule.exports.worker_offscreen_canvas_support = function worker_offscreen_canvas_support() {\n  return new Promise(function (resolve, reject) {\n    if (typeof OffscreenCanvas === 'undefined') {\n      // if OffscreenCanvas is present, we assume browser supports Worker and built-in Promise as well\n      resolve(false);\n      return;\n    }\n\n    function workerPayload(self) {\n      if (typeof createImageBitmap === 'undefined') {\n        self.postMessage(false);\n        return;\n      }\n\n      Promise.resolve().then(function () {\n        var canvas = new OffscreenCanvas(10, 10); // test that 2d context can be used in worker\n\n        var ctx = canvas.getContext('2d');\n        ctx.rect(0, 0, 1, 1); // test that cib can be used to return image bitmap from worker\n\n        return createImageBitmap(canvas, 0, 0, 1, 1);\n      }).then(function () {\n        return self.postMessage(true);\n      }, function () {\n        return self.postMessage(false);\n      });\n    }\n\n    var code = btoa(\"(\".concat(workerPayload.toString(), \")(self);\"));\n    var w = new Worker(\"data:text/javascript;base64,\".concat(code));\n\n    w.onmessage = function (ev) {\n      return resolve(ev.data);\n    };\n\n    w.onerror = reject;\n  }).then(function (result) {\n    return result;\n  }, function () {\n    return false;\n  });\n}; // Check if canvas.getContext('2d').getImageData can be used,\n// FireFox randomizes the output of that function in `privacy.resistFingerprinting` mode\n\n\nmodule.exports.can_use_canvas = function can_use_canvas(createCanvas) {\n  var usable = false;\n\n  try {\n    var canvas = createCanvas(2, 1);\n    var ctx = canvas.getContext('2d');\n    var d = ctx.createImageData(2, 1);\n    d.data[0] = 12;\n    d.data[1] = 23;\n    d.data[2] = 34;\n    d.data[3] = 255;\n    d.data[4] = 45;\n    d.data[5] = 56;\n    d.data[6] = 67;\n    d.data[7] = 255;\n    ctx.putImageData(d, 0, 0);\n    d = null;\n    d = ctx.getImageData(0, 0, 2, 1);\n\n    if (d.data[0] === 12 && d.data[1] === 23 && d.data[2] === 34 && d.data[3] === 255 && d.data[4] === 45 && d.data[5] === 56 && d.data[6] === 67 && d.data[7] === 255) {\n      usable = true;\n    }\n  } catch (err) {}\n\n  return usable;\n}; // Check if createImageBitmap(img, sx, sy, sw, sh) signature works correctly\n// with JPEG images oriented with Exif;\n// https://bugs.chromium.org/p/chromium/issues/detail?id=1220671\n// TODO: remove after it's fixed in chrome for at least 2 releases\n\n\nmodule.exports.cib_can_use_region = function cib_can_use_region() {\n  return new Promise(function (resolve) {\n    // `Image` check required for use in `ServiceWorker`\n    if (typeof Image === 'undefined' || typeof createImageBitmap === 'undefined') {\n      resolve(false);\n      return;\n    }\n\n    var image = new Image();\n    image.src = 'data:image/jpeg;base64,' + '/9j/4QBiRXhpZgAATU0AKgAAAAgABQESAAMAAAABAAYAAAEaAAUAAAABAAAASgEbAAUAA' + 'AABAAAAUgEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAAAAABIAAAAAQAAAEgAAAAB/9' + 'sAQwAEAwMEAwMEBAMEBQQEBQYKBwYGBgYNCQoICg8NEBAPDQ8OERMYFBESFxIODxUcFRc' + 'ZGRsbGxAUHR8dGh8YGhsa/9sAQwEEBQUGBQYMBwcMGhEPERoaGhoaGhoaGhoaGhoaGhoa' + 'GhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoa/8IAEQgAAQACAwERAAIRAQMRA' + 'f/EABQAAQAAAAAAAAAAAAAAAAAAAAf/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAA' + 'IQAxAAAAF/P//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAQUCf//EABQRAQAAAAA' + 'AAAAAAAAAAAAAAAD/2gAIAQMBAT8Bf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIB' + 'AT8Bf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEABj8Cf//EABQQAQAAAAAAAAAAA' + 'AAAAAAAAAD/2gAIAQEAAT8hf//aAAwDAQACAAMAAAAQH//EABQRAQAAAAAAAAAAAAAAAA' + 'AAAAD/2gAIAQMBAT8Qf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Qf//EABQ' + 'QAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8Qf//Z';\n\n    image.onload = function () {\n      createImageBitmap(image, 0, 0, image.width, image.height).then(function (bitmap) {\n        if (bitmap.width === image.width && bitmap.height === image.height) {\n          resolve(true);\n        } else {\n          resolve(false);\n        }\n      }, function () {\n        return resolve(false);\n      });\n    };\n\n    image.onerror = function () {\n      return resolve(false);\n    };\n  });\n};\n\n},{}],17:[function(_dereq_,module,exports){\n// Web Worker wrapper for image resize function\n'use strict';\n\nmodule.exports = function () {\n  var MathLib = _dereq_('./mathlib');\n\n  var mathLib;\n  /* eslint-disable no-undef */\n\n  onmessage = function onmessage(ev) {\n    var tileOpts = ev.data.opts;\n    var returnBitmap = false;\n\n    if (!tileOpts.src && tileOpts.srcBitmap) {\n      var canvas = new OffscreenCanvas(tileOpts.width, tileOpts.height);\n      var ctx = canvas.getContext('2d');\n      ctx.drawImage(tileOpts.srcBitmap, 0, 0);\n      tileOpts.src = ctx.getImageData(0, 0, tileOpts.width, tileOpts.height).data;\n      canvas.width = canvas.height = 0;\n      canvas = null;\n      tileOpts.srcBitmap.close();\n      tileOpts.srcBitmap = null; // Temporary force out data to typed array, because Chrome have artefacts\n      // https://github.com/nodeca/pica/issues/223\n      // returnBitmap = true;\n    }\n\n    if (!mathLib) mathLib = new MathLib(ev.data.features); // Use multimath's sync auto-init. Avoid Promise use in old browsers,\n    // because polyfills are not propagated to webworker.\n\n    var data = mathLib.resizeAndUnsharp(tileOpts);\n\n    if (returnBitmap) {\n      var toImageData = new ImageData(new Uint8ClampedArray(data), tileOpts.toWidth, tileOpts.toHeight);\n\n      var _canvas = new OffscreenCanvas(tileOpts.toWidth, tileOpts.toHeight);\n\n      var _ctx = _canvas.getContext('2d');\n\n      _ctx.putImageData(toImageData, 0, 0);\n\n      createImageBitmap(_canvas).then(function (bitmap) {\n        postMessage({\n          bitmap: bitmap\n        }, [bitmap]);\n      });\n    } else {\n      postMessage({\n        data: data\n      }, [data.buffer]);\n    }\n  };\n};\n\n},{\"./mathlib\":1}],18:[function(_dereq_,module,exports){\n// Calculate Gaussian blur of an image using IIR filter\n// The method is taken from Intel's white paper and code example attached to it:\n// https://software.intel.com/en-us/articles/iir-gaussian-blur-filter\n// -implementation-using-intel-advanced-vector-extensions\n\nvar a0, a1, a2, a3, b1, b2, left_corner, right_corner;\n\nfunction gaussCoef(sigma) {\n  if (sigma < 0.5) {\n    sigma = 0.5;\n  }\n\n  var a = Math.exp(0.726 * 0.726) / sigma,\n      g1 = Math.exp(-a),\n      g2 = Math.exp(-2 * a),\n      k = (1 - g1) * (1 - g1) / (1 + 2 * a * g1 - g2);\n\n  a0 = k;\n  a1 = k * (a - 1) * g1;\n  a2 = k * (a + 1) * g1;\n  a3 = -k * g2;\n  b1 = 2 * g1;\n  b2 = -g2;\n  left_corner = (a0 + a1) / (1 - b1 - b2);\n  right_corner = (a2 + a3) / (1 - b1 - b2);\n\n  // Attempt to force type to FP32.\n  return new Float32Array([ a0, a1, a2, a3, b1, b2, left_corner, right_corner ]);\n}\n\nfunction convolveMono16(src, out, line, coeff, width, height) {\n  // takes src image and writes the blurred and transposed result into out\n\n  var prev_src, curr_src, curr_out, prev_out, prev_prev_out;\n  var src_index, out_index, line_index;\n  var i, j;\n  var coeff_a0, coeff_a1, coeff_b1, coeff_b2;\n\n  for (i = 0; i < height; i++) {\n    src_index = i * width;\n    out_index = i;\n    line_index = 0;\n\n    // left to right\n    prev_src = src[src_index];\n    prev_prev_out = prev_src * coeff[6];\n    prev_out = prev_prev_out;\n\n    coeff_a0 = coeff[0];\n    coeff_a1 = coeff[1];\n    coeff_b1 = coeff[4];\n    coeff_b2 = coeff[5];\n\n    for (j = 0; j < width; j++) {\n      curr_src = src[src_index];\n\n      curr_out = curr_src * coeff_a0 +\n                 prev_src * coeff_a1 +\n                 prev_out * coeff_b1 +\n                 prev_prev_out * coeff_b2;\n\n      prev_prev_out = prev_out;\n      prev_out = curr_out;\n      prev_src = curr_src;\n\n      line[line_index] = prev_out;\n      line_index++;\n      src_index++;\n    }\n\n    src_index--;\n    line_index--;\n    out_index += height * (width - 1);\n\n    // right to left\n    prev_src = src[src_index];\n    prev_prev_out = prev_src * coeff[7];\n    prev_out = prev_prev_out;\n    curr_src = prev_src;\n\n    coeff_a0 = coeff[2];\n    coeff_a1 = coeff[3];\n\n    for (j = width - 1; j >= 0; j--) {\n      curr_out = curr_src * coeff_a0 +\n                 prev_src * coeff_a1 +\n                 prev_out * coeff_b1 +\n                 prev_prev_out * coeff_b2;\n\n      prev_prev_out = prev_out;\n      prev_out = curr_out;\n\n      prev_src = curr_src;\n      curr_src = src[src_index];\n\n      out[out_index] = line[line_index] + prev_out;\n\n      src_index--;\n      line_index--;\n      out_index -= height;\n    }\n  }\n}\n\n\nfunction blurMono16(src, width, height, radius) {\n  // Quick exit on zero radius\n  if (!radius) { return; }\n\n  var out      = new Uint16Array(src.length),\n      tmp_line = new Float32Array(Math.max(width, height));\n\n  var coeff = gaussCoef(radius);\n\n  convolveMono16(src, out, tmp_line, coeff, width, height, radius);\n  convolveMono16(out, src, tmp_line, coeff, height, width, radius);\n}\n\nmodule.exports = blurMono16;\n\n},{}],19:[function(_dereq_,module,exports){\n'use strict';\n\n\nvar assign         = _dereq_('object-assign');\nvar base64decode   = _dereq_('./lib/base64decode');\nvar hasWebAssembly = _dereq_('./lib/wa_detect');\n\n\nvar DEFAULT_OPTIONS = {\n  js: true,\n  wasm: true\n};\n\n\nfunction MultiMath(options) {\n  if (!(this instanceof MultiMath)) return new MultiMath(options);\n\n  var opts = assign({}, DEFAULT_OPTIONS, options || {});\n\n  this.options         = opts;\n\n  this.__cache         = {};\n\n  this.__init_promise  = null;\n  this.__modules       = opts.modules || {};\n  this.__memory        = null;\n  this.__wasm          = {};\n\n  this.__isLE = ((new Uint32Array((new Uint8Array([ 1, 0, 0, 0 ])).buffer))[0] === 1);\n\n  if (!this.options.js && !this.options.wasm) {\n    throw new Error('mathlib: at least \"js\" or \"wasm\" should be enabled');\n  }\n}\n\n\nMultiMath.prototype.has_wasm = hasWebAssembly;\n\n\nMultiMath.prototype.use = function (module) {\n  this.__modules[module.name] = module;\n\n  // Pin the best possible implementation\n  if (this.options.wasm && this.has_wasm() && module.wasm_fn) {\n    this[module.name] = module.wasm_fn;\n  } else {\n    this[module.name] = module.fn;\n  }\n\n  return this;\n};\n\n\nMultiMath.prototype.init = function () {\n  if (this.__init_promise) return this.__init_promise;\n\n  if (!this.options.js && this.options.wasm && !this.has_wasm()) {\n    return Promise.reject(new Error('mathlib: only \"wasm\" was enabled, but it\\'s not supported'));\n  }\n\n  var self = this;\n\n  this.__init_promise = Promise.all(Object.keys(self.__modules).map(function (name) {\n    var module = self.__modules[name];\n\n    if (!self.options.wasm || !self.has_wasm() || !module.wasm_fn) return null;\n\n    // If already compiled - exit\n    if (self.__wasm[name]) return null;\n\n    // Compile wasm source\n    return WebAssembly.compile(self.__base64decode(module.wasm_src))\n      .then(function (m) { self.__wasm[name] = m; });\n  }))\n    .then(function () { return self; });\n\n  return this.__init_promise;\n};\n\n\n////////////////////////////////////////////////////////////////////////////////\n// Methods below are for internal use from plugins\n\n\n// Simple decode base64 to typed array. Useful to load embedded webassembly\n// code. You probably don't need to call this method directly.\n//\nMultiMath.prototype.__base64decode = base64decode;\n\n\n// Increase current memory to include specified number of bytes. Do nothing if\n// size is already ok. You probably don't need to call this method directly,\n// because it will be invoked from `.__instance()`.\n//\nMultiMath.prototype.__reallocate = function mem_grow_to(bytes) {\n  if (!this.__memory) {\n    this.__memory = new WebAssembly.Memory({\n      initial: Math.ceil(bytes / (64 * 1024))\n    });\n    return this.__memory;\n  }\n\n  var mem_size = this.__memory.buffer.byteLength;\n\n  if (mem_size < bytes) {\n    this.__memory.grow(Math.ceil((bytes - mem_size) / (64 * 1024)));\n  }\n\n  return this.__memory;\n};\n\n\n// Returns instantinated webassembly item by name, with specified memory size\n// and environment.\n// - use cache if available\n// - do sync module init, if async init was not called earlier\n// - allocate memory if not enougth\n// - can export functions to webassembly via \"env_extra\",\n//   for example, { exp: Math.exp }\n//\nMultiMath.prototype.__instance = function instance(name, memsize, env_extra) {\n  if (memsize) this.__reallocate(memsize);\n\n  // If .init() was not called, do sync compile\n  if (!this.__wasm[name]) {\n    var module = this.__modules[name];\n    this.__wasm[name] = new WebAssembly.Module(this.__base64decode(module.wasm_src));\n  }\n\n  if (!this.__cache[name]) {\n    var env_base = {\n      memoryBase: 0,\n      memory: this.__memory,\n      tableBase: 0,\n      table: new WebAssembly.Table({ initial: 0, element: 'anyfunc' })\n    };\n\n    this.__cache[name] = new WebAssembly.Instance(this.__wasm[name], {\n      env: assign(env_base, env_extra || {})\n    });\n  }\n\n  return this.__cache[name];\n};\n\n\n// Helper to calculate memory aligh for pointers. Webassembly does not require\n// this, but you may wish to experiment. Default base = 8;\n//\nMultiMath.prototype.__align = function align(number, base) {\n  base = base || 8;\n  var reminder = number % base;\n  return number + (reminder ? base - reminder : 0);\n};\n\n\nmodule.exports = MultiMath;\n\n},{\"./lib/base64decode\":20,\"./lib/wa_detect\":21,\"object-assign\":22}],20:[function(_dereq_,module,exports){\n// base64 decode str -> Uint8Array, to load WA modules\n//\n'use strict';\n\n\nvar BASE64_MAP = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\n\nmodule.exports = function base64decode(str) {\n  var input = str.replace(/[\\r\\n=]/g, ''), // remove CR/LF & padding to simplify scan\n      max   = input.length;\n\n  var out = new Uint8Array((max * 3) >> 2);\n\n  // Collect by 6*4 bits (3 bytes)\n\n  var bits = 0;\n  var ptr  = 0;\n\n  for (var idx = 0; idx < max; idx++) {\n    if ((idx % 4 === 0) && idx) {\n      out[ptr++] = (bits >> 16) & 0xFF;\n      out[ptr++] = (bits >> 8) & 0xFF;\n      out[ptr++] = bits & 0xFF;\n    }\n\n    bits = (bits << 6) | BASE64_MAP.indexOf(input.charAt(idx));\n  }\n\n  // Dump tail\n\n  var tailbits = (max % 4) * 6;\n\n  if (tailbits === 0) {\n    out[ptr++] = (bits >> 16) & 0xFF;\n    out[ptr++] = (bits >> 8) & 0xFF;\n    out[ptr++] = bits & 0xFF;\n  } else if (tailbits === 18) {\n    out[ptr++] = (bits >> 10) & 0xFF;\n    out[ptr++] = (bits >> 2) & 0xFF;\n  } else if (tailbits === 12) {\n    out[ptr++] = (bits >> 4) & 0xFF;\n  }\n\n  return out;\n};\n\n},{}],21:[function(_dereq_,module,exports){\n// Detect WebAssembly support.\n// - Check global WebAssembly object\n// - Try to load simple module (can be disabled via CSP)\n//\n'use strict';\n\n\nvar wa;\n\n\nmodule.exports = function hasWebAssembly() {\n  // use cache if called before;\n  if (typeof wa !== 'undefined') return wa;\n\n  wa = false;\n\n  if (typeof WebAssembly === 'undefined') return wa;\n\n  // If WebAssenbly is disabled, code can throw on compile\n  try {\n    // https://github.com/brion/min-wasm-fail/blob/master/min-wasm-fail.in.js\n    // Additional check that WA internals are correct\n\n    /* eslint-disable comma-spacing, max-len */\n    var bin      = new Uint8Array([ 0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11 ]);\n    var module   = new WebAssembly.Module(bin);\n    var instance = new WebAssembly.Instance(module, {});\n\n    // test storing to and loading from a non-zero location via a parameter.\n    // Safari on iOS 11.2.5 returns 0 unexpectedly at non-zero locations\n    if (instance.exports.test(4) !== 0) wa = true;\n\n    return wa;\n  } catch (__) {}\n\n  return wa;\n};\n\n},{}],22:[function(_dereq_,module,exports){\n/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n\n},{}],23:[function(_dereq_,module,exports){\nvar bundleFn = arguments[3];\nvar sources = arguments[4];\nvar cache = arguments[5];\n\nvar stringify = JSON.stringify;\n\nmodule.exports = function (fn, options) {\n    var wkey;\n    var cacheKeys = Object.keys(cache);\n\n    for (var i = 0, l = cacheKeys.length; i < l; i++) {\n        var key = cacheKeys[i];\n        var exp = cache[key].exports;\n        // Using babel as a transpiler to use esmodule, the export will always\n        // be an object with the default export as a property of it. To ensure\n        // the existing api and babel esmodule exports are both supported we\n        // check for both\n        if (exp === fn || exp && exp.default === fn) {\n            wkey = key;\n            break;\n        }\n    }\n\n    if (!wkey) {\n        wkey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n        var wcache = {};\n        for (var i = 0, l = cacheKeys.length; i < l; i++) {\n            var key = cacheKeys[i];\n            wcache[key] = key;\n        }\n        sources[wkey] = [\n            'function(require,module,exports){' + fn + '(self); }',\n            wcache\n        ];\n    }\n    var skey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n\n    var scache = {}; scache[wkey] = wkey;\n    sources[skey] = [\n        'function(require,module,exports){' +\n            // try to call default if defined to also support babel esmodule exports\n            'var f = require(' + stringify(wkey) + ');' +\n            '(f.default ? f.default : f)(self);' +\n        '}',\n        scache\n    ];\n\n    var workerSources = {};\n    resolveSources(skey);\n\n    function resolveSources(key) {\n        workerSources[key] = true;\n\n        for (var depPath in sources[key][1]) {\n            var depKey = sources[key][1][depPath];\n            if (!workerSources[depKey]) {\n                resolveSources(depKey);\n            }\n        }\n    }\n\n    var src = '(' + bundleFn + ')({'\n        + Object.keys(workerSources).map(function (key) {\n            return stringify(key) + ':['\n                + sources[key][0]\n                + ',' + stringify(sources[key][1]) + ']'\n            ;\n        }).join(',')\n        + '},{},[' + stringify(skey) + '])'\n    ;\n\n    var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n    var blob = new Blob([src], { type: 'text/javascript' });\n    if (options && options.bare) { return blob; }\n    var workerUrl = URL.createObjectURL(blob);\n    var worker = new Worker(workerUrl);\n    worker.objectURL = workerUrl;\n    return worker;\n};\n\n},{}],\"/index.js\":[function(_dereq_,module,exports){\n'use strict';\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nvar assign = _dereq_('object-assign');\n\nvar webworkify = _dereq_('webworkify');\n\nvar MathLib = _dereq_('./lib/mathlib');\n\nvar Pool = _dereq_('./lib/pool');\n\nvar utils = _dereq_('./lib/utils');\n\nvar worker = _dereq_('./lib/worker');\n\nvar createStages = _dereq_('./lib/stepper');\n\nvar createRegions = _dereq_('./lib/tiler');\n\nvar filter_info = _dereq_('./lib/mm_resize/resize_filter_info'); // Deduplicate pools & limiters with the same configs\n// when user creates multiple pica instances.\n\n\nvar singletones = {};\nvar NEED_SAFARI_FIX = false;\n\ntry {\n  if (typeof navigator !== 'undefined' && navigator.userAgent) {\n    NEED_SAFARI_FIX = navigator.userAgent.indexOf('Safari') >= 0;\n  }\n} catch (e) {}\n\nvar concurrency = 1;\n\nif (typeof navigator !== 'undefined') {\n  concurrency = Math.min(navigator.hardwareConcurrency || 1, 4);\n}\n\nvar DEFAULT_PICA_OPTS = {\n  tile: 1024,\n  concurrency: concurrency,\n  features: ['js', 'wasm', 'ww'],\n  idle: 2000,\n  createCanvas: function createCanvas(width, height) {\n    var tmpCanvas = document.createElement('canvas');\n    tmpCanvas.width = width;\n    tmpCanvas.height = height;\n    return tmpCanvas;\n  }\n};\nvar DEFAULT_RESIZE_OPTS = {\n  filter: 'mks2013',\n  unsharpAmount: 0,\n  unsharpRadius: 0.0,\n  unsharpThreshold: 0\n};\nvar CAN_NEW_IMAGE_DATA = false;\nvar CAN_CREATE_IMAGE_BITMAP = false;\nvar CAN_USE_CANVAS_GET_IMAGE_DATA = false;\nvar CAN_USE_OFFSCREEN_CANVAS = false;\nvar CAN_USE_CIB_REGION_FOR_IMAGE = false;\n\nfunction workerFabric() {\n  return {\n    value: webworkify(worker),\n    destroy: function destroy() {\n      this.value.terminate();\n\n      if (typeof window !== 'undefined') {\n        var url = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n        if (url && url.revokeObjectURL && this.value.objectURL) {\n          url.revokeObjectURL(this.value.objectURL);\n        }\n      }\n    }\n  };\n} ////////////////////////////////////////////////////////////////////////////////\n// API methods\n\n\nfunction Pica(options) {\n  if (!(this instanceof Pica)) return new Pica(options);\n  this.options = assign({}, DEFAULT_PICA_OPTS, options || {});\n  var limiter_key = \"lk_\".concat(this.options.concurrency); // Share limiters to avoid multiple parallel workers when user creates\n  // multiple pica instances.\n\n  this.__limit = singletones[limiter_key] || utils.limiter(this.options.concurrency);\n  if (!singletones[limiter_key]) singletones[limiter_key] = this.__limit; // List of supported features, according to options & browser/node.js\n\n  this.features = {\n    js: false,\n    // pure JS implementation, can be disabled for testing\n    wasm: false,\n    // webassembly implementation for heavy functions\n    cib: false,\n    // resize via createImageBitmap (only FF at this moment)\n    ww: false // webworkers\n\n  };\n  this.__workersPool = null; // Store requested features for webworkers\n\n  this.__requested_features = [];\n  this.__mathlib = null;\n}\n\nPica.prototype.init = function () {\n  var _this = this;\n\n  if (this.__initPromise) return this.__initPromise; // Test if we can create ImageData without canvas and memory copy\n\n  if (typeof ImageData !== 'undefined' && typeof Uint8ClampedArray !== 'undefined') {\n    try {\n      /* eslint-disable no-new */\n      new ImageData(new Uint8ClampedArray(400), 10, 10);\n      CAN_NEW_IMAGE_DATA = true;\n    } catch (__) {}\n  } // ImageBitmap can be effective in 2 places:\n  //\n  // 1. Threaded jpeg unpack (basic)\n  // 2. Built-in resize (blocked due problem in chrome, see issue #89)\n  //\n  // For basic use we also need ImageBitmap wo support .close() method,\n  // see https://developer.mozilla.org/ru/docs/Web/API/ImageBitmap\n\n\n  if (typeof ImageBitmap !== 'undefined') {\n    if (ImageBitmap.prototype && ImageBitmap.prototype.close) {\n      CAN_CREATE_IMAGE_BITMAP = true;\n    } else {\n      this.debug('ImageBitmap does not support .close(), disabled');\n    }\n  }\n\n  var features = this.options.features.slice();\n\n  if (features.indexOf('all') >= 0) {\n    features = ['cib', 'wasm', 'js', 'ww'];\n  }\n\n  this.__requested_features = features;\n  this.__mathlib = new MathLib(features); // Check WebWorker support if requested\n\n  if (features.indexOf('ww') >= 0) {\n    if (typeof window !== 'undefined' && 'Worker' in window) {\n      // IE <= 11 don't allow to create webworkers from string. We should check it.\n      // https://connect.microsoft.com/IE/feedback/details/801810/web-workers-from-blob-urls-in-ie-10-and-11\n      try {\n        var wkr = _dereq_('webworkify')(function () {});\n\n        wkr.terminate();\n        this.features.ww = true; // pool uniqueness depends on pool config + webworker config\n\n        var wpool_key = \"wp_\".concat(JSON.stringify(this.options));\n\n        if (singletones[wpool_key]) {\n          this.__workersPool = singletones[wpool_key];\n        } else {\n          this.__workersPool = new Pool(workerFabric, this.options.idle);\n          singletones[wpool_key] = this.__workersPool;\n        }\n      } catch (__) {}\n    }\n  }\n\n  var initMath = this.__mathlib.init().then(function (mathlib) {\n    // Copy detected features\n    assign(_this.features, mathlib.features);\n  });\n\n  var checkCibResize;\n\n  if (!CAN_CREATE_IMAGE_BITMAP) {\n    checkCibResize = Promise.resolve(false);\n  } else {\n    checkCibResize = utils.cib_support(this.options.createCanvas).then(function (status) {\n      if (_this.features.cib && features.indexOf('cib') < 0) {\n        _this.debug('createImageBitmap() resize supported, but disabled by config');\n\n        return;\n      }\n\n      if (features.indexOf('cib') >= 0) _this.features.cib = status;\n    });\n  }\n\n  CAN_USE_CANVAS_GET_IMAGE_DATA = utils.can_use_canvas(this.options.createCanvas);\n  var checkOffscreenCanvas;\n\n  if (CAN_CREATE_IMAGE_BITMAP && CAN_NEW_IMAGE_DATA && features.indexOf('ww') !== -1) {\n    checkOffscreenCanvas = utils.worker_offscreen_canvas_support();\n  } else {\n    checkOffscreenCanvas = Promise.resolve(false);\n  }\n\n  checkOffscreenCanvas = checkOffscreenCanvas.then(function (result) {\n    CAN_USE_OFFSCREEN_CANVAS = result;\n  }); // we use createImageBitmap to crop image data and pass it to workers,\n  // so need to check whether function works correctly;\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=1220671\n\n  var checkCibRegion = utils.cib_can_use_region().then(function (result) {\n    CAN_USE_CIB_REGION_FOR_IMAGE = result;\n  }); // Init math lib. That's async because can load some\n\n  this.__initPromise = Promise.all([initMath, checkCibResize, checkOffscreenCanvas, checkCibRegion]).then(function () {\n    return _this;\n  });\n  return this.__initPromise;\n}; // Call resizer in webworker or locally, depending on config\n\n\nPica.prototype.__invokeResize = function (tileOpts, opts) {\n  var _this2 = this;\n\n  // Share cache between calls:\n  //\n  // - wasm instance\n  // - wasm memory object\n  //\n  opts.__mathCache = opts.__mathCache || {};\n  return Promise.resolve().then(function () {\n    if (!_this2.features.ww) {\n      // not possible to have ImageBitmap here if user disabled WW\n      return {\n        data: _this2.__mathlib.resizeAndUnsharp(tileOpts, opts.__mathCache)\n      };\n    }\n\n    return new Promise(function (resolve, reject) {\n      var w = _this2.__workersPool.acquire();\n\n      if (opts.cancelToken) opts.cancelToken[\"catch\"](function (err) {\n        return reject(err);\n      });\n\n      w.value.onmessage = function (ev) {\n        w.release();\n        if (ev.data.err) reject(ev.data.err);else resolve(ev.data);\n      };\n\n      var transfer = [];\n      if (tileOpts.src) transfer.push(tileOpts.src.buffer);\n      if (tileOpts.srcBitmap) transfer.push(tileOpts.srcBitmap);\n      w.value.postMessage({\n        opts: tileOpts,\n        features: _this2.__requested_features,\n        preload: {\n          wasm_nodule: _this2.__mathlib.__\n        }\n      }, transfer);\n    });\n  });\n}; // this function can return promise if createImageBitmap is used\n\n\nPica.prototype.__extractTileData = function (tile, from, opts, stageEnv, extractTo) {\n  if (this.features.ww && CAN_USE_OFFSCREEN_CANVAS && ( // createImageBitmap doesn't work for images (Image, ImageBitmap) with Exif orientation in Chrome,\n  // can use canvas because canvas doesn't have orientation;\n  // see https://bugs.chromium.org/p/chromium/issues/detail?id=1220671\n  utils.isCanvas(from) || CAN_USE_CIB_REGION_FOR_IMAGE)) {\n    this.debug('Create tile for OffscreenCanvas');\n    return createImageBitmap(stageEnv.srcImageBitmap || from, tile.x, tile.y, tile.width, tile.height).then(function (bitmap) {\n      extractTo.srcBitmap = bitmap;\n      return extractTo;\n    });\n  } // Extract tile RGBA buffer, depending on input type\n\n\n  if (utils.isCanvas(from)) {\n    if (!stageEnv.srcCtx) stageEnv.srcCtx = from.getContext('2d'); // If input is Canvas - extract region data directly\n\n    this.debug('Get tile pixel data');\n    extractTo.src = stageEnv.srcCtx.getImageData(tile.x, tile.y, tile.width, tile.height).data;\n    return extractTo;\n  } // If input is Image or decoded to ImageBitmap,\n  // draw region to temporary canvas and extract data from it\n  //\n  // Note! Attempt to reuse this canvas causes significant slowdown in chrome\n  //\n\n\n  this.debug('Draw tile imageBitmap/image to temporary canvas');\n  var tmpCanvas = this.options.createCanvas(tile.width, tile.height);\n  var tmpCtx = tmpCanvas.getContext('2d');\n  tmpCtx.globalCompositeOperation = 'copy';\n  tmpCtx.drawImage(stageEnv.srcImageBitmap || from, tile.x, tile.y, tile.width, tile.height, 0, 0, tile.width, tile.height);\n  this.debug('Get tile pixel data');\n  extractTo.src = tmpCtx.getImageData(0, 0, tile.width, tile.height).data; // Safari 12 workaround\n  // https://github.com/nodeca/pica/issues/199\n\n  tmpCanvas.width = tmpCanvas.height = 0;\n  return extractTo;\n};\n\nPica.prototype.__landTileData = function (tile, result, stageEnv) {\n  var toImageData;\n  this.debug('Convert raw rgba tile result to ImageData');\n\n  if (result.bitmap) {\n    stageEnv.toCtx.drawImage(result.bitmap, tile.toX, tile.toY);\n    return null;\n  }\n\n  if (CAN_NEW_IMAGE_DATA) {\n    // this branch is for modern browsers\n    // If `new ImageData()` & Uint8ClampedArray suported\n    toImageData = new ImageData(new Uint8ClampedArray(result.data), tile.toWidth, tile.toHeight);\n  } else {\n    // fallback for `node-canvas` and old browsers\n    // (IE11 has ImageData but does not support `new ImageData()`)\n    toImageData = stageEnv.toCtx.createImageData(tile.toWidth, tile.toHeight);\n\n    if (toImageData.data.set) {\n      toImageData.data.set(result.data);\n    } else {\n      // IE9 don't have `.set()`\n      for (var i = toImageData.data.length - 1; i >= 0; i--) {\n        toImageData.data[i] = result.data[i];\n      }\n    }\n  }\n\n  this.debug('Draw tile');\n\n  if (NEED_SAFARI_FIX) {\n    // Safari draws thin white stripes between tiles without this fix\n    stageEnv.toCtx.putImageData(toImageData, tile.toX, tile.toY, tile.toInnerX - tile.toX, tile.toInnerY - tile.toY, tile.toInnerWidth + 1e-5, tile.toInnerHeight + 1e-5);\n  } else {\n    stageEnv.toCtx.putImageData(toImageData, tile.toX, tile.toY, tile.toInnerX - tile.toX, tile.toInnerY - tile.toY, tile.toInnerWidth, tile.toInnerHeight);\n  }\n\n  return null;\n};\n\nPica.prototype.__tileAndResize = function (from, to, opts) {\n  var _this3 = this;\n\n  var stageEnv = {\n    srcCtx: null,\n    srcImageBitmap: null,\n    isImageBitmapReused: false,\n    toCtx: null\n  };\n\n  var processTile = function processTile(tile) {\n    return _this3.__limit(function () {\n      if (opts.canceled) return opts.cancelToken;\n      var tileOpts = {\n        width: tile.width,\n        height: tile.height,\n        toWidth: tile.toWidth,\n        toHeight: tile.toHeight,\n        scaleX: tile.scaleX,\n        scaleY: tile.scaleY,\n        offsetX: tile.offsetX,\n        offsetY: tile.offsetY,\n        filter: opts.filter,\n        unsharpAmount: opts.unsharpAmount,\n        unsharpRadius: opts.unsharpRadius,\n        unsharpThreshold: opts.unsharpThreshold\n      };\n\n      _this3.debug('Invoke resize math');\n\n      return Promise.resolve(tileOpts).then(function (tileOpts) {\n        return _this3.__extractTileData(tile, from, opts, stageEnv, tileOpts);\n      }).then(function (tileOpts) {\n        _this3.debug('Invoke resize math');\n\n        return _this3.__invokeResize(tileOpts, opts);\n      }).then(function (result) {\n        if (opts.canceled) return opts.cancelToken;\n        stageEnv.srcImageData = null;\n        return _this3.__landTileData(tile, result, stageEnv);\n      });\n    });\n  }; // Need to normalize data source first. It can be canvas or image.\n  // If image - try to decode in background if possible\n\n\n  return Promise.resolve().then(function () {\n    stageEnv.toCtx = to.getContext('2d');\n    if (utils.isCanvas(from)) return null;\n\n    if (utils.isImageBitmap(from)) {\n      stageEnv.srcImageBitmap = from;\n      stageEnv.isImageBitmapReused = true;\n      return null;\n    }\n\n    if (utils.isImage(from)) {\n      // try do decode image in background for faster next operations;\n      // if we're using offscreen canvas, cib is called per tile, so not needed here\n      if (!CAN_CREATE_IMAGE_BITMAP) return null;\n\n      _this3.debug('Decode image via createImageBitmap');\n\n      return createImageBitmap(from).then(function (imageBitmap) {\n        stageEnv.srcImageBitmap = imageBitmap;\n      }) // Suppress error to use fallback, if method fails\n      // https://github.com/nodeca/pica/issues/190\n\n      /* eslint-disable no-unused-vars */\n      [\"catch\"](function (e) {\n        return null;\n      });\n    }\n\n    throw new Error('Pica: \".from\" should be Image, Canvas or ImageBitmap');\n  }).then(function () {\n    if (opts.canceled) return opts.cancelToken;\n\n    _this3.debug('Calculate tiles'); //\n    // Here we are with \"normalized\" source,\n    // follow to tiling\n    //\n\n\n    var regions = createRegions({\n      width: opts.width,\n      height: opts.height,\n      srcTileSize: _this3.options.tile,\n      toWidth: opts.toWidth,\n      toHeight: opts.toHeight,\n      destTileBorder: opts.__destTileBorder\n    });\n    var jobs = regions.map(function (tile) {\n      return processTile(tile);\n    });\n\n    function cleanup(stageEnv) {\n      if (stageEnv.srcImageBitmap) {\n        if (!stageEnv.isImageBitmapReused) stageEnv.srcImageBitmap.close();\n        stageEnv.srcImageBitmap = null;\n      }\n    }\n\n    _this3.debug('Process tiles');\n\n    return Promise.all(jobs).then(function () {\n      _this3.debug('Finished!');\n\n      cleanup(stageEnv);\n      return to;\n    }, function (err) {\n      cleanup(stageEnv);\n      throw err;\n    });\n  });\n};\n\nPica.prototype.__processStages = function (stages, from, to, opts) {\n  var _this4 = this;\n\n  if (opts.canceled) return opts.cancelToken;\n\n  var _stages$shift = stages.shift(),\n      _stages$shift2 = _slicedToArray(_stages$shift, 2),\n      toWidth = _stages$shift2[0],\n      toHeight = _stages$shift2[1];\n\n  var isLastStage = stages.length === 0; // Optimization for legacy filters -\n  // only use user-defined quality for the last stage,\n  // use simpler (Hamming) filter for the first stages where\n  // scale factor is large enough (more than 2-3)\n  //\n  // For advanced filters (mks2013 and custom) - skip optimization,\n  // because need to apply sharpening every time\n\n  var filter;\n  if (isLastStage || filter_info.q2f.indexOf(opts.filter) < 0) filter = opts.filter;else if (opts.filter === 'box') filter = 'box';else filter = 'hamming';\n  opts = assign({}, opts, {\n    toWidth: toWidth,\n    toHeight: toHeight,\n    filter: filter\n  });\n  var tmpCanvas;\n\n  if (!isLastStage) {\n    // create temporary canvas\n    tmpCanvas = this.options.createCanvas(toWidth, toHeight);\n  }\n\n  return this.__tileAndResize(from, isLastStage ? to : tmpCanvas, opts).then(function () {\n    if (isLastStage) return to;\n    opts.width = toWidth;\n    opts.height = toHeight;\n    return _this4.__processStages(stages, tmpCanvas, to, opts);\n  }).then(function (res) {\n    if (tmpCanvas) {\n      // Safari 12 workaround\n      // https://github.com/nodeca/pica/issues/199\n      tmpCanvas.width = tmpCanvas.height = 0;\n    }\n\n    return res;\n  });\n};\n\nPica.prototype.__resizeViaCreateImageBitmap = function (from, to, opts) {\n  var _this5 = this;\n\n  var toCtx = to.getContext('2d');\n  this.debug('Resize via createImageBitmap()');\n  return createImageBitmap(from, {\n    resizeWidth: opts.toWidth,\n    resizeHeight: opts.toHeight,\n    resizeQuality: utils.cib_quality_name(filter_info.f2q[opts.filter])\n  }).then(function (imageBitmap) {\n    if (opts.canceled) return opts.cancelToken; // if no unsharp - draw directly to output canvas\n\n    if (!opts.unsharpAmount) {\n      toCtx.drawImage(imageBitmap, 0, 0);\n      imageBitmap.close();\n      toCtx = null;\n\n      _this5.debug('Finished!');\n\n      return to;\n    }\n\n    _this5.debug('Unsharp result');\n\n    var tmpCanvas = _this5.options.createCanvas(opts.toWidth, opts.toHeight);\n\n    var tmpCtx = tmpCanvas.getContext('2d');\n    tmpCtx.drawImage(imageBitmap, 0, 0);\n    imageBitmap.close();\n    var iData = tmpCtx.getImageData(0, 0, opts.toWidth, opts.toHeight);\n\n    _this5.__mathlib.unsharp_mask(iData.data, opts.toWidth, opts.toHeight, opts.unsharpAmount, opts.unsharpRadius, opts.unsharpThreshold);\n\n    toCtx.putImageData(iData, 0, 0); // Safari 12 workaround\n    // https://github.com/nodeca/pica/issues/199\n\n    tmpCanvas.width = tmpCanvas.height = 0;\n    iData = tmpCtx = tmpCanvas = toCtx = null;\n\n    _this5.debug('Finished!');\n\n    return to;\n  });\n};\n\nPica.prototype.resize = function (from, to, options) {\n  var _this6 = this;\n\n  this.debug('Start resize...');\n  var opts = assign({}, DEFAULT_RESIZE_OPTS);\n\n  if (!isNaN(options)) {\n    opts = assign(opts, {\n      quality: options\n    });\n  } else if (options) {\n    opts = assign(opts, options);\n  }\n\n  opts.toWidth = to.width;\n  opts.toHeight = to.height;\n  opts.width = from.naturalWidth || from.width;\n  opts.height = from.naturalHeight || from.height; // Legacy `.quality` option\n\n  if (Object.prototype.hasOwnProperty.call(opts, 'quality')) {\n    if (opts.quality < 0 || opts.quality > 3) {\n      throw new Error(\"Pica: .quality should be [0..3], got \".concat(opts.quality));\n    }\n\n    opts.filter = filter_info.q2f[opts.quality];\n  } // Prevent stepper from infinite loop\n\n\n  if (to.width === 0 || to.height === 0) {\n    return Promise.reject(new Error(\"Invalid output size: \".concat(to.width, \"x\").concat(to.height)));\n  }\n\n  if (opts.unsharpRadius > 2) opts.unsharpRadius = 2;\n  opts.canceled = false;\n\n  if (opts.cancelToken) {\n    // Wrap cancelToken to avoid successive resolve & set flag\n    opts.cancelToken = opts.cancelToken.then(function (data) {\n      opts.canceled = true;\n      throw data;\n    }, function (err) {\n      opts.canceled = true;\n      throw err;\n    });\n  }\n\n  var DEST_TILE_BORDER = 3; // Max possible filter window size\n\n  opts.__destTileBorder = Math.ceil(Math.max(DEST_TILE_BORDER, 2.5 * opts.unsharpRadius | 0));\n  return this.init().then(function () {\n    if (opts.canceled) return opts.cancelToken; // if createImageBitmap supports resize, just do it and return\n\n    if (_this6.features.cib) {\n      if (filter_info.q2f.indexOf(opts.filter) >= 0) {\n        return _this6.__resizeViaCreateImageBitmap(from, to, opts);\n      }\n\n      _this6.debug('cib is enabled, but not supports provided filter, fallback to manual math');\n    }\n\n    if (!CAN_USE_CANVAS_GET_IMAGE_DATA) {\n      var err = new Error('Pica: cannot use getImageData on canvas, ' + \"make sure fingerprinting protection isn't enabled\");\n      err.code = 'ERR_GET_IMAGE_DATA';\n      throw err;\n    } //\n    // No easy way, let's resize manually via arrays\n    //\n\n\n    var stages = createStages(opts.width, opts.height, opts.toWidth, opts.toHeight, _this6.options.tile, opts.__destTileBorder);\n    return _this6.__processStages(stages, from, to, opts);\n  });\n}; // RGBA buffer resize\n//\n\n\nPica.prototype.resizeBuffer = function (options) {\n  var _this7 = this;\n\n  var opts = assign({}, DEFAULT_RESIZE_OPTS, options); // Legacy `.quality` option\n\n  if (Object.prototype.hasOwnProperty.call(opts, 'quality')) {\n    if (opts.quality < 0 || opts.quality > 3) {\n      throw new Error(\"Pica: .quality should be [0..3], got \".concat(opts.quality));\n    }\n\n    opts.filter = filter_info.q2f[opts.quality];\n  }\n\n  return this.init().then(function () {\n    return _this7.__mathlib.resizeAndUnsharp(opts);\n  });\n};\n\nPica.prototype.toBlob = function (canvas, mimeType, quality) {\n  mimeType = mimeType || 'image/png';\n  return new Promise(function (resolve) {\n    if (canvas.toBlob) {\n      canvas.toBlob(function (blob) {\n        return resolve(blob);\n      }, mimeType, quality);\n      return;\n    }\n\n    if (canvas.convertToBlob) {\n      resolve(canvas.convertToBlob({\n        type: mimeType,\n        quality: quality\n      }));\n      return;\n    } // Fallback for old browsers\n\n\n    var asString = atob(canvas.toDataURL(mimeType, quality).split(',')[1]);\n    var len = asString.length;\n    var asBuffer = new Uint8Array(len);\n\n    for (var i = 0; i < len; i++) {\n      asBuffer[i] = asString.charCodeAt(i);\n    }\n\n    resolve(new Blob([asBuffer], {\n      type: mimeType\n    }));\n  });\n};\n\nPica.prototype.debug = function () {};\n\nmodule.exports = Pica;\n\n},{\"./lib/mathlib\":1,\"./lib/mm_resize/resize_filter_info\":7,\"./lib/pool\":13,\"./lib/stepper\":14,\"./lib/tiler\":15,\"./lib/utils\":16,\"./lib/worker\":17,\"object-assign\":22,\"webworkify\":23}]},{},[])(\"/index.js\")\n});\n"],"names":["module","exports","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread2","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","_typeof","obj","Symbol","iterator","constructor","prototype","_classCallCheck","instance","Constructor","TypeError","_defineProperties","props","descriptor","configurable","writable","value","_toConsumableArray","arr","Array","isArray","_arrayLikeToArray","_arrayWithoutHoles","iter","from","_iterableToArray","o","minLen","n","toString","call","slice","name","test","_unsupportedIterableToArray","_nonIterableSpread","len","arr2","IS_BROWSER","window","document","WINDOW","IS_TOUCH_DEVICE","documentElement","HAS_POINTER_EVENT","NAMESPACE","ACTION_ALL","ACTION_CROP","ACTION_MOVE","ACTION_ZOOM","ACTION_EAST","ACTION_WEST","ACTION_SOUTH","ACTION_NORTH","ACTION_NORTH_EAST","ACTION_NORTH_WEST","ACTION_SOUTH_EAST","ACTION_SOUTH_WEST","CLASS_CROP","concat","CLASS_DISABLED","CLASS_HIDDEN","CLASS_HIDE","CLASS_INVISIBLE","CLASS_MODAL","CLASS_MOVE","DATA_ACTION","DATA_PREVIEW","DRAG_MODE_CROP","DRAG_MODE_MOVE","DRAG_MODE_NONE","EVENT_CROP","EVENT_CROP_END","EVENT_CROP_MOVE","EVENT_CROP_START","EVENT_DBLCLICK","EVENT_POINTER_DOWN","EVENT_POINTER_MOVE","EVENT_POINTER_UP","EVENT_READY","EVENT_RESIZE","EVENT_WHEEL","EVENT_ZOOM","MIME_TYPE_JPEG","REGEXP_ACTIONS","REGEXP_DATA_URL","REGEXP_DATA_URL_JPEG","REGEXP_TAG_NAME","DEFAULTS","viewMode","dragMode","initialAspectRatio","NaN","aspectRatio","data","preview","responsive","restore","checkCrossOrigin","checkOrientation","modal","guides","center","highlight","background","autoCrop","autoCropArea","movable","rotatable","scalable","zoomable","zoomOnTouch","zoomOnWheel","wheelZoomRatio","cropBoxMovable","cropBoxResizable","toggleDragModeOnDblclick","minCanvasWidth","minCanvasHeight","minCropBoxWidth","minCropBoxHeight","minContainerWidth","minContainerHeight","ready","cropstart","cropmove","cropend","crop","zoom","isNaN","Number","isNumber","isPositiveNumber","Infinity","isUndefined","isObject","hasOwnProperty","isPlainObject","_constructor","error","isFunction","toArray","callback","assign","_len","args","_key","arg","REGEXP_DECIMALS","normalizeDecimalNumber","times","undefined","Math","round","REGEXP_SUFFIX","setStyle","element","styles","style","property","addClass","elem","classList","add","className","trim","indexOf","removeClass","remove","replace","toggleClass","added","REGEXP_CAMEL_CASE","toParamCase","toLowerCase","getData","dataset","getAttribute","setData","setAttribute","REGEXP_SPACES","onceSupported","supported","once","listener","options","get","set","addEventListener","removeEventListener","removeListener","type","handler","split","event","listeners","addListener","_handler","_element$listeners","_len2","_key2","dispatchEvent","Event","CustomEvent","detail","bubbles","cancelable","createEvent","initCustomEvent","getOffset","box","getBoundingClientRect","left","pageXOffset","clientLeft","top","pageYOffset","clientTop","location","REGEXP_ORIGINS","isCrossOriginURL","url","parts","match","protocol","hostname","port","addTimestamp","timestamp","Date","getTime","getTransforms","_ref","rotate","scaleX","scaleY","translateX","translateY","values","transform","join","WebkitTransform","msTransform","getPointer","_ref2","endOnly","pageX","pageY","end","endX","endY","startX","startY","getAdjustedSizes","_ref4","height","width","isValidWidth","isValidHeight","adjustedWidth","getSourceCanvas","image","_ref6","_ref7","_ref8","imageAspectRatio","imageNaturalWidth","naturalWidth","imageNaturalHeight","naturalHeight","_ref6$rotate","_ref6$scaleX","_ref6$scaleY","_ref8$fillColor","fillColor","_ref8$imageSmoothingE","imageSmoothingEnabled","_ref8$imageSmoothingQ","imageSmoothingQuality","_ref8$maxWidth","maxWidth","_ref8$maxHeight","maxHeight","_ref8$minWidth","minWidth","_ref8$minHeight","minHeight","canvas","createElement","context","getContext","maxSizes","minSizes","min","max","destMaxSizes","destMinSizes","destWidth","destHeight","params","fillStyle","fillRect","save","translate","PI","scale","drawImage","map","param","floor","fromCharCode","String","REGEXP_DATA_URL_HEAD","resetAndGetOrientation","arrayBuffer","orientation","dataView","DataView","littleEndian","app1Start","ifdStart","getUint8","byteLength","offset","tiffOffset","start","str","getStringFromCharCode","endianness","getUint16","firstIFDOffset","getUint32","_offset","_length","setUint16","render","this","initContainer","initCanvas","initCropBox","renderCanvas","cropped","renderCropBox","container","cropper","containerData","offsetWidth","offsetHeight","imageData","rotated","abs","canvasWidth","canvasHeight","canvasData","limited","limitCanvas","oldLeft","oldTop","initialCanvasData","sizeLimited","positionLimited","cropBoxData","_getAdjustedSizes","newCanvasLeft","newCanvasTop","minLeft","minTop","maxLeft","maxTop","changed","transformed","_getRotatedSizes","_ref5","degree","arc","sinArc","sin","cosArc","cos","newWidth","newHeight","getRotatedSizes","renderImage","limitCropBox","output","initialCropBoxData","maxCropBoxWidth","maxCropBoxHeight","face","cropBox","disabled","initPreview","crossOrigin","crossOriginUrl","alt","src","viewBox","appendChild","viewBoxImage","previews","ownerDocument","querySelectorAll","querySelector","el","img","html","innerHTML","cssText","resetPreview","removeAttribute","removeData","cropBoxWidth","cropBoxHeight","originalWidth","originalHeight","ratio","getElementsByTagName","events","bind","onCropStart","cropStart","onWheel","wheel","passive","capture","onDblclick","dblclick","onCropMove","cropMove","onCropEnd","cropEnd","onResize","resize","unbind","handlers","ratioX","ratioY","getCanvasData","getCropBoxData","setCanvasData","setCropBoxData","setDragMode","dragBox","contains","_this","delta","preventDefault","wheeling","setTimeout","deltaY","wheelDelta","buttons","button","pointerType","ctrlKey","action","pointers","changedTouches","touch","identifier","pointerId","originalEvent","cropping","change","right","bottom","renderable","shiftKey","pointer","range","x","y","check","side","move","pointers2","maxRatio","pointer2","x1","y1","x2","y2","z1","sqrt","getMaxZoomRatio","p","methods","reset","initialImageData","clear","hasSameSize","isImg","replaced","uncreate","load","enable","disable","destroy","originalUrl","offsetX","offsetY","_this$canvasData","moveTo","_originalEvent","zoomTo","pivot","oldRatio","count","_ref3","getPointersCenter","rotateTo","_scaleX","_scaleY","rounded","getContainerData","getImageData","sized","widthChanged","heightChanged","getCroppedCanvas","HTMLCanvasElement","_this$getData","initialX","initialY","initialWidth","initialHeight","_options$imageSmoothi","srcWidth","srcHeight","dstX","dstY","dstWidth","dstHeight","sourceWidth","sourceHeight","srcX","srcY","setAspectRatio","mode","croppable","AnotherCropper","Cropper","tagName","Error","reloading","sizing","init","staticProps","protoProps","toDataURL","base64","binary","uint8","ArrayBuffer","read","atob","Uint8Array","charCodeAt","clone","xhr","XMLHttpRequest","onabort","onerror","ontimeout","onprogress","getResponseHeader","abort","onload","response","onloadend","open","responseType","withCredentials","send","mimeType","chunks","subarray","btoa","arrayBufferToDataURL","_parseOrientation","parseOrientation","stop","parentNode","insertBefore","nextSibling","_this2","isIOSWebKit","navigator","userAgent","done","build","sizingImage","body","removeChild","template","getElementsByClassName","unbuild","factory","utils","require","pica","ImageBlobReduce","initialized","use","plugin","toBlob","blob","env","opts","Promise","resolve","then","_blob_to_image","_calculate_size","_transform","_cleanup","_create_blob","_env","out_canvas","out_blob","toCanvas","before","method_name","fn","old_fn","self","after","URL","webkitURL","mozURL","msURL","image_url","createObjectURL","reject","scale_factor","transform_width","transform_height","createCanvas","pica_opts","alpha","pick_pica_resize_options","revokeObjectURL","_getUint8Array","buf","fr","FileReader","readAsArrayBuffer","result","message","code","err","to_hex","number","toUpperCase","utf8_decode","decodeURIComponent","escape","_","is_uint8array","bin","ExifParser","jpeg_bin","exif_start","exif_end","input","sig","big_endian","each","on_entry","aborted","read_uint32","ifds_to_read","id","shift","scan_ifd","ifds","entries","entry","is_subifd_link","format","ifd","ifd1","ifd_no","data_length","ceil","write_uint16","write_uint32","written_offset","ifd_start","ifd_end","sort","a","b","tag","idx","entry_offset","link_offset","data_offset","next_ifd","read_uint16","d","exif_format_length","exif_format_read","v","entry_count","comp_length","comp_offset","j","item","isInteger","is_big_endian","is_jpeg","jpeg_segments_each","on_segment","inside_scan","segment_code","segment_length","byte1","byte2","pos","jpeg_segments_filter","ranges","out_length","segment","new_segment","s","new_range","jpeg_exif_tags_each","on_exif_entry","jpeg_exif_tags_filter","stop_search","new_exif","header","jpeg_add_comment","comment","comment_inserted","segment_count","unescape","encodeURIComponent","utf8_encode","csegment","c","image_traverse","jpeg_patch_exif","orig_blob","exif_is_big_endian","orientation_offset","orientation_patch","Blob","jpeg_rotate_canvas","ctx","jpeg_attach_orig_segments","all","res","data_out","segments","reducer","pick","to","r","e","t","f","u","_dereq_","Multimath","mm_unsharp_mask","mm_resize","MathLib","requested_features","__requested_features","features","js","wasm","has_wasm","create","resizeAndUnsharp","cache","unsharpAmount","unsharp_mask","toWidth","toHeight","unsharpRadius","unsharpThreshold","clampTo8","clampNegative","convolveHor","dest","srcW","srcH","destW","filters","g","filterPtr","filterShift","filterSize","srcPtr","destX","filterVal","srcOffset","destOffset","convolveVert","convolveHorWithPre","convolveVertWithPre","wasm_fn","wasm_src","createFilters","_require","destH","filtersX","filtersY","tmp","Uint16Array","ptr","hasAlpha","dst","resetAlpha","FILTER_INFO","toFixedPoint","num","srcSize","destSize","destPixel","srcPixel","srcFirst","srcLast","filterElementSize","floatFilter","fxpFilter","total","pxl","floatVal","filterTotal","leftNotEmpty","rightNotEmpty","filterFunction","scaleInverted","scaleClamped","srcWindow","win","maxFilterElementSize","packedFilter","Int16Array","packedFilterPtr","slowCopy","Float32Array","hamming","xpi","lanczos2","lanczos3","mks2013","f2q","q2f","IS_LE","Uint32Array","buffer","__","copyInt16asLE","target_offset","asUint8Array","src_size","tmp_offset","__align","tmp_size","filtersX_offset","filtersY_offset","alloc_bytes","__instance","mem","__memory","mem32","src32","convolveHV","_convolveHV","glur_mono16","amount","radius","threshold","v1","v2","vmul","diff","iTimes4","brightness","size","out","hsv_v16","blured","amountFp","thresholdFp","pixels","img_bytes_cnt","hsv_bytes_cnt","blur_bytes_cnt","blur_line_byte_cnt","hsv_offset","blur_offset","blur_tmp_offset","blur_line_offset","blur_coeffs_offset","exp","img32","_hsv_v16","blurMono16","_blurMono16","unsharp","_unsharp","Pool","idle","available","acquired","lastId","timeoutId","acquire","resource","pop","release","lastUsed","now","gc","_this3","fromWidth","fromHeight","srcTileSize","destTileBorder","minScale","stageCount","log","pow","PIXEL_EPSILON","pixelFloor","nearest","pixelCeil","innerX","innerY","toTileWidth","toTileHeight","innerTileWidth","innerTileHeight","tile","tiles","toX","toY","toInnerX","toInnerY","toInnerWidth","toInnerHeight","objClass","isCanvas","cname","isImage","isImageBitmap","limiter","concurrency","active","queue","roll","cib_quality_name","cib_support","createImageBitmap","resizeWidth","resizeHeight","resizeQuality","bitmap","status","close","worker_offscreen_canvas_support","OffscreenCanvas","rect","postMessage","w","Worker","onmessage","ev","can_use_canvas","usable","createImageData","putImageData","cib_can_use_region","Image","mathLib","tileOpts","srcBitmap","a0","a1","a2","a3","b1","b2","convolveMono16","line","coeff","prev_src","curr_src","curr_out","prev_out","prev_prev_out","src_index","out_index","line_index","coeff_a0","coeff_a1","coeff_b1","coeff_b2","tmp_line","sigma","g1","g2","k","gaussCoef","base64decode","hasWebAssembly","DEFAULT_OPTIONS","MultiMath","__cache","__init_promise","__modules","modules","__wasm","__isLE","WebAssembly","compile","__base64decode","m","__reallocate","bytes","Memory","initial","mem_size","grow","memsize","env_extra","Module","env_base","memoryBase","memory","tableBase","table","Table","Instance","base","reminder","bits","charAt","tailbits","wa","propIsEnumerable","propertyIsEnumerable","toObject","val","test1","getOwnPropertyNames","test2","test3","letter","shouldUseNative","bundleFn","sources","stringify","JSON","wkey","cacheKeys","l","random","wcache","skey","scache","workerSources","resolveSources","depPath","depKey","bare","workerUrl","worker","objectURL","_slicedToArray","_arrayWithHoles","_i","_s","_e","_arr","_n","_d","next","_iterableToArrayLimit","_nonIterableRest","webworkify","createStages","createRegions","filter_info","singletones","NEED_SAFARI_FIX","hardwareConcurrency","DEFAULT_PICA_OPTS","tmpCanvas","DEFAULT_RESIZE_OPTS","CAN_NEW_IMAGE_DATA","CAN_CREATE_IMAGE_BITMAP","CAN_USE_CANVAS_GET_IMAGE_DATA","CAN_USE_OFFSCREEN_CANVAS","CAN_USE_CIB_REGION_FOR_IMAGE","workerFabric","terminate","Pica","limiter_key","__limit","cib","ww","__workersPool","__mathlib","__initPromise","ImageData","Uint8ClampedArray","ImageBitmap","debug","wpool_key","checkCibResize","checkOffscreenCanvas","initMath","mathlib","checkCibRegion","__invokeResize","__mathCache","cancelToken","transfer","preload","wasm_nodule","__extractTileData","stageEnv","extractTo","srcImageBitmap","srcCtx","tmpCtx","globalCompositeOperation","__landTileData","toImageData","toCtx","__tileAndResize","isImageBitmapReused","imageBitmap","canceled","jobs","__destTileBorder","srcImageData","processTile","cleanup","__processStages","stages","_this4","_stages$shift2","isLastStage","__resizeViaCreateImageBitmap","_this5","iData","_this6","quality","resizeBuffer","_this7","convertToBlob","asString","asBuffer"],"sourceRoot":""}